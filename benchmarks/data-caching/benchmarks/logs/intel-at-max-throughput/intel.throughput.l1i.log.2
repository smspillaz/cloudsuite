+ for keys in '$KEYS'
+ for conns in '$CONNS'
+ for threads in '$THREADS'
+ for rps in '$RPS'
+ echo '==> Bench: 16384 keys, 256 conns, 4 threads, 115000 rps'
==> Bench: 16384 keys, 256 conns, 4 threads, 115000 rps
++ echo '256 + 128'
++ bc
+ max_conns=384
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 115000 -k 16384 -c 256 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 384'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id a68c59e0c94eda6a38dac534746e996ffcea95c624f2471e3af69a5313a05116 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 384'
Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 384
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 384
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u memcached -t 2 -m 4096 -n 550 -c 384
+ echo 'Starting client with -r 115000 -k 16384 -c 256 -f 512 -w 4'
Starting client with -r 115000 -k 16384 -c 256 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 115000 -k 16384 -c 256 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 60 -T 5 -r 115000 -k 16384 -c 256 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 60
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.208.2
Loading key value file...created uniform distribution 16384
rps 115000 cpus 4
meanInterarrival 34
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 979126016
starting receive base loop
num_worker_connections 64
Creating worker on tid 383694592
starting receive base loop
num_worker_connections 64
Creating worker on tid 4082693888
starting receive base loop
Created 256 connections total
Creating worker on tid 3486725888
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575401730.400155,       0.0,      297805,     267821,      29984,     175894,      91927,   4.053791,  13.200000,  18.300000,  28.500000,   6.828774,   0.000000,  69.091998, 471.948025
Outstanding requests per worker:
146 116 145 144 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117648.1,      588241,     529314,      58927,     394645,     134669,   4.675625,  13.600000,  16.800000,  26.100000,   6.342704,   0.023000,  58.511000, 568.275780
Outstanding requests per worker:
137 168 132 154 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117644.3,      588222,     529352,      58870,     416374,     112978,   5.251766,  15.000000,  19.300000,  29.700000,   7.314263,   0.023000,  71.482003, 613.911981
Outstanding requests per worker:
155 177 149 167 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117657.5,      588288,     529575,      58713,     428145,     101430,   4.894725,  14.300000,  16.700000,  27.300000,   6.550419,   0.023000,  51.897999, 638.218704
Outstanding requests per worker:
141 178 152 153 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117656.3,      588282,     529482,      58800,     436835,      92647,   7.499383,  22.200000,  30.700000,  51.900000,  11.401080,   0.023000,  97.526997, 655.981006
Outstanding requests per worker:
203 174 116 131 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117655.3,      588277,     529308,      58969,     442209,      87099,   5.296127,  15.500000,  18.100000,  29.700000,   7.127502,   0.023000,  58.398001, 668.039043
Outstanding requests per worker:
159 169 149 135 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117638.9,      588195,     529560,      58635,     447516,      82044,   5.279627,  15.400000,  18.000000,  29.800000,   7.099390,   0.022000,  56.217000, 677.982689
Outstanding requests per worker:
174 195 149 176 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117658.3,      588292,     529703,      58589,     451343,      78360,   5.738875,  16.700000,  20.100000,  32.300000,   7.791571,   0.022000,  65.596998, 687.010128
Outstanding requests per worker:
153 180 162 170 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117604.7,      588024,     529337,      58687,     454425,      74912,  12.495285,  41.600000,  51.900000,  65.600000,  17.765114,   0.023000, 126.833007, 692.979085
Outstanding requests per worker:
226 219 236 221 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117362.5,      586813,     528137,      58676,     456478,      71659,  12.210034,  40.500000,  50.500000,  61.800000,  17.024047,   0.023000, 100.933999, 699.280134
Outstanding requests per worker:
612 517 621 625 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117705.3,      588527,     529424,      59103,     459831,      69593,  21.986285,  59.800000,  66.500000,  87.300000,  25.820207,   0.024000, 129.484996, 703.894959
Outstanding requests per worker:
510 535 522 542 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117930.3,      589652,     530461,      59191,     463134,      67327,  10.295694,  33.100000,  44.000000,  57.700000,  14.729265,   0.023000,  96.744999, 709.953226
Outstanding requests per worker:
136 212 176 193 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117625.1,      588126,     529140,      58986,     464291,      64849,   6.883420,  19.900000,  23.500000,  40.000000,   9.430363,   0.024000,  77.973999, 713.657353
Outstanding requests per worker:
243 255 193 182 
Ran for 62.000062, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'9\r'
+ echo 'memcached pid is: 9'
memcached pid is: 9
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.3  0.0  18032  2792 pts/0    Ss+  19:08   0:00 bash docker-ent
memcache     8  0.2  0.0  96672  6448 pts/0    S+   19:09   0:00 /usr/lib/linux-
memcache     9  154  0.0 412540 193124 pts/0   Sl+  19:09   1:56 memcached -t 2 
memcache    19  0.0  0.0  34424  2820 pts/1    Rs+  19:10   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 384':

       28621935088      instructions:u                                              
        1375541041      L1-icache-load-misses                                       
       15655305059      icache.hit:u                                                

      75.650946784 seconds time elapsed

+ for conns in '$CONNS'
+ for threads in '$THREADS'
+ for rps in '$RPS'
+ echo '==> Bench: 16384 keys, 512 conns, 4 threads, 115000 rps'
==> Bench: 16384 keys, 512 conns, 4 threads, 115000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 115000 -k 16384 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id a68c59e0c94eda6a38dac534746e996ffcea95c624f2471e3af69a5313a05116 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 115000 -k 16384 -c 512 -f 512 -w 4'
Starting client with -r 115000 -k 16384 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 115000 -k 16384 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 60 -T 5 -r 115000 -k 16384 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 60
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.208.2
Loading key value file...created uniform distribution 16384
rps 115000 cpus 4
meanInterarrival 34
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 650999552
starting receive base loop
num_worker_connections 128
Creating worker on tid 3838375680
starting receive base loop
num_worker_connections 128
Creating worker on tid 2729572096
starting receive base loop
Created 512 connections total
Creating worker on tid 1623783168
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575401808.400233,       0.0,      331026,     297812,      33214,     197157,     100655,   6.037185,  21.200000,  30.100000,  44.700000,  11.026456,   0.000000, 126.163006, 477.127718
Outstanding requests per worker:
179 174 167 182 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117613.5,      588068,     529318,      58750,     395822,     133496,   7.185817,  20.800000,  26.900000,  38.500000,   9.719922,   0.045000,  83.825998, 571.974858
Outstanding requests per worker:
221 226 230 241 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117666.9,      588335,     529328,      59007,     416978,     112350,   7.401959,  21.300000,  27.300000,  40.100000,   9.998731,   0.033000,  92.896998, 615.247956
Outstanding requests per worker:
225 212 212 213 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117634.9,      588175,     529514,      58661,     428505,     101009,   7.235185,  20.800000,  25.600000,  39.200000,   9.673997,   0.045000,  68.438999, 639.239465
Outstanding requests per worker:
214 234 263 240 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117666.7,      588334,     529824,      58510,     437217,      92607,   8.145458,  23.500000,  30.200000,  44.200000,  11.098595,   0.044000, 110.466003, 656.870202
Outstanding requests per worker:
214 240 217 213 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117653.3,      588267,     529475,      58792,     442424,      87051,   7.637851,  22.100000,  27.100000,  41.900000,  10.270341,   0.032000,  79.150997, 668.371428
Outstanding requests per worker:
194 219 261 219 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117611.9,      588060,     529012,      59048,     447181,      81831,   7.840773,  22.600000,  27.600000,  42.800000,  10.514136,   0.044000,  77.434003, 678.647000
Outstanding requests per worker:
287 265 282 265 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117686.9,      588435,     529692,      58743,     451451,      78241,   8.265559,  24.000000,  28.500000,  45.800000,  11.102942,   0.032000,  84.647000, 686.866589
Outstanding requests per worker:
222 225 239 236 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117631.3,      588157,     528936,      59221,     454090,      74846,   8.441611,  24.700000,  29.200000,  47.100000,  11.337793,   0.044000,  79.742998, 693.531233
Outstanding requests per worker:
238 287 249 255 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117556.1,      587781,     529259,      58522,     457220,      72039,  15.213994,  29.800000,  36.300000,  56.600000,  11.714675,   0.079000, 146.589994, 699.559289
Outstanding requests per worker:
377 407 367 384 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117641.1,      588206,     529213,      58993,     460008,      69205,  15.343427,  29.600000,  34.800000,  50.200000,  10.528557,   0.151000, 108.342998, 704.857245
Outstanding requests per worker:
410 410 361 426 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117698.3,      588492,     529210,      59282,     462168,      67042,  12.561443,  23.700000,  29.800000,  35.200000,   8.076660,   0.158000,  45.513000, 709.477538
Outstanding requests per worker:
313 354 398 327 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117615.9,      588080,     529329,      58751,     464178,      65151,  13.185757,  24.600000,  31.200000,  37.300000,   8.477397,   0.131000,  58.325000, 713.082659
Outstanding requests per worker:
423 399 381 389 
Ran for 62.000062, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'7\r'
+ echo 'memcached pid is: 7'
memcached pid is: 7
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.2  0.0  18032  2880 pts/0    Ss+  19:10   0:00 bash docker-ent
memcache     6  0.2  0.0  96672  6464 pts/0    S+   19:10   0:00 /usr/lib/linux-
memcache     7  155  0.0 413564 197368 pts/0   Sl+  19:10   1:59 memcached -t 2 
memcache    17  0.0  0.0  34424  2824 pts/1    Rs+  19:11   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       28216640362      instructions:u                                              
        1364517394      L1-icache-load-misses                                       
       15242608984      icache.hit:u                                                

      76.784602640 seconds time elapsed

+ for conns in '$CONNS'
+ for threads in '$THREADS'
+ for rps in '$RPS'
+ echo '==> Bench: 16384 keys, 1024 conns, 4 threads, 115000 rps'
==> Bench: 16384 keys, 1024 conns, 4 threads, 115000 rps
++ echo '1024 + 128'
++ bc
+ max_conns=1152
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 115000 -k 16384 -c 1024 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 1152'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id a68c59e0c94eda6a38dac534746e996ffcea95c624f2471e3af69a5313a05116 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 1152'
Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 1152
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 1152
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u memcached -t 2 -m 4096 -n 550 -c 1152
+ echo 'Starting client with -r 115000 -k 16384 -c 1024 -f 512 -w 4'
Starting client with -r 115000 -k 16384 -c 1024 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 115000 -k 16384 -c 1024 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 60 -T 5 -r 115000 -k 16384 -c 1024 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 60
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.208.2
Loading key value file...created uniform distribution 16384
rps 115000 cpus 4
meanInterarrival 34
num_worker_connections 256
num_worker_connections 256
Creating worker on tid 1713071872
starting receive base loop
num_worker_connections 256
Creating worker on tid 3878508288
starting receive base loop
num_worker_connections 256
Creating worker on tid 1740965632
starting receive base loop
Created 1024 connections total
Creating worker on tid 3903338240
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575401887.400312,       0.0,      263728,     237438,      26290,     154896,      82542,  44.980218, 168.900000, 228.800000, 302.800000,  76.359558,   0.000000, 450.980991, 466.863194
Outstanding requests per worker:
2133 2109 2055 1975 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  119088.1,      595441,     536041,      59400,     396553,     139488,  29.338102,  95.400000, 155.000000, 226.800000,  51.632265,   0.074000, 477.849990, 563.224658
Outstanding requests per worker:
277 281 275 290 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117595.5,      587978,     528915,      59063,     415021,     113894,  12.015812,  34.300000,  45.900000,  62.200000,  16.105743,   0.076000, 100.249998, 611.380021
Outstanding requests per worker:
312 368 338 396 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117787.9,      588940,     530510,      58430,     428586,     101924,  12.064493,  34.400000,  46.100000,  63.600000,  16.130260,   0.077000,  91.617003, 637.182860
Outstanding requests per worker:
158 200 190 200 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117515.1,      587576,     528872,      58704,     435923,      92949,  12.593769,  36.800000,  48.300000,  68.300000,  17.268731,   0.076000, 163.564995, 655.829116
Outstanding requests per worker:
368 337 347 389 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117645.5,      588228,     529459,      58769,     442310,      87149,  12.501363,  35.700000,  47.300000,  66.300000,  16.719598,   0.072000,  92.859000, 667.359433
Outstanding requests per worker:
336 362 385 408 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117633.1,      588166,     529313,      58853,     446969,      82344,  14.467459,  42.400000,  57.600000,  76.400000,  20.294114,   0.073000, 200.117007, 677.732004
Outstanding requests per worker:
404 392 391 405 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117684.3,      588422,     529823,      58599,     451950,      77873,  12.927172,  36.900000,  48.000000,  68.900000,  17.291343,   0.078000,  92.638999, 686.738813
Outstanding requests per worker:
358 340 354 386 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117618.7,      588094,     529108,      58986,     454409,      74699,  13.030484,  37.200000,  48.400000,  69.400000,  17.428354,   0.077000,  84.666997, 693.132064
Outstanding requests per worker:
442 342 413 416 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117682.3,      588412,     529704,      58708,     457121,      72583,  14.632933,  39.300000,  54.500000,  75.500000,  19.459736,   0.079000, 149.339005, 698.492388
Outstanding requests per worker:
358 389 356 385 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117644.7,      588224,     529792,      58432,     460091,      69701,  12.983394,  36.600000,  48.300000,  68.000000,  17.092805,   0.076000,  81.583999, 704.253711
Outstanding requests per worker:
388 403 352 390 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117659.3,      588297,     529229,      59068,     462426,      66803,  17.694876,  54.400000,  67.600000, 106.300000,  24.989202,   0.072000, 243.404999, 709.410134
Outstanding requests per worker:
409 363 371 360 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117654.5,      588273,     529338,      58935,     464289,      65049,  12.780569,  36.800000,  47.300000,  68.800000,  17.150336,   0.074000, 112.769000, 713.984139
Outstanding requests per worker:
325 366 433 375 
Ran for 62.000062, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.2  0.0  18032  2756 pts/0    Ss+  19:11   0:00 bash docker-ent
memcache     7  0.2  0.0  96672  6404 pts/0    S+   19:11   0:00 /usr/lib/linux-
memcache     8  150  0.0 410636 206232 pts/0   Sl+  19:11   1:56 memcached -t 2 
memcache    17 18.0  0.0  34424  2852 pts/1    Rs+  19:12   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 1152':

       28433980981      instructions:u                                              
        1277330863      L1-icache-load-misses                                       
       15550228879      icache.hit:u                                                

      76.797822000 seconds time elapsed

+ for keys in '$KEYS'
+ for conns in '$CONNS'
+ for threads in '$THREADS'
+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 256 conns, 4 threads, 115000 rps'
==> Bench: 65536 keys, 256 conns, 4 threads, 115000 rps
++ echo '256 + 128'
++ bc
+ max_conns=384
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 115000 -k 65536 -c 256 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 384'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id a68c59e0c94eda6a38dac534746e996ffcea95c624f2471e3af69a5313a05116 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 384'
Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 384
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 384
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u memcached -t 2 -m 4096 -n 550 -c 384
+ echo 'Starting client with -r 115000 -k 65536 -c 256 -f 512 -w 4'
Starting client with -r 115000 -k 65536 -c 256 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 115000 -k 65536 -c 256 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 60 -T 5 -r 115000 -k 65536 -c 256 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 60
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.208.2
Loading key value file...created uniform distribution 65536
rps 115000 cpus 4
meanInterarrival 34
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 559789824
starting receive base loop
num_worker_connections 64
Creating worker on tid 4264982272
starting receive base loop
num_worker_connections 64
Creating worker on tid 3672028928
starting receive base loop
Created 256 connections total
Creating worker on tid 3076060928
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575401965.400390,       0.0,      297401,     267635,      29766,     176560,      91075,   3.276251,  10.700000,  14.900000,  21.500000,   5.394135,   0.000000,  51.970001, 473.788529
Outstanding requests per worker:
122 122 94 115 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117675.1,      588376,     529769,      58607,     393918,     135851,   4.014216,  11.700000,  14.600000,  21.900000,   5.411236,   0.023000,  48.021998, 566.553349
Outstanding requests per worker:
105 80 86 92 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117587.3,      587937,     528924,      59013,     415221,     113703,   6.364776,  12.200000,  14.700000,  18.800000,   4.236535,   0.058000,  47.272999, 612.843448
Outstanding requests per worker:
151 202 189 178 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117645.1,      588226,     529766,      58460,     427918,     101848,   6.222849,  11.700000,  14.600000,  17.600000,   3.977912,   0.078000,  23.610000, 637.605543
Outstanding requests per worker:
170 203 186 202 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117663.3,      588317,     529328,      58989,     436158,      93170,   7.033590,  13.700000,  16.600000,  21.400000,   4.913177,   0.073000,  61.080001, 655.255717
Outstanding requests per worker:
181 193 161 217 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117656.3,      588282,     529356,      58926,     442132,      87224,   6.564397,  12.000000,  15.400000,  18.900000,   4.205666,   0.076000,  28.315000, 668.160712
Outstanding requests per worker:
193 161 185 210 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117717.7,      588589,     529655,      58934,     447427,      82228,   4.792297,  12.200000,  14.500000,  22.200000,   5.278496,   0.023000,  45.003001, 677.939942
Outstanding requests per worker:
135 108 131 100 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117641.5,      588208,     529235,      58973,     450756,      78479,   6.405212,  18.700000,  26.100000,  49.100000,  10.141808,   0.023000,  96.072003, 685.871560
Outstanding requests per worker:
121 117 138 147 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117664.3,      588322,     529253,      59069,     454406,      74847,   4.378097,  12.700000,  15.200000,  24.200000,   5.857101,   0.023000,  49.695000, 693.331974
Outstanding requests per worker:
113 123 114 112 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117626.9,      588135,     529075,      59060,     457231,      71844,   4.819560,  13.200000,  16.500000,  27.700000,   6.976035,   0.023000,  81.983000, 699.583176
Outstanding requests per worker:
126 160 172 143 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117672.3,      588362,     529662,      58700,     460334,      69328,   6.552070,  19.200000,  26.300000,  48.300000,  10.097164,   0.023000,  87.270997, 704.914946
Outstanding requests per worker:
93 120 139 149 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117659.1,      588296,     529763,      58533,     462748,      67015,   4.404755,  12.900000,  15.100000,  24.500000,   5.893007,   0.023000,  47.262002, 709.383889
Outstanding requests per worker:
105 108 148 107 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117641.1,      588206,     529363,      58843,     464284,      65079,   4.542834,  13.200000,  15.700000,  25.100000,   6.081563,   0.023000,  49.116999, 713.323026
Outstanding requests per worker:
126 118 120 158 
Ran for 62.000062, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.3  0.0  18032  2856 pts/0    Ss+  19:12   0:00 bash docker-ent
memcache     7  0.2  0.0  96672  6476 pts/0    S+   19:12   0:00 /usr/lib/linux-
memcache     8  158  0.0 414588 194148 pts/0   Sl+  19:12   1:58 memcached -t 2 
memcache    17  0.0  0.0  34424  2864 pts/1    Rs+  19:14   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 384':

       28183147709      instructions:u                                              
        1324581236      L1-icache-load-misses                                       
       14840649436      icache.hit:u                                                

      75.717989312 seconds time elapsed

+ for conns in '$CONNS'
+ for threads in '$THREADS'
+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 115000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 115000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 115000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id a68c59e0c94eda6a38dac534746e996ffcea95c624f2471e3af69a5313a05116 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 115000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 115000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 115000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 60 -T 5 -r 115000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 60
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.208.2
Loading key value file...created uniform distribution 65536
rps 115000 cpus 4
meanInterarrival 34
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 3874309888
starting receive base loop
num_worker_connections 128
Creating worker on tid 2772645632
starting receive base loop
num_worker_connections 128
Creating worker on tid 1666856704
starting receive base loop
Created 512 connections total
Creating worker on tid 558921472
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575402043.400468,       0.0,      270904,     243833,      27071,     159415,      84418,  14.981319,  51.100000,  76.300000, 117.300000,  26.504246,   0.000000, 195.596993, 467.410761
Outstanding requests per worker:
190 173 173 180 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117638.7,      588194,     529228,      58966,     392202,     137026,   6.543931,  18.700000,  24.500000,  34.500000,   8.769350,   0.033000,  51.697999, 563.700592
Outstanding requests per worker:
213 172 221 198 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117672.5,      588363,     529553,      58810,     414858,     114695,   6.734471,  19.300000,  25.800000,  35.300000,   9.118967,   0.044000,  84.803998, 610.326732
Outstanding requests per worker:
179 170 158 195 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117629.9,      588150,     529167,      58983,     427146,     102021,   6.542025,  18.700000,  24.100000,  34.800000,   8.734312,   0.032000,  47.989000, 637.042249
Outstanding requests per worker:
200 212 212 208 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117635.9,      588180,     529338,      58842,     435754,      93584,   7.424206,  21.500000,  28.000000,  39.700000,  10.133808,   0.032000, 102.387004, 654.810533
Outstanding requests per worker:
230 237 196 253 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117676.5,      588383,     529262,      59121,     442023,      87239,   6.818304,  19.600000,  24.800000,  36.900000,   9.146514,   0.044000,  47.520000, 667.895209
Outstanding requests per worker:
177 212 237 189 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117646.1,      588231,     529064,      59167,     446694,      82370,   7.156691,  20.500000,  26.000000,  38.500000,   9.584835,   0.032000,  58.913000, 677.861368
Outstanding requests per worker:
200 239 179 232 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117631.5,      588158,     529757,      58401,     451160,      78597,   8.003696,  23.500000,  30.600000,  43.700000,  11.104222,   0.044000, 112.801999, 686.149729
Outstanding requests per worker:
235 255 238 228 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117682.9,      588415,     529622,      58793,     454461,      75161,   7.627504,  22.000000,  27.100000,  41.900000,  10.246060,   0.044000,  65.729998, 692.557367
Outstanding requests per worker:
190 194 226 214 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117591.3,      587957,     529178,      58779,     457047,      72131,  11.111038,  31.400000,  44.600000,  86.900000,  17.502608,   0.045000, 162.184000, 698.795322
Outstanding requests per worker:
277 273 286 298 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117692.7,      588464,     529456,      59008,     460298,      69158,   7.894337,  22.800000,  27.900000,  43.400000,  10.630036,   0.045000,  87.678000, 705.467070
Outstanding requests per worker:
210 272 240 215 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117666.3,      588332,     529541,      58791,     462263,      67278,   7.212588,  20.800000,  25.800000,  39.300000,   9.680749,   0.044000,  69.339998, 709.313528
Outstanding requests per worker:
191 257 210 212 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117655.1,      588276,     529681,      58595,     464405,      65276,   7.526093,  21.800000,  26.200000,  41.400000,  10.092838,   0.044000,  72.912998, 713.974728
Outstanding requests per worker:
207 236 197 220 
Ran for 62.000062, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.3  0.0  18032  2740 pts/0    Ss+  19:14   0:00 bash docker-ent
memcache     7  0.3  0.0  96672  6360 pts/0    S+   19:14   0:00 /usr/lib/linux-
memcache     8  154  0.0 412540 197524 pts/0   Sl+  19:14   1:55 memcached -t 2 
memcache    17  0.0  0.0  34424  2788 pts/1    Rs+  19:15   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       28425603549      instructions:u                                              
        1352377661      L1-icache-load-misses                                       
       15764111832      icache.hit:u                                                

      75.753827627 seconds time elapsed

+ for conns in '$CONNS'
+ for threads in '$THREADS'
+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 1024 conns, 4 threads, 115000 rps'
==> Bench: 65536 keys, 1024 conns, 4 threads, 115000 rps
++ echo '1024 + 128'
++ bc
+ max_conns=1152
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 115000 -k 65536 -c 1024 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 1152'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id a68c59e0c94eda6a38dac534746e996ffcea95c624f2471e3af69a5313a05116 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 1152'
Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 1152
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 1152
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u memcached -t 2 -m 4096 -n 550 -c 1152
+ echo 'Starting client with -r 115000 -k 65536 -c 1024 -f 512 -w 4'
Starting client with -r 115000 -k 65536 -c 1024 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 115000 -k 65536 -c 1024 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 60 -T 5 -r 115000 -k 65536 -c 1024 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 60
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.208.2
Loading key value file...created uniform distribution 65536
rps 115000 cpus 4
meanInterarrival 34
num_worker_connections 256
num_worker_connections 256
Creating worker on tid 3480696576
starting receive base loop
num_worker_connections 256
Creating worker on tid 1352496896
starting receive base loop
num_worker_connections 256
Creating worker on tid 3516004096
starting receive base loop
Created 1024 connections total
Creating worker on tid 1387558656
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575402121.400546,       0.0,      270872,     243876,      26996,     159756,      84120,  23.428089,  71.700000, 105.700000, 196.700000,  40.264768,   0.000000, 393.927008, 468.836708
Outstanding requests per worker:
323 353 325 338 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117653.3,      588267,     529598,      58669,     393338,     136260,  12.101295,  32.900000,  43.200000,  58.500000,  15.034160,   0.076000,  81.084996, 564.600374
Outstanding requests per worker:
319 351 355 336 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117394.1,      586971,     528635,      58336,     414199,     114436,  22.311714,  43.400000,  52.700000,  61.400000,  14.509155,   0.113000, 122.994997, 610.630197
Outstanding requests per worker:
654 687 676 650 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117651.5,      588258,     529427,      58831,     427673,     101754,  22.782936,  44.500000,  54.000000,  61.400000,  14.541404,   0.233000,  69.319002, 637.987855
Outstanding requests per worker:
651 688 665 691 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117642.7,      588214,     529287,      58927,     435496,      93791,  24.249352,  46.900000,  57.100000,  66.400000,  15.668682,   0.227000, 134.386003, 654.785906
Outstanding requests per worker:
661 695 758 689 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117674.5,      588373,     529593,      58780,     441765,      87828,  24.189340,  46.300000,  57.700000,  66.300000,  15.494723,   0.255000,  83.989002, 666.556573
Outstanding requests per worker:
622 655 751 684 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117627.1,      588136,     529147,      58989,     446967,      82180,  23.895790,  46.000000,  57.200000,  64.700000,  15.262868,   0.231000,  72.971001, 677.955472
Outstanding requests per worker:
715 722 707 718 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117616.7,      588084,     529253,      58831,     450358,      78895,  26.138447,  51.200000,  60.400000,  76.300000,  17.394214,   0.237000, 172.016993, 685.316378
Outstanding requests per worker:
782 716 754 808 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117676.3,      588382,     529647,      58735,     454645,      75002,  24.514502,  46.900000,  58.700000,  66.800000,  15.634957,   0.220000,  87.893002, 692.584857
Outstanding requests per worker:
746 758 737 724 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117699.3,      588497,     529457,      59040,     457147,      72310,  26.038736,  52.000000,  61.200000,  79.800000,  18.108193,   0.241000, 226.518005, 698.575033
Outstanding requests per worker:
651 716 694 728 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117637.1,      588186,     529305,      58881,     460373,      68932,  26.173633,  50.800000,  60.100000,  78.500000,  17.327994,   0.259000, 169.547006, 705.284161
Outstanding requests per worker:
683 735 725 742 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117685.7,      588429,     529770,      58659,     462393,      67377,  23.824472,  46.100000,  57.100000,  64.000000,  15.184161,   0.201000,  70.324004, 709.522051
Outstanding requests per worker:
698 672 687 678 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117989.1,      589946,     531176,      58770,     465905,      65271,  25.131978,  52.200000,  61.300000,  80.800000,  18.709871,   0.078000, 195.479006, 713.498904
Outstanding requests per worker:
262 265 258 284 
Ran for 62.000062, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'7\r'
+ echo 'memcached pid is: 7'
memcached pid is: 7
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.3  0.0  18032  2744 pts/0    Ss+  19:15   0:00 bash docker-ent
memcache     6  0.3  0.0  96672  6448 pts/0    S+   19:15   0:00 /usr/lib/linux-
memcache     7  160  0.0 412672 206824 pts/0   Sl+  19:15   2:03 memcached -t 2 
memcache    16  0.0  0.0  34424  2860 pts/1    Rs+  19:16   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 1152':

       27277393780      instructions:u                                              
        1369720021      L1-icache-load-misses                                       
       13945621378      icache.hit:u                                                

      76.887941855 seconds time elapsed

+ for keys in '$KEYS'
+ for conns in '$CONNS'
+ for threads in '$THREADS'
+ for rps in '$RPS'
+ echo '==> Bench: 262114 keys, 256 conns, 4 threads, 115000 rps'
==> Bench: 262114 keys, 256 conns, 4 threads, 115000 rps
++ echo '256 + 128'
++ bc
+ max_conns=384
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 115000 -k 262114 -c 256 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 384'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id a68c59e0c94eda6a38dac534746e996ffcea95c624f2471e3af69a5313a05116 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 384'
Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 384
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 384
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u memcached -t 2 -m 4096 -n 550 -c 384
+ echo 'Starting client with -r 115000 -k 262114 -c 256 -f 512 -w 4'
Starting client with -r 115000 -k 262114 -c 256 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 115000 -k 262114 -c 256 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 60 -T 5 -r 115000 -k 262114 -c 256 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 60
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.208.2
Loading key value file...created uniform distribution 262114
rps 115000 cpus 4
meanInterarrival 34
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 3349182208
starting receive base loop
num_worker_connections 64
Creating worker on tid 2756540160
starting receive base loop
num_worker_connections 64
Creating worker on tid 2160572160
starting receive base loop
Created 256 connections total
Creating worker on tid 1564604160
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575402199.400624,       0.0,      297534,     267947,      29587,     176421,      91526,   3.709328,  11.900000,  16.900000,  25.400000,   6.245739,   0.000000,  69.622003, 472.693014
Outstanding requests per worker:
135 117 176 119 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117657.7,      588289,     529197,      59092,     393571,     135626,   4.259087,  12.400000,  15.600000,  23.500000,   5.787867,   0.024000,  59.245002, 567.679223
Outstanding requests per worker:
140 108 132 161 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117642.5,      588213,     529237,      58976,     415537,     113700,   4.742023,  13.600000,  16.900000,  26.200000,   6.453401,   0.023000,  63.524999, 612.394098
Outstanding requests per worker:
145 188 134 139 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117648.7,      588244,     529216,      59028,     427976,     101240,   4.456501,  13.000000,  15.400000,  24.700000,   5.975156,   0.023000,  50.142001, 638.449805
Outstanding requests per worker:
169 157 153 148 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117664.9,      588325,     529291,      59034,     436070,      93221,   5.431113,  15.700000,  20.600000,  32.200000,   7.748396,   0.023000,  78.358002, 655.071203
Outstanding requests per worker:
150 162 109 158 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117654.9,      588275,     529836,      58439,     443058,      86778,   4.963113,  14.500000,  16.900000,  27.700000,   6.655074,   0.023000,  54.147001, 668.759154
Outstanding requests per worker:
137 150 139 142 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117648.9,      588245,     529319,      58926,     446777,      82542,   5.140657,  15.000000,  17.700000,  28.700000,   6.910267,   0.023000,  54.729000, 677.912811
Outstanding requests per worker:
150 126 174 151 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117658.9,      588295,     529491,      58804,     451022,      78469,   5.203660,  15.300000,  18.000000,  29.300000,   7.022228,   0.023000,  62.173001, 686.335005
Outstanding requests per worker:
151 115 168 132 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117637.9,      588190,     529215,      58975,     454418,      74797,  12.304954,  41.200000,  51.000000,  62.300000,  17.358613,   0.023000, 103.146002, 692.767714
Outstanding requests per worker:
202 160 154 127 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117664.3,      588322,     529237,      59085,     456805,      72432,   6.134008,  17.400000,  20.700000,  34.300000,   8.174391,   0.022000,  61.939001, 699.048851
Outstanding requests per worker:
151 115 131 183 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117578.5,      587893,     529115,      58778,     459974,      69141,  12.222711,  40.000000,  49.400000,  59.900000,  16.814680,   0.023000, 101.311997, 704.933413
Outstanding requests per worker:
288 235 211 231 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117712.1,      588561,     529910,      58651,     462647,      67263,   5.843150,  17.000000,  20.200000,  33.300000,   7.946299,   0.023000,  72.562002, 709.364649
Outstanding requests per worker:
153 187 169 156 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117650.9,      588255,     529514,      58741,     464673,      64841,   5.630022,  16.400000,  19.200000,  32.000000,   7.610867,   0.024000,  59.411000, 713.996025
Outstanding requests per worker:
163 170 177 164 
Ran for 62.000062, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.3  0.0  18032  2860 pts/0    Ss+  19:16   0:00 bash docker-ent
memcache     7  0.2  0.0  96672  6412 pts/0    S+   19:16   0:00 /usr/lib/linux-
memcache     8  152  0.0 414588 193528 pts/0   Sl+  19:16   1:56 memcached -t 2 
memcache    18  0.0  0.0  34424  2820 pts/1    Rs+  19:18   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 384':

       28552061105      instructions:u                                              
        1276023040      L1-icache-load-misses                                       
       15208347302      icache.hit:u                                                

      76.109194847 seconds time elapsed

+ for conns in '$CONNS'
+ for threads in '$THREADS'
+ for rps in '$RPS'
+ echo '==> Bench: 262114 keys, 512 conns, 4 threads, 115000 rps'
==> Bench: 262114 keys, 512 conns, 4 threads, 115000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 115000 -k 262114 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id a68c59e0c94eda6a38dac534746e996ffcea95c624f2471e3af69a5313a05116 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 115000 -k 262114 -c 512 -f 512 -w 4'
Starting client with -r 115000 -k 262114 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 115000 -k 262114 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 60 -T 5 -r 115000 -k 262114 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 60
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.208.2
Loading key value file...created uniform distribution 262114
rps 115000 cpus 4
meanInterarrival 34
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 2958120704
starting receive base loop
num_worker_connections 128
Creating worker on tid 1849145088
starting receive base loop
num_worker_connections 128
Creating worker on tid 743356160
starting receive base loop
Created 512 connections total
Creating worker on tid 3929519872
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575402278.400703,       0.0,      268816,     241951,      26865,     158225,      83726,   9.687741,  31.400000,  43.900000,  82.400000,  17.110862,   0.000000, 173.679993, 469.336130
Outstanding requests per worker:
191 155 179 187 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117584.7,      587924,     529276,      58648,     392270,     137006,   6.350910,  18.100000,  24.300000,  33.200000,   8.525450,   0.044000,  55.475000, 564.315758
Outstanding requests per worker:
271 274 254 275 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117668.5,      588343,     529520,      58823,     415028,     114492,   6.521052,  18.700000,  25.100000,  34.200000,   8.824875,   0.032000,  76.493002, 611.399894
Outstanding requests per worker:
289 228 228 248 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117694.3,      588472,     530129,      58343,     427810,     102319,   6.583981,  18.900000,  24.400000,  34.900000,   8.808310,   0.032000,  58.834001, 636.810459
Outstanding requests per worker:
200 213 208 180 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117641.3,      588207,     529423,      58784,     435201,      94222,   7.052892,  20.200000,  27.600000,  36.500000,   9.665681,   0.044000,  92.216998, 653.793749
Outstanding requests per worker:
199 201 208 253 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117672.9,      588365,     529452,      58913,     441986,      87466,   7.153887,  20.500000,  25.600000,  38.600000,   9.558635,   0.032000,  70.303999, 667.214854
Outstanding requests per worker:
205 177 213 184 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117645.9,      588230,     529131,      59099,     446658,      82473,   6.860843,  19.700000,  25.100000,  36.800000,   9.177776,   0.031000,  59.466001, 677.153603
Outstanding requests per worker:
213 208 200 192 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117673.1,      588366,     529551,      58815,     451373,      78178,   7.011716,  20.200000,  25.400000,  37.700000,   9.401460,   0.032000,  72.052002, 685.566166
Outstanding requests per worker:
174 173 186 182 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117624.9,      588125,     529152,      58973,     454303,      74849,   8.116776,  23.500000,  31.300000,  44.600000,  11.377422,   0.032000, 128.775001, 693.659504
Outstanding requests per worker:
244 218 211 179 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117662.1,      588311,     529736,      58575,     457636,      72100,  11.886990,  33.500000,  52.100000,  96.900000,  19.664529,   0.032000, 177.598998, 698.629381
Outstanding requests per worker:
216 207 193 211 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117609.1,      588046,     529169,      58877,     459634,      69535,   8.341123,  24.500000,  31.400000,  46.300000,  11.480277,   0.045000, 105.319999, 704.092362
Outstanding requests per worker:
252 265 266 266 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117565.7,      587829,     529305,      58524,     462105,      67200,  12.631362,  23.900000,  30.100000,  35.400000,   8.179766,   0.079000,  58.068000, 708.415439
Outstanding requests per worker:
389 357 396 349 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117641.9,      588210,     529460,      58750,     464447,      65013,  12.680252,  23.900000,  29.900000,  35.800000,   8.159605,   0.115000,  60.304999, 712.519588
Outstanding requests per worker:
372 366 391 432 
Ran for 62.000062, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'7\r'
+ echo 'memcached pid is: 7'
memcached pid is: 7
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.2  0.0  18032  2740 pts/0    Ss+  19:18   0:00 bash docker-ent
memcache     6  0.2  0.0  96672  6424 pts/0    S+   19:18   0:00 /usr/lib/linux-
memcache     7  154  0.0 411516 196200 pts/0   Sl+  19:18   1:57 memcached -t 2 
memcache    17  0.0  0.0  34424  2864 pts/1    Rs+  19:19   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       28183469376      instructions:u                                              
        1335237516      L1-icache-load-misses                                       
       15364900246      icache.hit:u                                                

      76.293480346 seconds time elapsed

+ for conns in '$CONNS'
+ for threads in '$THREADS'
+ for rps in '$RPS'
+ echo '==> Bench: 262114 keys, 1024 conns, 4 threads, 115000 rps'
==> Bench: 262114 keys, 1024 conns, 4 threads, 115000 rps
++ echo '1024 + 128'
++ bc
+ max_conns=1152
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 115000 -k 262114 -c 1024 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 1152'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id a68c59e0c94eda6a38dac534746e996ffcea95c624f2471e3af69a5313a05116 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 1152'
Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 1152
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 1152
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u memcached -t 2 -m 4096 -n 550 -c 1152
+ echo 'Starting client with -r 115000 -k 262114 -c 1024 -f 512 -w 4'
Starting client with -r 115000 -k 262114 -c 1024 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 115000 -k 262114 -c 1024 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 60 -T 5 -r 115000 -k 262114 -c 1024 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 60
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.208.2
Loading key value file...created uniform distribution 262114
rps 115000 cpus 4
meanInterarrival 34
num_worker_connections 256
num_worker_connections 256
Creating worker on tid 2360112896
starting receive base loop
num_worker_connections 256
Creating worker on tid 227669760
starting receive base loop
num_worker_connections 256
Creating worker on tid 2394191616
starting receive base loop
Created 1024 connections total
Creating worker on tid 266450688
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575402358.400783,       0.0,      327735,     294890,      32845,     195220,      99670,  20.321264,  73.900000,  95.300000, 169.300000,  37.258994,   0.000000, 420.327008, 477.054261
Outstanding requests per worker:
578 603 587 536 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117848.7,      589244,     530254,      58990,     396363,     133891,  11.793149,  33.800000,  45.400000,  61.200000,  15.890678,   0.074000, 170.197994, 570.706071
Outstanding requests per worker:
342 337 349 320 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117656.3,      588282,     529786,      58496,     416645,     113141,  11.777880,  33.400000,  45.500000,  60.900000,  15.686689,   0.076000,  70.595004, 613.947913
Outstanding requests per worker:
323 338 348 319 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117632.9,      588165,     529726,      58439,     428184,     101542,  12.369362,  35.200000,  47.300000,  64.200000,  16.597896,   0.073000,  98.797001, 638.607048
Outstanding requests per worker:
328 354 373 393 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117720.9,      588605,     529394,      59211,     436192,      93202,  12.895585,  36.800000,  50.900000,  66.700000,  17.736975,   0.075000, 173.078999, 655.527539
Outstanding requests per worker:
260 290 284 277 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117577.9,      587890,     529222,      58668,     441556,      87666,  11.927342,  34.500000,  44.800000,  63.900000,  16.018618,   0.073000, 104.748003, 667.134722
Outstanding requests per worker:
330 408 368 378 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117655.9,      588280,     529316,      58964,     446888,      82428,  12.633860,  36.000000,  47.600000,  66.800000,  16.841991,   0.073000,  75.324997, 677.898477
Outstanding requests per worker:
374 393 354 353 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117428.5,      587143,     528830,      58313,     450592,      78238,  13.353628,  37.600000,  52.900000,  68.800000,  18.264900,   0.073000, 201.355994, 686.650591
Outstanding requests per worker:
663 649 636 647 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117889.1,      589446,     529726,      59720,     454701,      75025,  13.932940,  39.100000,  54.400000,  71.300000,  19.099632,   0.071000, 199.637994, 692.697815
Outstanding requests per worker:
281 426 335 385 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117668.3,      588342,     529016,      59326,     457267,      71749,  13.132538,  36.000000,  50.400000,  67.000000,  17.825462,   0.077000, 140.801996, 698.724241
Outstanding requests per worker:
360 381 312 296 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117636.3,      588182,     529342,      58840,     460249,      69093,  11.992558,  34.100000,  45.800000,  62.800000,  15.979811,   0.078000,  73.798001, 704.845533
Outstanding requests per worker:
353 365 354 367 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117816.7,      589084,     530133,      58951,     463096,      67037,  11.970612,  34.500000,  45.100000,  64.700000,  16.093902,   0.074000,  98.696999, 709.467894
Outstanding requests per worker:
148 163 150 153 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117496.9,      587485,     528603,      58882,     463513,      65090,  11.873150,  34.100000,  45.000000,  63.000000,  15.905989,   0.077000,  81.050001, 713.655605
Outstanding requests per worker:
341 354 353 350 
Ran for 62.000062, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.2  0.0  18032  2764 pts/0    Ss+  19:19   0:00 bash docker-ent
memcache     7  0.2  0.0  96672  6472 pts/0    S+   19:19   0:00 /usr/lib/linux-
memcache     8  149  0.0 412680 205980 pts/0   Sl+  19:19   1:56 memcached -t 2 
memcache    17  0.0  0.0  34424  2868 pts/1    Rs+  19:20   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 1152':

       28577917000      instructions:u                                              
        1289951126      L1-icache-load-misses                                       
       15887567650      icache.hit:u                                                

      78.377691901 seconds time elapsed

