+ for keys in '$KEYS'
+ for conns in '$CONNS'
+ for threads in '$THREADS'
+ for rps in '$RPS'
+ echo '==> Bench: 16384 keys, 256 conns, 4 threads, 115000 rps'
==> Bench: 16384 keys, 256 conns, 4 threads, 115000 rps
++ echo '256 + 128'
++ bc
+ max_conns=384
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 115000 -k 16384 -c 256 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 384'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 3e8f27687fee689ef71b3c94109daff8145710c69e27541ff02d1acee5d5200d has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 384'
Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 384
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 384
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u memcached -t 2 -m 4096 -n 550 -c 384
+ echo 'Starting client with -r 115000 -k 16384 -c 256 -f 512 -w 4'
Starting client with -r 115000 -k 16384 -c 256 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 115000 -k 16384 -c 256 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 60 -T 5 -r 115000 -k 16384 -c 256 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 60
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.240.2
Loading key value file...created uniform distribution 16384
rps 115000 cpus 4
meanInterarrival 34
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 1839806208
starting receive base loop
num_worker_connections 64
Creating worker on tid 1248098048
starting receive base loop
num_worker_connections 64
Creating worker on tid 648816384
starting receive base loop
Created 256 connections total
Creating worker on tid 58144512
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575410891.409316,       0.0,      300373,     270379,      29994,     178212,      92167,   3.629699,  12.100000,  15.900000,  23.800000,   5.938373,   0.000000,  59.034999, 474.299361
Outstanding requests per worker:
98 124 135 113 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117619.9,      588100,     529237,      58863,     393951,     135286,   4.687436,  13.600000,  17.200000,  25.800000,   6.392077,   0.023000,  59.379000, 568.383943
Outstanding requests per worker:
175 178 158 145 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117680.3,      588402,     529883,      58519,     416039,     113844,   4.911501,  14.200000,  18.000000,  27.200000,   6.711864,   0.024000,  65.107003, 611.807029
Outstanding requests per worker:
159 145 107 117 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117634.9,      588175,     529274,      58901,     427470,     101804,   4.754457,  13.900000,  16.200000,  26.600000,   6.370198,   0.023000,  49.770001, 637.024713
Outstanding requests per worker:
181 152 145 136 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117592.1,      587961,     529051,      58910,     435634,      93417,   6.764379,  19.300000,  26.700000,  47.600000,  10.145424,   0.023000,  86.110003, 655.130394
Outstanding requests per worker:
268 192 239 231 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117715.9,      588580,     529218,      59362,     441706,      87512,   5.462572,  15.900000,  18.800000,  30.800000,   7.405958,   0.023000,  67.019999, 666.808145
Outstanding requests per worker:
171 139 142 157 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117626.5,      588133,     529442,      58691,     446879,      82563,   5.619308,  16.400000,  19.300000,  31.400000,   7.550210,   0.024000,  62.826000, 678.096379
Outstanding requests per worker:
174 197 198 184 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117679.7,      588399,     529258,      59141,     450919,      78339,   5.410298,  15.800000,  18.600000,  30.700000,   7.318090,   0.023000,  61.078999, 686.400455
Outstanding requests per worker:
133 169 151 162 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117359.3,      586797,     527902,      58895,     453170,      74732,  16.338442,  52.900000,  61.200000,  80.100000,  22.298955,   0.024000, 132.347003, 692.657211
Outstanding requests per worker:
529 533 544 473 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117945.7,      589729,     530580,      59149,     458145,      72435,  10.632609,  34.900000,  46.300000,  59.400000,  15.356808,   0.024000,  93.930997, 699.406265
Outstanding requests per worker:
156 181 112 175 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117305.9,      586530,     527379,      59151,     458228,      69151,  16.617817,  53.300000,  61.400000,  78.500000,  22.451855,   0.023000, 164.888993, 704.760423
Outstanding requests per worker:
598 570 629 560 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117961.9,      589810,     530604,      59206,     463547,      67057,   9.752773,  31.200000,  43.800000,  59.300000,  14.616004,   0.024000, 101.994000, 709.435455
Outstanding requests per worker:
220 183 222 180 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117658.7,      588294,     529613,      58681,     464537,      65076,   5.899256,  17.100000,  20.300000,  33.300000,   7.986594,   0.023000,  67.299999, 713.780883
Outstanding requests per worker:
184 212 170 220 
Ran for 62.000062, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.3  0.0  18032  2764 pts/0    Ss+  21:41   0:00 bash docker-ent
memcache     7  0.3  0.0  96552  6328 pts/0    S+   21:41   0:00 /usr/lib/linux-
memcache     8  155  0.0 413564 193412 pts/0   Sl+  21:41   1:56 memcached -t 2 
memcache    17  0.0  0.0  34424  2792 pts/1    Rs+  21:42   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 384':

       28650351293      instructions:u            #    0.60  insn per cycle         
      167803274192      instructions:k            #    0.61  insn per cycle         
      276878882138      cycles:k                                                    
       47991112700      cycles:u                                                    

      75.680392392 seconds time elapsed

+ for conns in '$CONNS'
+ for threads in '$THREADS'
+ for rps in '$RPS'
+ echo '==> Bench: 16384 keys, 512 conns, 4 threads, 115000 rps'
==> Bench: 16384 keys, 512 conns, 4 threads, 115000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 115000 -k 16384 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 3e8f27687fee689ef71b3c94109daff8145710c69e27541ff02d1acee5d5200d has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 115000 -k 16384 -c 512 -f 512 -w 4'
Starting client with -r 115000 -k 16384 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 115000 -k 16384 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 60 -T 5 -r 115000 -k 16384 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 60
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.240.2
Loading key value file...created uniform distribution 16384
rps 115000 cpus 4
meanInterarrival 34
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 549525248
starting receive base loop
num_worker_connections 128
Creating worker on tid 3736205056
starting receive base loop
num_worker_connections 128
Creating worker on tid 2630416128
starting receive base loop
Created 512 connections total
Creating worker on tid 1521612544
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575410969.409394,       0.0,      273127,     245688,      27439,     161410,      84278,   9.207487,  29.800000,  42.200000,  78.600000,  16.491833,   0.000000, 204.426005, 470.861332
Outstanding requests per worker:
168 187 151 161 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117644.9,      588225,     529700,      58525,     392981,     136719,   6.362731,  18.300000,  24.200000,  33.400000,   8.567601,   0.045000,  56.012999, 564.965552
Outstanding requests per worker:
192 150 177 205 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117649.1,      588246,     529242,      59004,     415014,     114228,   6.497797,  18.500000,  24.900000,  33.800000,   8.748222,   0.045000,  77.307999, 611.407439
Outstanding requests per worker:
163 174 194 210 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117643.9,      588220,     529568,      58652,     427523,     102045,   6.206636,  17.700000,  23.500000,  32.500000,   8.262951,   0.045000,  56.784999, 637.140010
Outstanding requests per worker:
199 190 199 215 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117669.1,      588346,     529407,      58939,     436150,      93257,   6.792338,  19.500000,  26.000000,  35.700000,   9.194768,   0.045000,  71.548998, 655.213324
Outstanding requests per worker:
180 202 168 175 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117667.3,      588337,     529263,      59074,     441835,      87428,   6.456333,  18.500000,  23.900000,  34.600000,   8.634589,   0.044000,  43.017998, 667.592726
Outstanding requests per worker:
182 148 150 191 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117620.5,      588103,     529727,      58376,     447313,      82414,   6.723421,  19.300000,  24.700000,  36.000000,   9.004532,   0.044000,  63.398004, 677.827492
Outstanding requests per worker:
220 209 186 214 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117644.7,      588224,     529286,      58938,     451145,      78141,   7.452911,  21.800000,  28.600000,  39.900000,  10.220926,   0.045000,  99.325001, 686.379513
Outstanding requests per worker:
188 228 237 220 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117665.3,      588327,     529602,      58725,     455022,      74580,   6.998430,  20.100000,  25.200000,  37.700000,   9.358635,   0.044000,  59.446000, 693.570421
Outstanding requests per worker:
180 199 188 242 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117649.3,      588247,     529581,      58666,     457586,      71995,   7.965831,  21.900000,  30.800000,  44.100000,  11.165123,   0.045000, 146.106005, 699.338352
Outstanding requests per worker:
204 220 215 206 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117605.7,      588029,     528664,      59365,     459235,      69429,   8.363648,  24.300000,  31.200000,  45.800000,  11.438090,   0.046000, 109.576002, 704.481175
Outstanding requests per worker:
236 317 261 265 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117706.7,      588534,     529893,      58641,     462732,      67161,   7.735298,  22.300000,  27.500000,  42.200000,  10.387267,   0.045000,  71.278997, 709.383721
Outstanding requests per worker:
198 204 186 224 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117630.9,      588155,     529287,      58868,     463821,      65466,   7.526894,  21.600000,  27.000000,  40.600000,  10.085083,   0.032000,  69.472998, 712.565385
Outstanding requests per worker:
247 212 257 204 
Ran for 62.000062, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'7\r'
+ echo 'memcached pid is: 7'
memcached pid is: 7
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.2  0.0  18032  2732 pts/0    Ss+  21:42   0:00 bash docker-ent
memcache     6  0.3  0.0  96552  6332 pts/0    S+   21:42   0:00 /usr/lib/linux-
memcache     7  154  0.0 411516 195204 pts/0   Sl+  21:42   1:56 memcached -t 2 
memcache    16  0.0  0.0  34424  2916 pts/1    Rs+  21:44   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       28537860627      instructions:u            #    0.60  insn per cycle         
      168911854668      instructions:k            #    0.61  insn per cycle         
      276009048577      cycles:k                                                    
       47522311107      cycles:u                                                    

      75.724749890 seconds time elapsed

+ for conns in '$CONNS'
+ for threads in '$THREADS'
+ for rps in '$RPS'
+ echo '==> Bench: 16384 keys, 1024 conns, 4 threads, 115000 rps'
==> Bench: 16384 keys, 1024 conns, 4 threads, 115000 rps
++ echo '1024 + 128'
++ bc
+ max_conns=1152
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 115000 -k 16384 -c 1024 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 1152'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 3e8f27687fee689ef71b3c94109daff8145710c69e27541ff02d1acee5d5200d has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 1152'
Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 1152
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 1152
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u memcached -t 2 -m 4096 -n 550 -c 1152
+ echo 'Starting client with -r 115000 -k 16384 -c 1024 -f 512 -w 4'
Starting client with -r 115000 -k 16384 -c 1024 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 115000 -k 16384 -c 1024 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 60 -T 5 -r 115000 -k 16384 -c 1024 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 60
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.240.2
Loading key value file...created uniform distribution 16384
rps 115000 cpus 4
meanInterarrival 34
num_worker_connections 256
num_worker_connections 256
Creating worker on tid 2125354752
starting receive base loop
num_worker_connections 256
Creating worker on tid 4289263360
starting receive base loop
num_worker_connections 256
Creating worker on tid 2157803264
starting receive base loop
Created 1024 connections total
Creating worker on tid 26343168
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575411047.409472,       0.0,      269546,     242410,      27136,     158635,      83775,  20.051955,  63.800000,  93.200000, 167.500000,  35.253102,   0.000000, 355.073005, 468.442424
Outstanding requests per worker:
354 369 336 335 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117698.1,      588491,     529686,      58805,     392564,     137122,  11.438326,  33.300000,  43.600000,  61.600000,  15.509834,   0.074000,  83.024003, 563.668060
Outstanding requests per worker:
284 304 306 298 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117602.1,      588011,     529612,      58399,     414736,     114876,  11.989114,  34.600000,  45.200000,  63.700000,  16.125610,   0.077000,  84.820002, 610.282469
Outstanding requests per worker:
350 386 330 384 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117658.3,      588292,     529627,      58665,     427225,     102402,  12.365286,  35.200000,  47.000000,  64.900000,  16.500558,   0.077000,  84.071003, 636.569635
Outstanding requests per worker:
345 338 371 376 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117653.3,      588267,     529417,      58850,     435229,      94188,  12.946326,  36.900000,  49.900000,  67.100000,  17.526840,   0.077000, 148.027003, 653.032264
Outstanding requests per worker:
382 354 346 369 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117643.5,      588218,     529266,      58952,     441268,      87998,  12.337622,  35.600000,  45.700000,  66.300000,  16.554766,   0.078000,  77.349000, 665.887493
Outstanding requests per worker:
377 354 345 426 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117639.7,      588199,     529512,      58687,     446791,      82721,  12.011378,  35.200000,  44.500000,  66.500000,  16.318865,   0.077000,  89.644000, 677.448925
Outstanding requests per worker:
410 410 369 385 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117665.7,      588329,     529077,      59252,     450728,      78349,  15.808420,  47.600000,  64.000000,  89.800000,  22.720365,   0.075000, 231.632993, 686.082848
Outstanding requests per worker:
354 387 376 397 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117638.7,      588194,     529356,      58838,     454622,      74734,  12.881272,  36.700000,  47.900000,  68.400000,  17.213844,   0.072000,  80.730997, 693.070023
Outstanding requests per worker:
450 375 384 382 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117753.3,      588767,     530063,      58704,     457302,      72761,  14.277872,  39.100000,  54.700000,  72.200000,  18.876719,   0.072000, 186.061993, 698.426800
Outstanding requests per worker:
302 269 263 273 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117582.7,      587914,     528902,      59012,     459326,      69576,  12.531515,  36.300000,  46.300000,  68.100000,  16.853427,   0.071000,  92.757002, 704.752342
Outstanding requests per worker:
353 384 356 368 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117611.7,      588059,     529124,      58935,     461735,      67389,  19.519808,  59.900000,  71.600000, 119.000000,  27.330481,   0.076000, 234.623000, 709.160754
Outstanding requests per worker:
492 387 393 400 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117656.5,      588283,     529520,      58763,     464082,      65438,  13.183801,  37.600000,  48.800000,  70.500000,  17.601684,   0.066000,  81.009001, 713.262440
Outstanding requests per worker:
409 416 364 470 
Ran for 62.000062, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.3  0.0  18032  2860 pts/0    Ss+  21:44   0:00 bash docker-ent
memcache     7  0.2  0.0  96552  6384 pts/0    S+   21:44   0:00 /usr/lib/linux-
memcache     8  150  0.0 411652 205700 pts/0   Sl+  21:44   1:56 memcached -t 2 
memcache    18  0.0  0.0  34424  2748 pts/1    Rs+  21:45   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 1152':

       28386779713      instructions:u            #    0.60  insn per cycle         
      168218596311      instructions:k            #    0.61  insn per cycle         
      277764568539      cycles:k                                                    
       47470836266      cycles:u                                                    

      76.753008303 seconds time elapsed

+ for keys in '$KEYS'
+ for conns in '$CONNS'
+ for threads in '$THREADS'
+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 256 conns, 4 threads, 115000 rps'
==> Bench: 65536 keys, 256 conns, 4 threads, 115000 rps
++ echo '256 + 128'
++ bc
+ max_conns=384
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 115000 -k 65536 -c 256 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 384'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 3e8f27687fee689ef71b3c94109daff8145710c69e27541ff02d1acee5d5200d has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 384'
Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 384
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 384
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u memcached -t 2 -m 4096 -n 550 -c 384
+ echo 'Starting client with -r 115000 -k 65536 -c 256 -f 512 -w 4'
Starting client with -r 115000 -k 65536 -c 256 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 115000 -k 65536 -c 256 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 60 -T 5 -r 115000 -k 65536 -c 256 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 60
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.240.2
Loading key value file...created uniform distribution 65536
rps 115000 cpus 4
meanInterarrival 34
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 3080562432
starting receive base loop
num_worker_connections 64
Creating worker on tid 2488104704
starting receive base loop
num_worker_connections 64
Creating worker on tid 1892136704
starting receive base loop
Created 256 connections total
Creating worker on tid 1296168704
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575411125.409550,       0.0,      298668,     268916,      29752,     176865,      92051,   3.373665,  11.200000,  14.800000,  22.100000,   5.507076,   0.000000,  56.871999, 473.393643
Outstanding requests per worker:
142 137 132 119 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117661.3,      588307,     529565,      58742,     393833,     135732,   4.212388,  12.300000,  15.300000,  23.100000,   5.684867,   0.023000,  49.633998, 567.585532
Outstanding requests per worker:
127 132 122 129 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117646.5,      588233,     529724,      58509,     415334,     114390,   4.986976,  14.200000,  18.600000,  28.200000,   7.005121,   0.023000,  78.906000, 611.947958
Outstanding requests per worker:
151 119 138 147 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117636.3,      588182,     529206,      58976,     427777,     101429,   4.422249,  12.900000,  15.400000,  24.600000,   5.941718,   0.023000,  51.454000, 637.141646
Outstanding requests per worker:
146 165 150 174 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117669.7,      588349,     529912,      58437,     436247,      93665,   5.110160,  14.600000,  19.200000,  29.200000,   7.238859,   0.023000,  78.463003, 654.295976
Outstanding requests per worker:
152 130 123 159 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117647.7,      588239,     529728,      58511,     442385,      87343,   4.827145,  14.100000,  16.400000,  26.900000,   6.463875,   0.023000,  50.962001, 667.882530
Outstanding requests per worker:
170 157 128 135 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117638.3,      588192,     529602,      58590,     447525,      82077,   5.045403,  14.700000,  17.200000,  28.200000,   6.766858,   0.023000,  54.347999, 678.555325
Outstanding requests per worker:
180 168 148 178 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117672.1,      588361,     529725,      58636,     451279,      78446,   5.278305,  15.400000,  18.000000,  29.600000,   7.081811,   0.024000,  56.526002, 686.070459
Outstanding requests per worker:
139 173 127 144 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117601.3,      588007,     529145,      58862,     453919,      75226,  12.191067,  41.200000,  51.500000,  63.700000,  17.484431,   0.024000, 126.063004, 692.554213
Outstanding requests per worker:
172 219 230 214 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117333.9,      586670,     528094,      58576,     456006,      72088,  12.932498,  28.700000,  41.700000,  56.400000,  12.218624,   0.061000,  91.862001, 698.343092
Outstanding requests per worker:
582 607 661 599 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117956.3,      589782,     531062,      58720,     461201,      69861,   9.464153,  18.100000,  22.700000,  39.800000,   7.418902,   0.115000,  86.815998, 703.987934
Outstanding requests per worker:
238 236 220 250 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117647.9,      588240,     529726,      58514,     462538,      67188,   8.076035,  14.100000,  18.700000,  24.100000,   5.184083,   0.068000,  42.969000, 709.261777
Outstanding requests per worker:
260 256 245 216 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117667.3,      588337,     529629,      58708,     464728,      64901,   8.166551,  14.400000,  18.700000,  24.400000,   5.255929,   0.087000,  45.230001, 714.324068
Outstanding requests per worker:
246 181 244 282 
Ran for 62.000062, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.3  0.0  18032  2784 pts/0    Ss+  21:45   0:00 bash docker-ent
memcache     7  0.3  0.0  96552  6468 pts/0    S+   21:45   0:00 /usr/lib/linux-
memcache     8  158  0.0 410492 190356 pts/0   Sl+  21:45   1:58 memcached -t 2 
memcache    19  0.0  0.0  34424  2864 pts/1    Rs+  21:46   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 384':

       28065468483      instructions:u            #    0.58  insn per cycle         
      167365753113      instructions:k            #    0.58  insn per cycle         
      289711089400      cycles:k                                                    
       48118426426      cycles:u                                                    

      75.740824632 seconds time elapsed

+ for conns in '$CONNS'
+ for threads in '$THREADS'
+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 115000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 115000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 115000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 3e8f27687fee689ef71b3c94109daff8145710c69e27541ff02d1acee5d5200d has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 115000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 115000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 115000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 60 -T 5 -r 115000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 60
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.240.2
Loading key value file...created uniform distribution 65536
rps 115000 cpus 4
meanInterarrival 34
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 179111680
starting receive base loop
num_worker_connections 128
Creating worker on tid 3368613632
starting receive base loop
num_worker_connections 128
Creating worker on tid 2259810048
starting receive base loop
Created 512 connections total
Creating worker on tid 1154021120
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575411203.409628,       0.0,      269291,     242161,      27130,     158486,      83675,   9.868642,  32.200000,  44.800000,  83.900000,  17.338557,   0.000000, 162.919998, 469.169420
Outstanding requests per worker:
170 210 181 193 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117658.5,      588293,     529490,      58803,     392724,     136766,   6.780480,  19.600000,  25.600000,  36.100000,   9.174765,   0.033000,  64.257003, 564.353019
Outstanding requests per worker:
161 201 179 209 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117646.9,      588235,     529451,      58784,     414690,     114761,   6.871002,  19.600000,  26.500000,  35.700000,   9.312148,   0.032000,  93.629003, 610.765636
Outstanding requests per worker:
176 199 164 238 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117648.7,      588244,     529468,      58776,     427069,     102399,   6.686270,  19.200000,  24.500000,  35.900000,   8.946336,   0.044000,  51.323000, 636.356263
Outstanding requests per worker:
197 209 192 219 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117655.3,      588277,     529220,      59057,     435349,      93871,   7.769384,  22.700000,  28.800000,  42.600000,  10.601137,   0.044000,  97.333997, 653.679152
Outstanding requests per worker:
185 233 200 184 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117652.7,      588264,     529266,      58998,     441849,      87417,   7.108198,  20.500000,  25.600000,  38.500000,   9.532358,   0.032000,  64.696997, 667.118645
Outstanding requests per worker:
214 225 184 197 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117641.3,      588207,     528983,      59224,     446074,      82909,   7.496711,  21.600000,  26.300000,  41.000000,  10.038024,   0.032000,  62.215999, 675.911362
Outstanding requests per worker:
223 200 249 203 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117629.1,      588146,     529574,      58572,     450822,      78752,   8.313913,  24.200000,  31.000000,  45.800000,  11.386960,   0.033000, 109.961003, 684.885512
Outstanding requests per worker:
244 264 228 258 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117678.3,      588392,     529303,      59089,     454468,      74835,   8.168445,  23.700000,  28.600000,  45.200000,  10.978871,   0.033000,  77.422000, 693.052036
Outstanding requests per worker:
216 219 193 235 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117634.9,      588175,     529036,      59139,     456680,      72356,   8.230033,  22.900000,  29.600000,  44.600000,  11.187762,   0.032000,  93.884997, 698.691603
Outstanding requests per worker:
232 242 208 272 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117661.7,      588309,     529505,      58804,     460023,      69482,   9.218245,  26.700000,  34.200000,  50.800000,  12.697269,   0.032000, 125.506997, 704.894162
Outstanding requests per worker:
276 212 231 209 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117682.7,      588414,     529819,      58595,     462446,      67373,   8.081643,  23.400000,  28.300000,  44.600000,  10.866917,   0.032000,  88.260002, 709.443974
Outstanding requests per worker:
195 217 196 170 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117603.3,      588017,     529167,      58850,     463640,      65527,   7.875830,  22.800000,  27.800000,  42.800000,  10.587406,   0.043000,  71.462996, 712.938343
Outstanding requests per worker:
258 266 248 258 
Ran for 62.000062, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.3  0.0  18032  2772 pts/0    Ss+  21:46   0:00 bash docker-ent
memcache     7  0.3  0.0  96552  6444 pts/0    S+   21:46   0:00 /usr/lib/linux-
memcache     8  154  0.0 412540 196168 pts/0   Sl+  21:46   1:55 memcached -t 2 
memcache    19  0.0  0.0  34424  2852 pts/1    Rs+  21:48   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       28515587944      instructions:u            #    0.60  insn per cycle         
      168257305294      instructions:k            #    0.61  insn per cycle         
      276240437422      cycles:k                                                    
       47287720816      cycles:u                                                    

      75.787354363 seconds time elapsed

+ for conns in '$CONNS'
+ for threads in '$THREADS'
+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 1024 conns, 4 threads, 115000 rps'
==> Bench: 65536 keys, 1024 conns, 4 threads, 115000 rps
++ bc
++ echo '1024 + 128'
+ max_conns=1152
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 115000 -k 65536 -c 1024 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 1152'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 3e8f27687fee689ef71b3c94109daff8145710c69e27541ff02d1acee5d5200d has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 1152'
Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 1152
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 1152
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u memcached -t 2 -m 4096 -n 550 -c 1152
+ echo 'Starting client with -r 115000 -k 65536 -c 1024 -f 512 -w 4'
Starting client with -r 115000 -k 65536 -c 1024 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 115000 -k 65536 -c 1024 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 60 -T 5 -r 115000 -k 65536 -c 1024 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 60
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.240.2
Loading key value file...created uniform distribution 65536
rps 115000 cpus 4
meanInterarrival 34
num_worker_connections 256
num_worker_connections 256
Creating worker on tid 2774652672
starting receive base loop
num_worker_connections 256
Creating worker on tid 641349376
starting receive base loop
num_worker_connections 256
Creating worker on tid 2804856576
starting receive base loop
Created 1024 connections total
Creating worker on tid 673396480
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575411282.409707,       0.0,      260753,     234677,      26076,     153061,      81616,  23.830011,  34.000000,  47.000000, 651.800000, 120.127443,   0.000000, 1952.481985, 465.797726
Outstanding requests per worker:
327 343 369 8864 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  119382.5,      596913,     537102,      59811,     398164,     138938,  36.640414,  35.700000,  50.000000, 1201.200000, 205.903225,   0.078000, 2891.792059, 564.437239
Outstanding requests per worker:
297 320 341 314 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117645.7,      588229,     529458,      58771,     414730,     114728,  10.874277,  31.200000,  42.600000,  56.500000,  14.551330,   0.071000,  64.312004, 610.432068
Outstanding requests per worker:
324 325 318 337 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117631.1,      588156,     529169,      58987,     427002,     102167,  11.347867,  33.200000,  43.400000,  61.000000,  15.397738,   0.071000,  92.706002, 636.036882
Outstanding requests per worker:
318 350 359 391 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117656.3,      588282,     529490,      58792,     436257,      93233,  11.670934,  33.200000,  45.100000,  60.500000,  15.535897,   0.074000,  68.584003, 654.472774
Outstanding requests per worker:
305 378 377 358 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117650.5,      588253,     529553,      58700,     442527,      87026,  12.561093,  35.700000,  48.300000,  64.600000,  16.914081,   0.074000, 150.594994, 667.388556
Outstanding requests per worker:
363 370 348 354 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117643.5,      588218,     529491,      58727,     446914,      82577,  11.989477,  34.100000,  45.900000,  62.600000,  15.986369,   0.075000,  71.820997, 677.653416
Outstanding requests per worker:
337 348 428 370 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117667.1,      588336,     529372,      58964,     450671,      78701,  11.985240,  34.100000,  46.100000,  62.700000,  16.016869,   0.070000,  71.492001, 685.997520
Outstanding requests per worker:
389 357 357 310 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117662.5,      588313,     529508,      58805,     454192,      75316,  13.693809,  39.800000,  54.200000,  70.000000,  19.022726,   0.075000, 188.659996, 692.900015
Outstanding requests per worker:
324 343 358 343 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117642.1,      588211,     529416,      58795,     457064,      72352,  14.018560,  37.500000,  54.500000,  76.200000,  19.504278,   0.074000, 182.555005, 698.490140
Outstanding requests per worker:
315 350 374 405 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117656.3,      588282,     529451,      58831,     459642,      69809,  11.987846,  34.500000,  45.600000,  64.100000,  16.118417,   0.074000,  93.579002, 703.480741
Outstanding requests per worker:
360 369 370 336 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117642.3,      588212,     529412,      58800,     462668,      66744,  12.265373,  34.900000,  46.600000,  64.300000,  16.352966,   0.078000,  72.470002, 709.826829
Outstanding requests per worker:
371 390 371 360 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117663.1,      588316,     529671,      58645,     463751,      65920,  12.030909,  34.300000,  46.300000,  63.000000,  16.098393,   0.078000,  73.521003, 712.003621
Outstanding requests per worker:
362 371 336 380 
Ran for 62.000062, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.3  0.0  18032  2852 pts/0    Ss+  21:48   0:00 bash docker-ent
memcache     7  0.2  0.0  96552  6460 pts/0    S+   21:48   0:00 /usr/lib/linux-
memcache     8  152  0.0 411660 204372 pts/0   Sl+  21:48   1:56 memcached -t 2 
memcache    17  0.0  0.0  34424  2812 pts/1    Rs+  21:49   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 1152':

       28334412282      instructions:u            #    0.59  insn per cycle         
      169227604729      instructions:k            #    0.61  insn per cycle         
      277582630023      cycles:k                                                    
       47754298354      cycles:u                                                    

      76.906934907 seconds time elapsed

+ for keys in '$KEYS'
+ for conns in '$CONNS'
+ for threads in '$THREADS'
+ for rps in '$RPS'
+ echo '==> Bench: 262114 keys, 256 conns, 4 threads, 115000 rps'
==> Bench: 262114 keys, 256 conns, 4 threads, 115000 rps
++ echo '256 + 128'
++ bc
+ max_conns=384
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 115000 -k 262114 -c 256 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 384'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 3e8f27687fee689ef71b3c94109daff8145710c69e27541ff02d1acee5d5200d has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 384'
Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 384
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 384
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u memcached -t 2 -m 4096 -n 550 -c 384
+ echo 'Starting client with -r 115000 -k 262114 -c 256 -f 512 -w 4'
Starting client with -r 115000 -k 262114 -c 256 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 115000 -k 262114 -c 256 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 60 -T 5 -r 115000 -k 262114 -c 256 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 60
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.240.2
Loading key value file...created uniform distribution 262114
rps 115000 cpus 4
meanInterarrival 34
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 2091673344
starting receive base loop
num_worker_connections 64
Creating worker on tid 1497495296
starting receive base loop
num_worker_connections 64
Creating worker on tid 901527296
starting receive base loop
Created 256 connections total
Creating worker on tid 308573952
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575411360.409785,       0.0,      297401,     267377,      30024,     176478,      90899,   3.529353,  11.800000,  15.500000,  23.500000,   5.780803,   0.000000,  61.567999, 474.742760
Outstanding requests per worker:
117 127 126 142 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117647.5,      588238,     529900,      58338,     394660,     135240,   4.247765,  12.300000,  15.500000,  23.100000,   5.744768,   0.023000,  53.130999, 568.021117
Outstanding requests per worker:
117 134 162 147 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117664.5,      588323,     529621,      58702,     415412,     114209,   4.355396,  12.700000,  15.600000,  24.000000,   5.867436,   0.023000,  54.317001, 611.448275
Outstanding requests per worker:
128 116 143 127 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117644.9,      588225,     529310,      58915,     427224,     102086,   4.245778,  12.300000,  14.700000,  23.400000,   5.675428,   0.024000,  47.796000, 636.363536
Outstanding requests per worker:
125 127 167 132 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117658.9,      588295,     529365,      58930,     435722,      93643,   5.472085,  15.300000,  21.500000,  37.600000,   8.166102,   0.023000,  86.586997, 654.440552
Outstanding requests per worker:
153 161 113 105 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117658.1,      588291,     529857,      58434,     442625,      87232,   4.746209,  13.800000,  16.100000,  26.400000,   6.334871,   0.022000,  47.081999, 667.576820
Outstanding requests per worker:
136 124 119 123 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117639.1,      588196,     529378,      58818,     446808,      82570,   4.711718,  13.800000,  16.300000,  26.300000,   6.329749,   0.023000,  52.832000, 677.565696
Outstanding requests per worker:
149 157 128 147 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117644.5,      588223,     529053,      59170,     451125,      77928,   4.987490,  14.600000,  17.000000,  27.800000,   6.669868,   0.023000,  52.409999, 686.572052
Outstanding requests per worker:
166 171 160 123 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117667.9,      588340,     529481,      58859,     454614,      74867,  10.135634,  33.300000,  45.800000,  59.800000,  15.152203,   0.024000,  96.568003, 692.817720
Outstanding requests per worker:
134 163 130 132 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117531.7,      587659,     528407,      59252,     456743,      71664,  13.330038,  45.500000,  55.600000,  73.300000,  19.279176,   0.023000, 132.627994, 699.419143
Outstanding requests per worker:
251 317 300 296 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117526.1,      587631,     528872,      58759,     459414,      69458,  13.424207,  45.700000,  55.700000,  71.000000,  19.331757,   0.023000, 161.522001, 704.594312
Outstanding requests per worker:
423 503 452 420 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117881.5,      589408,     530139,      59269,     462807,      67332,   8.207150,  23.700000,  35.200000,  52.500000,  12.070582,   0.023000,  86.317003, 709.526839
Outstanding requests per worker:
121 186 172 172 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117658.5,      588293,     529643,      58650,     464822,      64821,   5.812175,  16.900000,  20.000000,  32.900000,   7.867259,   0.023000,  68.250000, 713.555856
Outstanding requests per worker:
178 160 128 156 
Ran for 62.000062, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.3  0.0  18032  2768 pts/0    Ss+  21:49   0:00 bash docker-ent
memcache     7  0.2  0.0  96552  6468 pts/0    S+   21:49   0:00 /usr/lib/linux-
memcache     8  152  0.0 412540 192580 pts/0   Sl+  21:49   1:56 memcached -t 2 
memcache    17  0.0  0.0  34424  2852 pts/1    Rs+  21:50   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 384':

       28655708890      instructions:u            #    0.61  insn per cycle         
      168211048364      instructions:k            #    0.61  insn per cycle         
      277414518736      cycles:k                                                    
       47264646882      cycles:u                                                    

      76.136941447 seconds time elapsed

+ for conns in '$CONNS'
+ for threads in '$THREADS'
+ for rps in '$RPS'
+ echo '==> Bench: 262114 keys, 512 conns, 4 threads, 115000 rps'
==> Bench: 262114 keys, 512 conns, 4 threads, 115000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 115000 -k 262114 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 3e8f27687fee689ef71b3c94109daff8145710c69e27541ff02d1acee5d5200d has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 115000 -k 262114 -c 512 -f 512 -w 4'
Starting client with -r 115000 -k 262114 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 115000 -k 262114 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 60 -T 5 -r 115000 -k 262114 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 60
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.240.2
Loading key value file...created uniform distribution 262114
rps 115000 cpus 4
meanInterarrival 34
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 3915355904
starting receive base loop
num_worker_connections 128
Creating worker on tid 2812704512
starting receive base loop
num_worker_connections 128
Creating worker on tid 1706915584
starting receive base loop
Created 512 connections total
Creating worker on tid 598980352
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575411438.409863,       0.0,      271618,     244634,      26984,     159860,      84774,  16.036567,  53.900000,  81.400000, 121.000000,  27.800282,   0.000000, 190.450996, 467.831328
Outstanding requests per worker:
222 211 189 197 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117619.1,      588096,     529093,      59003,     391487,     137606,   6.716785,  19.400000,  25.300000,  35.700000,   9.056180,   0.045000,  77.987000, 563.743512
Outstanding requests per worker:
233 230 283 267 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117632.3,      588162,     529361,      58801,     414127,     115234,   7.448571,  21.500000,  27.900000,  40.100000,  10.087681,   0.033000,  95.154002, 609.875083
Outstanding requests per worker:
290 292 278 261 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117722.3,      588612,     530098,      58514,     427100,     102998,   7.015746,  20.100000,  25.800000,  37.600000,   9.426599,   0.045000,  65.798000, 635.421892
Outstanding requests per worker:
193 187 216 195 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117596.1,      587981,     529059,      58922,     434863,      94196,   7.609262,  22.100000,  29.000000,  40.800000,  10.390757,   0.032000,  90.591997, 652.859159
Outstanding requests per worker:
252 248 303 277 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117697.1,      588486,     529759,      58727,     441891,      87868,   7.605090,  22.000000,  26.700000,  41.700000,  10.201435,   0.044000,  72.976001, 666.260258
Outstanding requests per worker:
224 239 207 207 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117673.5,      588368,     529478,      58890,     446689,      82789,   7.657261,  22.100000,  26.800000,  42.000000,  10.272358,   0.032000,  72.577998, 677.501522
Outstanding requests per worker:
207 180 209 183 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117644.1,      588221,     529370,      58851,     450969,      78401,   7.734853,  22.500000,  26.800000,  42.800000,  10.378466,   0.044000,  72.172999, 685.475358
Outstanding requests per worker:
193 205 205 224 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117592.7,      587964,     528981,      58983,     453901,      75080,   9.115244,  26.700000,  34.000000,  51.600000,  12.647086,   0.045000, 128.199995, 692.716735
Outstanding requests per worker:
261 318 294 274 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117662.5,      588313,     529039,      59274,     457086,      71953,   9.326268,  25.700000,  34.600000,  53.800000,  13.085160,   0.032000, 131.392002, 698.572160
Outstanding requests per worker:
253 320 263 264 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117666.5,      588333,     529240,      59093,     459644,      69596,   9.481438,  27.400000,  33.900000,  52.500000,  12.895233,   0.032000, 118.587002, 704.165598
Outstanding requests per worker:
247 237 304 242 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117654.1,      588271,     529689,      58582,     462066,      67623,   8.605896,  25.000000,  29.900000,  47.800000,  11.583586,   0.044000,  89.378998, 708.422472
Outstanding requests per worker:
253 276 245 255 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117674.9,      588375,     529881,      58494,     464599,      65282,   8.543069,  24.800000,  29.100000,  47.300000,  11.450217,   0.045000,  88.338003, 713.804182
Outstanding requests per worker:
231 251 232 203 
Ran for 62.000062, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'9\r'
+ echo 'memcached pid is: 9'
memcached pid is: 9
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.3  0.0  18032  2836 pts/0    Ss+  21:50   0:00 bash docker-ent
memcache     8  0.3  0.0  96552  6436 pts/0    S+   21:50   0:00 /usr/lib/linux-
memcache     9  152  0.0 410492 195156 pts/0   Sl+  21:50   1:55 memcached -t 2 
memcache    18  0.0  0.0  34424  2768 pts/1    Rs+  21:52   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       28348580423      instructions:u            #    0.59  insn per cycle         
      168032245312      instructions:k            #    0.61  insn per cycle         
      275526869835      cycles:k                                                    
       47725114270      cycles:u                                                    

      76.215416598 seconds time elapsed

+ for conns in '$CONNS'
+ for threads in '$THREADS'
+ for rps in '$RPS'
+ echo '==> Bench: 262114 keys, 1024 conns, 4 threads, 115000 rps'
==> Bench: 262114 keys, 1024 conns, 4 threads, 115000 rps
++ echo '1024 + 128'
++ bc
+ max_conns=1152
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 115000 -k 262114 -c 1024 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 1152'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 3e8f27687fee689ef71b3c94109daff8145710c69e27541ff02d1acee5d5200d has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 1152'
Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 1152
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 1152
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u memcached -t 2 -m 4096 -n 550 -c 1152
+ echo 'Starting client with -r 115000 -k 262114 -c 1024 -f 512 -w 4'
Starting client with -r 115000 -k 262114 -c 1024 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 115000 -k 262114 -c 1024 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 60 -T 5 -r 115000 -k 262114 -c 1024 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 60
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.240.2
Loading key value file...created uniform distribution 262114
rps 115000 cpus 4
meanInterarrival 34
num_worker_connections 256
num_worker_connections 256
Creating worker on tid 1764484864
starting receive base loop
num_worker_connections 256
Creating worker on tid 3929683712
starting receive base loop
num_worker_connections 256
Creating worker on tid 1798223616
starting receive base loop
Created 1024 connections total
Creating worker on tid 3961730816
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575411517.409942,       0.0,      269518,     242530,      26988,     158425,      84105,  24.397394,  79.900000, 100.800000, 168.000000,  38.389690,   0.000000, 329.627007, 467.103092
Outstanding requests per worker:
674 681 630 659 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117896.9,      589485,     530336,      59149,     393300,     137036,  11.856381,  33.900000,  46.500000,  61.400000,  16.096799,   0.075000, 186.447993, 564.446193
Outstanding requests per worker:
392 328 375 350 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117651.1,      588256,     529283,      58973,     414889,     114394,  11.441958,  32.900000,  44.100000,  59.400000,  15.328941,   0.074000,  85.500002, 611.656256
Outstanding requests per worker:
374 388 314 386 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117659.1,      588296,     529540,      58756,     427792,     101748,  11.842896,  33.600000,  45.600000,  61.500000,  15.789544,   0.075000,  70.813999, 637.744537
Outstanding requests per worker:
348 354 344 391 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117663.7,      588319,     529403,      58916,     435725,      93678,  12.043089,  34.400000,  46.000000,  63.500000,  16.156171,   0.067000,  96.020997, 654.188220
Outstanding requests per worker:
346 324 325 408 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117642.1,      588211,     529806,      58405,     442129,      87677,  12.956646,  36.500000,  49.500000,  65.400000,  17.294322,   0.071000, 142.954007, 666.914497
Outstanding requests per worker:
382 352 404 328 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117684.3,      588422,     529589,      58833,     447377,      82212,  11.826932,  33.900000,  45.200000,  62.600000,  15.841167,   0.074000,  95.748998, 678.271254
Outstanding requests per worker:
321 318 331 335 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117625.3,      588127,     529391,      58736,     450780,      78611,  11.860626,  34.200000,  44.800000,  63.500000,  15.930400,   0.074000,  72.874002, 685.974726
Outstanding requests per worker:
341 369 380 359 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117645.3,      588227,     529001,      59226,     453969,      75032,  12.036324,  34.700000,  45.100000,  64.600000,  16.159187,   0.072000,  75.092003, 692.602844
Outstanding requests per worker:
372 374 373 377 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117651.9,      588260,     529112,      59148,     456658,      72454,  13.653889,  37.100000,  52.400000,  69.100000,  18.395499,   0.079000, 154.993996, 698.637888
Outstanding requests per worker:
411 366 379 369 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117455.9,      587280,     528605,      58675,     459496,      69109,  12.807191,  36.600000,  50.200000,  67.500000,  17.500811,   0.074000, 136.088997, 705.389260
Outstanding requests per worker:
633 571 657 652 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117870.1,      589351,     530407,      58944,     463270,      67137,  14.324669,  41.200000,  57.100000,  74.500000,  20.162661,   0.068000, 205.557004, 709.779811
Outstanding requests per worker:
346 376 362 346 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117397.9,      586990,     528075,      58915,     462703,      65372,  22.724080,  44.200000,  54.500000,  62.000000,  14.662298,   0.175000,  70.129000, 712.790996
Outstanding requests per worker:
708 715 661 628 
Ran for 62.000062, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'7\r'
+ echo 'memcached pid is: 7'
memcached pid is: 7
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.2  0.0  18032  2764 pts/0    Ss+  21:52   0:00 bash docker-ent
memcache     6  0.2  0.0  96552  6320 pts/0    S+   21:52   0:00 /usr/lib/linux-
memcache     7  153  0.0 410636 204264 pts/0   Sl+  21:52   1:56 memcached -t 2 
memcache    16  0.0  0.0  34424  2832 pts/1    Rs+  21:53   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 1152':

       28365964888      instructions:u            #    0.60  insn per cycle         
      168698441760      instructions:k            #    0.60  insn per cycle         
      279250486850      cycles:k                                                    
       47457104543      cycles:u                                                    

      77.361165877 seconds time elapsed

