+ for keys in '$KEYS'
+ for conns in '$CONNS'
+ for threads in '$THREADS'
+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 104000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 104000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 104000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 104000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 104000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 104000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 104000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 104000 cpus 4
meanInterarrival 38
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 3609573120
starting receive base loop
num_worker_connections 128
Creating worker on tid 2504210176
starting receive base loop
num_worker_connections 128
Creating worker on tid 1398421248
starting receive base loop
Created 512 connections total
Creating worker on tid 289617664
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575370618.369043,       0.0,      241149,     216854,      24295,     140958,      75896,   3.051192,   9.000000,  13.400000,  22.600000,   5.081856,   0.000000,  40.984999, 464.935081
Outstanding requests per worker:
59 51 50 47 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  105277.1,      526386,     473764,      52622,     348204,     125560,   2.329208,   7.000000,   8.200000,  10.800000,   2.921899,   0.033000,  14.374000, 557.233610
Outstanding requests per worker:
38 63 44 39 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  105251.7,      526259,     473420,      52839,     367927,     105493,   2.524176,   7.600000,   8.900000,  11.100000,   3.172514,   0.033000,  19.348999, 603.933002
Outstanding requests per worker:
70 70 61 67 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  105268.9,      526345,     473558,      52787,     379276,      94282,   2.483267,   7.700000,   8.700000,  10.300000,   3.071981,   0.033000,  12.591000, 630.462169
Outstanding requests per worker:
69 67 66 79 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  105276.5,      526383,     474144,      52239,     386586,      87558,   2.728604,   8.200000,   9.800000,  12.800000,   3.526267,   0.032000,  23.039000, 646.582635
Outstanding requests per worker:
55 60 68 56 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  105266.3,      526332,     473641,      52691,     392609,      81032,   2.567962,   8.000000,   9.200000,  10.700000,   3.193872,   0.033000,  13.541000, 660.415640
Outstanding requests per worker:
67 63 69 62 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  105270.9,      526355,     473871,      52484,     397298,      76573,   2.623267,   8.200000,   9.300000,  11.200000,   3.276741,   0.033000,  15.248000, 671.323738
Outstanding requests per worker:
63 58 71 59 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'7\r'
+ echo 'memcached pid is: 7'
memcached pid is: 7
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18032  2740 pts/0    Ss+  10:30   0:00 bash docker-ent
memcache     6  0.4  0.0  96672  6300 pts/0    S+   10:30   0:00 /usr/lib/linux-
memcache     7  130  0.0 271744 117620 pts/0   Sl+  10:30   0:58 memcached -t 2 
memcache    16  0.0  0.0  34424  2856 pts/1    Rs+  10:31   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       13172978401      instructions:u                                              
         635049120      L1-icache-load-misses                                       
        7277112148      icache.hit:u                                                

      45.728751854 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 106000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 106000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 106000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 106000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 106000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 106000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 106000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 106000 cpus 4
meanInterarrival 37
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 2036348672
starting receive base loop
num_worker_connections 128
Creating worker on tid 924313344
starting receive base loop
num_worker_connections 128
Creating worker on tid 4114822912
starting receive base loop
Created 512 connections total
Creating worker on tid 3006887680
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575370666.369091,       0.0,      248001,     223244,      24757,     145073,      78171,   4.718995,  14.800000,  22.300000,  37.200000,   8.032340,   0.000000,  64.508997, 463.584800
Outstanding requests per worker:
91 101 107 96 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108126.9,      540635,     486742,      53893,     357775,     128967,   3.427740,  10.600000,  12.700000,  16.400000,   4.466702,   0.032000,  27.918000, 558.273506
Outstanding requests per worker:
98 78 94 78 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108101.5,      540508,     486533,      53975,     379012,     107521,   3.510059,  10.900000,  13.200000,  16.200000,   4.563483,   0.032000,  26.379000, 605.935149
Outstanding requests per worker:
107 96 112 93 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108120.9,      540605,     486439,      54166,     390203,      96236,   3.598400,  11.100000,  13.700000,  16.700000,   4.651395,   0.032000,  21.912999, 631.378950
Outstanding requests per worker:
97 106 91 93 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108114.5,      540573,     486671,      53902,     398685,      87986,   3.915155,  12.100000,  14.800000,  18.900000,   5.165207,   0.032000,  34.497000, 649.962572
Outstanding requests per worker:
87 112 95 93 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108117.1,      540586,     486411,      54175,     404160,      82251,   3.733018,  11.500000,  14.400000,  17.100000,   4.836979,   0.033000,  22.185000, 662.838974
Outstanding requests per worker:
93 90 96 102 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108108.1,      540541,     486135,      54406,     408235,      77900,   3.729283,  11.500000,  14.300000,  17.300000,   4.834396,   0.032000,  20.656999, 672.618213
Outstanding requests per worker:
100 116 92 99 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'7\r'
+ echo 'memcached pid is: 7'
memcached pid is: 7
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18032  2788 pts/0    Ss+  10:31   0:00 bash docker-ent
memcache     6  0.4  0.0  96672  6480 pts/0    S+   10:31   0:00 /usr/lib/linux-
memcache     7  130  0.0 273792 119996 pts/0   Sl+  10:31   0:58 memcached -t 2 
memcache    17  0.0  0.0  34424  2812 pts/1    Rs+  10:32   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       13443441500      instructions:u                                              
         665629381      L1-icache-load-misses                                       
        7369528462      icache.hit:u                                                

      45.891385508 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 108000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 108000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 108000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 108000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 108000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 108000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 108000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 108000 cpus 4
meanInterarrival 37
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 3248293632
starting receive base loop
num_worker_connections 128
Creating worker on tid 2144630528
starting receive base loop
num_worker_connections 128
Creating worker on tid 1035826944
starting receive base loop
Created 512 connections total
Creating worker on tid 4221990656
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575370713.369138,       0.0,      246779,     221918,      24861,     144269,      77649,   4.738226,  13.500000,  24.200000,  42.500000,   9.084427,   0.000000, 127.669007, 463.067074
Outstanding requests per worker:
60 86 87 89 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108116.1,      540581,     486486,      54095,     357416,     129070,   3.063812,   9.500000,  11.100000,  14.300000,   3.941786,   0.032000,  25.071001, 557.490865
Outstanding requests per worker:
92 79 78 80 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108113.3,      540567,     486859,      53708,     378711,     108148,   3.170697,   9.900000,  11.700000,  14.300000,   4.080385,   0.032000,  25.123000, 604.922575
Outstanding requests per worker:
80 79 93 80 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108115.5,      540578,     486288,      54290,     389756,      96532,   3.174837,  10.000000,  11.800000,  14.000000,   4.039944,   0.033000,  17.718000, 631.323693
Outstanding requests per worker:
89 91 78 81 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108103.5,      540518,     486570,      53948,     397483,      89087,   3.455049,  10.700000,  12.800000,  15.900000,   4.510736,   0.032000,  29.905001, 647.479057
Outstanding requests per worker:
105 75 105 101 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108123.5,      540618,     486303,      54315,     402944,      83359,   3.354482,  10.500000,  12.600000,  15.100000,   4.297704,   0.032000,  20.006999, 660.166978
Outstanding requests per worker:
96 77 85 91 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108112.7,      540564,     486572,      53992,     408138,      78434,   3.383117,  10.600000,  12.700000,  15.400000,   4.344303,   0.032000,  20.338001, 672.360680
Outstanding requests per worker:
88 93 87 94 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'7\r'
+ echo 'memcached pid is: 7'
memcached pid is: 7
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18032  2784 pts/0    Ss+  10:32   0:00 bash docker-ent
memcache     6  0.4  0.0  96672  6404 pts/0    S+   10:32   0:00 /usr/lib/linux-
memcache     7  131  0.0 273792 119940 pts/0   Sl+  10:32   0:59 memcached -t 2 
memcache    17  0.0  0.0  34424  2872 pts/1    Rs+  10:32   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       13363252213      instructions:u                                              
         659659863      L1-icache-load-misses                                       
        7500238780      icache.hit:u                                                

      45.744147402 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 110000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 110000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 110000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 110000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 110000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 110000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 110000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 110000 cpus 4
meanInterarrival 36
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 1106532096
starting receive base loop
num_worker_connections 128
Creating worker on tid 5158656
starting receive base loop
num_worker_connections 128
Creating worker on tid 3191322368
starting receive base loop
Created 512 connections total
Creating worker on tid 2085533440
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575370761.369186,       0.0,      254552,     228880,      25672,     148824,      80056,   5.938274,  19.000000,  28.600000,  47.300000,  10.315843,   0.000000, 111.730002, 464.512832
Outstanding requests per worker:
132 117 135 135 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  111145.1,      555726,     500252,      55474,     368791,     131461,   4.056896,  12.300000,  15.500000,  19.900000,   5.334051,   0.033000,  31.700000, 559.391175
Outstanding requests per worker:
92 96 101 105 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  111089.9,      555450,     499970,      55480,     389742,     110228,   4.331524,  13.100000,  16.800000,  20.700000,   5.723823,   0.033000,  36.552001, 606.623203
Outstanding requests per worker:
140 119 133 139 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  111124.3,      555622,     499864,      55758,     401932,      97932,   4.288374,  12.700000,  16.700000,  20.900000,   5.617469,   0.033000,  26.811000, 633.219546
Outstanding requests per worker:
115 116 142 134 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  111127.1,      555636,     500076,      55560,     410349,      89727,   4.574294,  13.800000,  17.700000,  22.600000,   6.122664,   0.033000,  39.801002, 651.876811
Outstanding requests per worker:
130 112 116 93 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  111118.5,      555593,     500095,      55498,     415643,      84452,   4.298012,  12.800000,  17.000000,  20.600000,   5.636775,   0.033000,  25.485000, 662.486158
Outstanding requests per worker:
113 124 108 114 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  111109.9,      555550,     499737,      55813,     420427,      79310,   4.509785,  13.300000,  17.800000,  21.900000,   5.927087,   0.033000,  27.516000, 674.367573
Outstanding requests per worker:
108 106 137 137 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'7\r'
+ echo 'memcached pid is: 7'
memcached pid is: 7
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18032  2856 pts/0    Ss+  10:32   0:00 bash docker-ent
memcache     6  0.5  0.0  96672  6412 pts/0    S+   10:32   0:00 /usr/lib/linux-
memcache     7  128  0.0 275840 121824 pts/0   Sl+  10:32   0:59 memcached -t 2 
memcache    16 18.0  0.0  34424  2868 pts/1    Rs+  10:33   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       13762209548      instructions:u                                              
         668034561      L1-icache-load-misses                                       
        7688674815      icache.hit:u                                                

      45.747088585 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 112000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 112000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 112000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 112000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 112000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 112000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 112000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 112000 cpus 4
meanInterarrival 35
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 1605601024
starting receive base loop
num_worker_connections 128
Creating worker on tid 498956032
starting receive base loop
num_worker_connections 128
Creating worker on tid 3688134400
starting receive base loop
Created 512 connections total
Creating worker on tid 2579330816
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575370809.369234,       0.0,      264624,     238180,      26444,     155921,      82259,   6.706751,  22.200000,  29.900000,  49.000000,  11.398660,   0.000000, 135.399997, 467.989756
Outstanding requests per worker:
170 205 165 157 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114307.9,      571540,     514234,      57306,     380580,     133654,   5.523046,  15.900000,  21.500000,  28.300000,   7.353420,   0.033000,  42.011000, 562.614255
Outstanding requests per worker:
161 175 149 150 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114282.3,      571412,     514390,      57022,     401633,     112757,   5.653610,  16.300000,  22.000000,  29.000000,   7.574766,   0.034000,  50.143000, 608.117467
Outstanding requests per worker:
180 176 150 177 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114256.1,      571281,     514102,      57179,     414380,      99722,   5.870571,  16.800000,  23.100000,  30.000000,   7.903606,   0.044000,  78.763001, 634.787171
Outstanding requests per worker:
241 205 213 213 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114309.5,      571548,     514716,      56832,     422341,      92375,   6.048162,  17.300000,  23.100000,  31.600000,   8.088950,   0.032000,  47.589000, 651.804618
Outstanding requests per worker:
238 168 199 174 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114314.9,      571575,     514520,      57055,     428964,      85556,   6.014582,  17.200000,  22.900000,  31.400000,   8.012089,   0.033000,  40.474001, 666.507897
Outstanding requests per worker:
191 135 156 200 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114292.1,      571461,     514322,      57139,     433040,      81282,   6.025309,  17.200000,  23.100000,  31.400000,   8.048128,   0.033000,  41.744001, 675.411610
Outstanding requests per worker:
169 169 165 172 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18032  2884 pts/0    Ss+  10:33   0:00 bash docker-ent
memcache     7  0.4  0.0  96672  6416 pts/0    S+   10:33   0:00 /usr/lib/linux-
memcache     8  133  0.0 277888 124080 pts/0   Sl+  10:33   1:00 memcached -t 2 
memcache    17  0.0  0.0  34424  2904 pts/1    Rs+  10:34   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       14141223810      instructions:u                                              
         683461207      L1-icache-load-misses                                       
        7806416370      icache.hit:u                                                

      45.829392254 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 114000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 114000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 114000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 114000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 114000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 114000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 114000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 114000 cpus 4
meanInterarrival 35
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 3116275456
starting receive base loop
num_worker_connections 128
Creating worker on tid 2010412800
starting receive base loop
num_worker_connections 128
Creating worker on tid 901609216
starting receive base loop
Created 512 connections total
Creating worker on tid 4090787584
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575370857.369282,       0.0,      267710,     240959,      26751,     156917,      84042,   6.152861,  20.300000,  27.200000,  44.600000,  10.380218,   0.000000, 117.769003, 466.447454
Outstanding requests per worker:
168 153 125 131 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114289.5,      571448,     514349,      57099,     381232,     133117,   5.186403,  15.300000,  20.100000,  26.700000,   6.944615,   0.033000,  39.542999, 563.404132
Outstanding requests per worker:
129 164 159 156 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114300.1,      571501,     514183,      57318,     402930,     111253,   5.420296,  15.700000,  21.300000,  27.500000,   7.289374,   0.032000,  56.626000, 610.105250
Outstanding requests per worker:
117 126 154 169 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114285.7,      571429,     514306,      57123,     415507,      98799,   5.272474,  15.200000,  20.700000,  27.000000,   7.016228,   0.032000,  33.757001, 637.006191
Outstanding requests per worker:
166 130 144 171 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114288.7,      571444,     514475,      56969,     423185,      91290,   5.701368,  16.400000,  22.300000,  29.200000,   7.656453,   0.032000,  47.699999, 653.517053
Outstanding requests per worker:
163 136 167 153 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114275.1,      571376,     513919,      57457,     428173,      85746,   5.601251,  16.000000,  21.800000,  28.700000,   7.437670,   0.033000,  44.844002, 665.501933
Outstanding requests per worker:
165 206 160 184 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114303.3,      571517,     513977,      57540,     433025,      80952,   5.744609,  16.500000,  22.200000,  29.800000,   7.649436,   0.033000,  36.386002, 676.560511
Outstanding requests per worker:
150 171 165 170 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18032  2884 pts/0    Ss+  10:34   0:00 bash docker-ent
memcache     7  0.4  0.0  96672  6424 pts/0    S+   10:34   0:00 /usr/lib/linux-
memcache     8  133  0.0 277888 124192 pts/0   Sl+  10:34   1:00 memcached -t 2 
memcache    18  0.0  0.0  34424  2856 pts/1    Rs+  10:35   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       14159249236      instructions:u                                              
         669704710      L1-icache-load-misses                                       
        7894881892      icache.hit:u                                                

      45.818436627 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 116000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 116000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 116000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 116000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 116000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 116000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 116000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 116000 cpus 4
meanInterarrival 34
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 3024701184
starting receive base loop
num_worker_connections 128
Creating worker on tid 1916253952
starting receive base loop
num_worker_connections 128
Creating worker on tid 810465024
starting receive base loop
Created 512 connections total
Creating worker on tid 4001408768
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575370905.369330,       0.0,      268333,     241548,      26785,     157778,      83770,  15.156962,  49.400000,  74.800000, 117.700000,  26.328920,   0.000000, 195.151001, 467.431678
Outstanding requests per worker:
235 238 225 207 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117653.1,      588266,     529405,      58861,     392145,     137260,   7.278177,  21.100000,  27.200000,  39.000000,   9.861502,   0.044000,  89.088999, 564.092515
Outstanding requests per worker:
207 210 238 272 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117655.3,      588277,     529939,      58338,     415378,     114561,   7.614685,  22.300000,  28.300000,  42.000000,  10.366336,   0.044000,  91.476999, 611.563978
Outstanding requests per worker:
211 250 219 240 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117667.3,      588337,     529783,      58554,     427476,     102307,   7.324799,  21.200000,  26.000000,  39.900000,   9.831000,   0.044000,  70.611998, 637.101111
Outstanding requests per worker:
211 227 196 231 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117594.3,      587972,     529410,      58562,     435367,      94043,   8.635884,  25.200000,  31.600000,  47.800000,  11.780324,   0.044000, 119.153999, 653.673691
Outstanding requests per worker:
294 240 318 305 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117665.5,      588328,     529614,      58714,     441725,      87889,   8.385088,  24.300000,  29.500000,  46.200000,  11.287565,   0.044000,  93.866996, 666.350444
Outstanding requests per worker:
264 283 266 300 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117678.7,      588394,     529645,      58749,     446661,      82984,   8.743603,  25.400000,  29.600000,  48.600000,  11.715380,   0.044000,  90.588003, 676.330831
Outstanding requests per worker:
263 232 253 235 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18032  2880 pts/0    Ss+  10:35   0:00 bash docker-ent
memcache     7  0.5  0.0  96672  6332 pts/0    S+   10:35   0:00 /usr/lib/linux-
memcache     8  134  0.0 278912 126192 pts/0   Sl+  10:35   1:00 memcached -t 2 
memcache    17  0.0  0.0  34424  2852 pts/1    Rs+  10:36   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       14569512661      instructions:u                                              
         690224342      L1-icache-load-misses                                       
        8061058076      icache.hit:u                                                

      45.762436627 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 118000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 118000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 118000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 118000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 118000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 118000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 118000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 118000 cpus 4
meanInterarrival 33
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 2443839232
starting receive base loop
num_worker_connections 128
Creating worker on tid 1331803904
starting receive base loop
num_worker_connections 128
Creating worker on tid 230520576
starting receive base loop
Created 512 connections total
Creating worker on tid 3419698944
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575370952.369377,       0.0,      278178,     250443,      27735,     164145,      86298,  17.370481,  56.500000,  82.700000, 122.500000,  28.798622,   0.000000, 235.579997, 469.095020
Outstanding requests per worker:
335 250 278 321 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121265.9,      606330,     545979,      60351,     405388,     140591,   8.953025,  26.000000,  31.200000,  49.700000,  12.062384,   0.045000,  98.089002, 566.011955
Outstanding requests per worker:
277 234 224 225 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121195.1,      605976,     545365,      60611,     428459,     116906,   9.027186,  26.400000,  31.300000,  50.700000,  12.176702,   0.044000, 102.209002, 613.298732
Outstanding requests per worker:
266 261 289 259 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121193.9,      605970,     545434,      60536,     441651,     103783,   9.247414,  26.900000,  31.300000,  51.900000,  12.437310,   0.044000,  93.603998, 639.089408
Outstanding requests per worker:
302 300 302 312 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121204.7,      606024,     545027,      60997,     449539,      95488,  10.404933,  29.800000,  37.600000,  58.200000,  14.325035,   0.044000, 136.832997, 656.537271
Outstanding requests per worker:
344 324 311 306 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121234.9,      606175,     545629,      60546,     456524,      89105,   9.513791,  27.800000,  31.800000,  53.900000,  12.818947,   0.044000,  99.289998, 669.373263
Outstanding requests per worker:
311 314 295 295 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121212.1,      606061,     545641,      60420,     461296,      84345,   9.729617,  28.400000,  32.600000,  54.900000,  13.074218,   0.044000, 101.585999, 679.423520
Outstanding requests per worker:
339 263 353 288 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18032  2860 pts/0    Ss+  10:36   0:00 bash docker-ent
memcache     7  0.4  0.0  96672  6364 pts/0    S+   10:36   0:00 /usr/lib/linux-
memcache     8  132  0.0 283008 130236 pts/0   Sl+  10:36   1:00 memcached -t 2 
memcache    18  0.0  0.0  34424  2856 pts/1    Rs+  10:36   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       14963771053      instructions:u                                              
         676513397      L1-icache-load-misses                                       
        8192526731      icache.hit:u                                                

      45.925123951 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 120000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 120000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 120000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 120000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 120000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 120000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 120000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 120000 cpus 4
meanInterarrival 33
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 3210880768
starting receive base loop
num_worker_connections 128
Creating worker on tid 2109568768
starting receive base loop
num_worker_connections 128
Creating worker on tid 1003779840
starting receive base loop
Created 512 connections total
Creating worker on tid 4186711808
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575371000.369425,       0.0,      275258,     247574,      27684,     162158,      85416,  28.575289, 103.000000, 122.400000, 157.900000,  43.629978,   0.000000, 247.905999, 470.475898
Outstanding requests per worker:
1349 1308 1400 1332 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  120573.3,      602867,     542591,      60276,     403622,     138969,  62.042327, 165.100000, 190.000000, 236.500000,  71.102302,   0.044000, 368.454009, 567.187347
Outstanding requests per worker:
2196 2241 2069 2126 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  120901.9,      604510,     544079,      60431,     427260,     116819,  74.298810, 192.900000, 216.400000, 276.200000,  83.995554,   0.043000, 488.476008, 612.787018
Outstanding requests per worker:
2554 2487 2688 2486 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  120645.3,      603227,     542977,      60250,     438827,     104150,  97.574967, 247.800000, 279.900000, 344.800000, 107.599648,   0.044000, 508.412004, 638.011082
Outstanding requests per worker:
3304 3266 3277 3252 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  120151.3,      600757,     540463,      60294,     445769,      94694, 128.763492, 325.200000, 369.100000, 452.100000, 142.125488,   0.044000, 662.382007, 656.313790
Outstanding requests per worker:
4725 4602 4535 4578 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  120548.1,      602741,     542305,      60436,     452929,      89376, 163.689408, 404.600000, 456.800000, 564.200000, 178.852851,   0.045000, 917.508006, 668.025864
Outstanding requests per worker:
5339 5694 5563 5205 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  120599.7,      602999,     542650,      60349,     458144,      84506, 190.196417, 469.100000, 533.400000, 676.900000, 209.895621,   0.045000, 1048.738956, 677.246008
Outstanding requests per worker:
5948 6636 6188 6122 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18032  2864 pts/0    Ss+  10:36   0:00 bash docker-ent
memcache     7  0.5  0.0  96672  6468 pts/0    S+   10:36   0:00 /usr/lib/linux-
memcache     8  133  0.0 281984 134456 pts/0   Sl+  10:36   1:01 memcached -t 2 
memcache    18  0.0  0.0  34424  2852 pts/1    Rs+  10:37   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       14935232646      instructions:u                                              
         713295215      L1-icache-load-misses                                       
        8420649727      icache.hit:u                                                

      45.877670370 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 122000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 122000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 122000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 122000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 122000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 122000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 122000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 122000 cpus 4
meanInterarrival 32
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 3137222400
starting receive base loop
num_worker_connections 128
Creating worker on tid 2034448128
starting receive base loop
num_worker_connections 128
Creating worker on tid 928659200
starting receive base loop
Created 512 connections total
Creating worker on tid 4114822912
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575371048.369473,       0.0,      281381,     253290,      28091,     166553,      86737,  39.458559, 136.500000, 161.100000, 196.600000,  58.586443,   0.000000, 289.039999, 471.006909
Outstanding requests per worker:
2034 1984 2083 2232 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  123456.9,      617285,     555895,      61390,     412637,     143258,  96.950607, 254.800000, 289.600000, 359.600000, 110.214827,   0.044000, 619.120002, 565.100958
Outstanding requests per worker:
3932 3881 4087 4200 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  123220.9,      616105,     555071,      61034,     435954,     119117, 159.119760, 399.200000, 456.000000, 575.100000, 176.283833,   0.044000, 824.499011, 611.912546
Outstanding requests per worker:
6229 6176 6127 6498 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  122976.9,      614885,     553503,      61382,     447718,     105785, 236.299403, 502.700000, 579.100000, 726.400000, 196.851154,   0.104000, 981.002986, 638.574145
Outstanding requests per worker:
8540 8906 8484 9267 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121316.9,      606585,     545716,      60869,     449998,      95718, 357.015501, 618.700000, 711.800000, 869.200000, 185.318983,   0.719000, 1272.701025, 655.845040
Outstanding requests per worker:
13124 13556 12823 14157 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  120903.1,      604516,     544031,      60485,     454549,      89482, 502.968924, 806.900000, 917.600000, 1081.400000, 207.236271,  43.667998, 1340.085030, 668.754608
Outstanding requests per worker:
18518 18716 18000 18992 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  120776.7,      603884,     543618,      60266,     460162,      83456, 673.629664, 1028.400000, 1142.900000, 1339.300000, 244.765285, 126.883000, 1755.668044, 679.782851
Outstanding requests per worker:
23714 23734 23318 24624 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18032  2796 pts/0    Ss+  10:37   0:00 bash docker-ent
memcache     7  0.4  0.0  96672  6416 pts/0    S+   10:37   0:00 /usr/lib/linux-
memcache     8  141  0.0 283008 143424 pts/0   Sl+  10:37   1:03 memcached -t 2 
memcache    18  0.0  0.0  34424  2732 pts/1    Rs+  10:38   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       14819254396      instructions:u                                              
         690846987      L1-icache-load-misses                                       
        7815012763      icache.hit:u                                                

      45.813524597 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 124000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 124000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 124000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 124000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 124000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 124000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 124000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 124000 cpus 4
meanInterarrival 32
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 1428084480
starting receive base loop
num_worker_connections 128
Creating worker on tid 324060928
starting receive base loop
num_worker_connections 128
Creating worker on tid 3510843136
starting receive base loop
Created 512 connections total
Creating worker on tid 2405054208
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575371096.369521,       0.0,      280351,     252226,      28125,     165667,      86559,  39.154767, 134.400000, 159.000000, 195.300000,  58.039952,   0.000000, 341.439992, 471.178717
Outstanding requests per worker:
2107 2074 2190 2038 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  123392.3,      616962,     555534,      61428,     413447,     142087,  99.657024, 261.900000, 294.700000, 363.900000, 112.910898,   0.045000, 628.116012, 567.347907
Outstanding requests per worker:
4277 4006 3908 4306 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  123423.7,      617119,     555222,      61897,     436613,     118609, 157.952137, 394.400000, 450.300000, 557.900000, 174.368467,   0.046000, 924.633026, 614.166294
Outstanding requests per worker:
6344 6043 5914 6112 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  123104.5,      615523,     553984,      61539,     448275,     105709, 226.058415, 570.300000, 646.200000, 793.000000, 250.356386,   0.045000, 1378.201008, 638.732472
Outstanding requests per worker:
8738 8341 8445 8412 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121699.5,      608498,     547620,      60878,     451721,      95899, 322.506885, 833.200000, 930.100000, 1118.800000, 361.029619,   0.045000, 1748.263001, 656.503302
Outstanding requests per worker:
12719 12660 12639 12452 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121507.5,      607538,     546786,      60752,     457651,      89135, 456.661543, 1132.600000, 1246.300000, 1485.500000, 499.265795,   0.045000, 1914.494038, 669.748823
Outstanding requests per worker:
17038 17076 16662 17204 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121195.9,      605980,     545173,      60807,     461037,      84136, 598.906010, 1464.400000, 1604.600000, 1840.500000, 649.065057,   0.046000, 2218.405008, 679.289921
Outstanding requests per worker:
21787 21710 21705 21830 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18032  2844 pts/0    Ss+  10:38   0:00 bash docker-ent
memcache     7  0.4  0.0  96672  6464 pts/0    S+   10:38   0:00 /usr/lib/linux-
memcache     8  136  0.0 283008 135824 pts/0   Sl+  10:38   1:01 memcached -t 2 
memcache    17  0.0  0.0  34424  2872 pts/1    Rs+  10:39   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       15169452361      instructions:u                                              
         684153555      L1-icache-load-misses                                       
        8227026880      icache.hit:u                                                

      45.856560858 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 126000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 126000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 126000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 126000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 126000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 126000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 126000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 126000 cpus 4
meanInterarrival 31
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 1163376384
starting receive base loop
num_worker_connections 128
Creating worker on tid 56243968
starting receive base loop
num_worker_connections 128
Creating worker on tid 3242407680
starting receive base loop
Created 512 connections total
Creating worker on tid 2136618752
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575371144.369569,       0.0,      284050,     255520,      28530,     167769,      87751,  43.675364, 117.300000, 150.600000, 729.700000, 128.074730,   0.000000, 1678.668022, 471.668867
Outstanding requests per worker:
2081 2069 2207 6153 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  125836.1,      629181,     566269,      62912,     421684,     144585, 158.453194, 386.500000, 472.400000, 1344.900000, 233.418094,   0.045000, 1796.885014, 567.324733
Outstanding requests per worker:
6304 6329 6588 9319 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  124868.1,      624341,     562218,      62123,     442601,     119617, 291.556553, 727.100000, 832.200000, 1602.400000, 353.270899,   0.045000, 2387.062073, 614.927405
Outstanding requests per worker:
11315 11562 11597 14921 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  124028.5,      620143,     557486,      62657,     451536,     105950, 451.953691, 1115.100000, 1252.900000, 1967.700000, 519.653673,   0.045000, 3066.592932, 640.183558
Outstanding requests per worker:
17183 18059 17921 21306 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  123885.5,      619428,     557364,      62064,     460474,      96890, 644.641330, 1557.600000, 1705.000000, 2418.600000, 716.348591,   0.045000, 3415.577888, 658.057505
Outstanding requests per worker:
23784 24762 24404 27281 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  123182.7,      615914,     554338,      61576,     464131,      90207, 847.173881, 2014.800000, 2222.600000, 2837.300000, 926.882287,   0.044000, 3734.622002, 669.867501
Outstanding requests per worker:
31193 31982 31667 34686 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  119022.5,      595113,     535672,      59441,     453444,      82228, 1190.971830, 2468.200000, 2671.900000, 3292.400000, 1041.068715,   0.107000, 4180.267811, 679.918766
Outstanding requests per worker:
43761 44497 44108 47255 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18032  2784 pts/0    Ss+  10:39   0:00 bash docker-ent
memcache     7  0.4  0.0  96672  6440 pts/0    S+   10:39   0:00 /usr/lib/linux-
memcache     8  138  0.0 284032 144868 pts/0   Sl+  10:39   1:02 memcached -t 2 
memcache    18  0.0  0.0  34424  2852 pts/1    Rs+  10:39   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       15202774606      instructions:u                                              
         670683233      L1-icache-load-misses                                       
        8448079252      icache.hit:u                                                

      45.917394377 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 128000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 128000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 128000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 128000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 128000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 128000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 128000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 128000 cpus 4
meanInterarrival 31
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 796907264
starting receive base loop
num_worker_connections 128
Creating worker on tid 3987851008
starting receive base loop
num_worker_connections 128
Creating worker on tid 2882828032
starting receive base loop
Created 512 connections total
Creating worker on tid 1774024448
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575371191.369616,       0.0,      285065,     256695,      28370,     168217,      88478,  46.780416, 129.800000, 166.900000, 637.500000, 122.220541,   0.000000, 1597.944021, 470.108900
Outstanding requests per worker:
2587 2649 2462 5654 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  125065.1,      625326,     563026,      62300,     419223,     143803, 174.683420, 440.200000, 528.300000, 1196.200000, 240.149724,   0.045000, 1897.135019, 568.194646
Outstanding requests per worker:
7471 7705 7777 10290 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  124267.5,      621338,     559307,      62031,     439702,     119605, 329.127933, 833.100000, 965.300000, 1495.100000, 388.522261,   0.045000, 2524.533987, 614.607561
Outstanding requests per worker:
13725 13429 13902 16040 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  132918.9,      664595,     598139,      66456,     484604,     113535, 514.844198, 1197.800000, 1335.500000, 1900.900000, 533.973325,   0.045000, 2998.977900, 640.148308
Outstanding requests per worker:
9078 8771 8899 10961 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  130025.5,      650128,     585064,      65064,     484071,     100993, 184.192343, 467.400000, 544.700000, 718.100000, 208.787753,   0.046000, 2078.380108, 659.079154
Outstanding requests per worker:
8308 7991 8188 8286 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  124014.9,      620075,     557987,      62088,     468118,      89869, 335.360616, 865.100000, 958.000000, 1133.900000, 375.570555,   0.045000, 1450.500965, 672.009065
Outstanding requests per worker:
14578 14259 14405 14664 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  123188.1,      615941,     554277,      61664,     470058,      84219, 534.513706, 1321.300000, 1438.300000, 1628.100000, 584.553222,   0.046000, 2065.584898, 681.981744
Outstanding requests per worker:
21889 21497 21833 21941 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'7\r'
+ echo 'memcached pid is: 7'
memcached pid is: 7
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18032  2760 pts/0    Ss+  10:40   0:00 bash docker-ent
memcache     6  0.4  0.0  96672  6424 pts/0    S+   10:40   0:00 /usr/lib/linux-
memcache     7  134  0.0 285056 145940 pts/0   Sl+  10:40   1:01 memcached -t 2 
memcache    16  0.0  0.0  34424  2824 pts/1    Rs+  10:40   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       15684617359      instructions:u                                              
         664423765      L1-icache-load-misses                                       
        8623237400      icache.hit:u                                                

      45.874852604 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 130000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 130000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 130000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 130000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 130000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 130000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 130000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 130000 cpus 4
meanInterarrival 30
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 1159247616
starting receive base loop
num_worker_connections 128
Creating worker on tid 55224064
starting receive base loop
num_worker_connections 128
Creating worker on tid 3242407680
starting receive base loop
Created 512 connections total
Creating worker on tid 2136618752
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575371239.369664,       0.0,      290726,     261749,      28977,     172441,      89308,  68.403804, 229.200000, 268.900000, 331.400000,  99.602665,   0.000000, 535.848022, 474.082598
Outstanding requests per worker:
4566 4555 4338 4320 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  127250.3,      636252,     573266,      62986,     427380,     145886, 231.447562, 625.100000, 714.900000, 869.800000, 269.544939,   0.045000, 1273.527026, 568.835535
Outstanding requests per worker:
12239 12464 11742 11816 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  120265.3,      601327,     541281,      60046,     425779,     115502, 602.131475, 1134.600000, 1245.200000, 1431.200000, 394.848694,   0.081000, 1777.307034, 614.653960
Outstanding requests per worker:
28868 28828 28077 27879 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  119634.7,      598174,     538328,      59846,     435413,     102915, 1101.704358, 1662.100000, 1791.700000, 2003.800000, 412.834148, 138.236001, 2403.043032, 638.221618
Outstanding requests per worker:
45744 45798 45447 45248 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117218.1,      586091,     527566,      58525,     434608,      92958, 1680.409096, 2269.800000, 2408.200000, 2648.300000, 437.983527, 467.588991, 3095.511913, 655.163180
Outstanding requests per worker:
65545 66053 65759 65515 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117699.9,      588500,     529585,      58915,     442432,      87153, 2261.938941, 2863.100000, 3015.200000, 3281.400000, 449.484010, 826.502979, 3887.932062, 668.228401
Outstanding requests per worker:
85538 85323 84918 85355 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  116170.5,      580853,     522787,      58066,     441872,      80915, 2880.676501, 3503.200000, 3681.100000, 3972.700000, 473.439002, 1534.397960, 4684.150219, 679.369782
Outstanding requests per worker:
107088 106824 106409 106685 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18032  2840 pts/0    Ss+  10:40   0:00 bash docker-ent
memcache     7  0.3  0.0  96672  6460 pts/0    S+   10:40   0:00 /usr/lib/linux-
memcache     8  140  0.0 281984 142380 pts/0   Sl+  10:40   1:04 memcached -t 2 
memcache    18  0.0  0.0  34424  2800 pts/1    Rs+  10:41   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       14383850242      instructions:u                                              
         679754199      L1-icache-load-misses                                       
        7533578725      icache.hit:u                                                

      45.946303308 seconds time elapsed

+ for threads in '$THREADS'
+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 104000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 104000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 104000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 104000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 104000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 104000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 104000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 104000 cpus 8
meanInterarrival 76
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 2890503936
starting receive base loop
num_worker_connections 64
Creating worker on tid 2291222272
starting receive base loop
num_worker_connections 64
Creating worker on tid 1698821888
starting receive base loop
num_worker_connections 64
Creating worker on tid 1105868544
starting receive base loop
num_worker_connections 64
Creating worker on tid 509900544
starting receive base loop
num_worker_connections 64
Creating worker on tid 4208899840
starting receive base loop
num_worker_connections 64
Creating worker on tid 3612931840
starting receive base loop
Created 512 connections total
Creating worker on tid 3020928768
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575371288.369713,       0.0,      311855,     280701,      31154,     185514,      95187,   2.157285,   8.100000,  10.700000,  15.900000,   3.976518,   0.000000,  60.485002, 475.875063
Outstanding requests per worker:
47 33 35 39 28 40 35 33 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  105274.3,      526372,     473616,      52756,     352089,     121527,   2.692671,   8.700000,  10.400000,  14.200000,   3.766724,   0.023000,  25.257999, 566.722290
Outstanding requests per worker:
35 31 45 46 27 37 29 33 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  105256.1,      526281,     473650,      52631,     369716,     103934,   3.079445,   9.600000,  11.600000,  15.500000,   4.131759,   0.023000,  24.801999, 607.326800
Outstanding requests per worker:
44 41 40 60 41 43 44 51 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  105276.7,      526384,     473969,      52415,     380618,      93351,   3.117446,  10.000000,  11.800000,  14.100000,   4.085907,   0.023000,  18.495001, 632.612614
Outstanding requests per worker:
41 50 40 47 29 39 42 37 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  105262.5,      526313,     473564,      52749,     387570,      85994,   3.652898,  11.400000,  13.800000,  18.600000,   4.965300,   0.023000,  31.518001, 649.842851
Outstanding requests per worker:
54 54 41 47 39 47 35 42 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  105264.9,      526325,     473976,      52349,     393117,      80859,   3.289624,  10.500000,  12.600000,  15.400000,   4.347939,   0.023000,  19.583000, 661.153993
Outstanding requests per worker:
48 60 54 60 44 48 37 46 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  105274.3,      526372,     473384,      52988,     397814,      75570,   3.463834,  10.900000,  13.500000,  16.300000,   4.582093,   0.023000,  19.659000, 672.884164
Outstanding requests per worker:
45 39 41 54 46 48 45 51 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'7\r'
+ echo 'memcached pid is: 7'
memcached pid is: 7
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.4  0.0  18032  2860 pts/0    Ss+  10:41   0:00 bash docker-ent
memcache     6  0.3  0.0  96672  6464 pts/0    S+   10:41   0:00 /usr/lib/linux-
memcache     7  127  0.0 273792 119948 pts/0   Sl+  10:41   0:59 memcached -t 2 
memcache    16 18.0  0.0  34424  2864 pts/1    Rs+  10:42   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       13470890037      instructions:u                                              
         653627242      L1-icache-load-misses                                       
        7289819901      icache.hit:u                                                

      46.870011600 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 106000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 106000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 106000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 106000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 106000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 106000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 106000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 106000 cpus 8
meanInterarrival 75
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 1776011008
starting receive base loop
num_worker_connections 64
Creating worker on tid 1176729344
starting receive base loop
num_worker_connections 64
Creating worker on tid 585021184
starting receive base loop
num_worker_connections 64
Creating worker on tid 4284020480
starting receive base loop
num_worker_connections 64
Creating worker on tid 3688052480
starting receive base loop
num_worker_connections 64
Creating worker on tid 3092084480
starting receive base loop
num_worker_connections 64
Creating worker on tid 2492802816
starting receive base loop
Created 512 connections total
Creating worker on tid 1900148480
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575371337.369762,       0.0,      312866,     281493,      31373,     186031,      95462,   2.659922,  10.000000,  13.500000,  19.900000,   4.906087,   0.000000,  67.528002, 476.783622
Outstanding requests per worker:
52 56 51 47 42 53 46 45 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  106681.1,      533406,     480102,      53304,     357262,     122840,   3.828516,  12.000000,  14.800000,  18.600000,   5.146944,   0.023000,  32.825001, 567.364391
Outstanding requests per worker:
57 44 44 43 53 35 40 52 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  106655.1,      533276,     480180,      53096,     375674,     104506,   4.069444,  12.500000,  15.900000,  20.100000,   5.470789,   0.024000,  32.044999, 609.095818
Outstanding requests per worker:
44 61 58 70 59 68 49 57 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  106582.7,      532914,     479523,      53391,     385147,      94376,   8.411937,  16.600000,  18.800000,  24.200000,   5.663211,   0.048000,  37.190001, 633.513006
Outstanding requests per worker:
119 116 128 116 118 86 124 121 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  106680.1,      533401,     480162,      53239,     393225,      86937,   8.517627,  17.100000,  19.300000,  22.200000,   5.498348,   0.057000,  27.264001, 649.554402
Outstanding requests per worker:
120 101 108 122 108 123 107 105 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  106672.1,      533361,     480058,      53303,     398955,      81103,   8.500052,  16.900000,  19.300000,  22.400000,   5.499329,   0.051000,  27.925000, 662.905189
Outstanding requests per worker:
124 120 107 125 142 108 111 114 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  106678.7,      533394,     479619,      53775,     402800,      76819,   8.819769,  17.800000,  20.000000,  22.800000,   5.705491,   0.055000,  32.166999, 673.071671
Outstanding requests per worker:
110 99 99 124 120 138 125 107 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.4  0.0  18032  2852 pts/0    Ss+  10:42   0:00 bash docker-ent
memcache     7  0.5  0.0  96672  6412 pts/0    S+   10:42   0:00 /usr/lib/linux-
memcache     8  138  0.0 273792 120828 pts/0   Sl+  10:42   1:03 memcached -t 2 
memcache    17  0.0  0.0  34424  2856 pts/1    Rs+  10:43   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       13130533215      instructions:u                                              
         686608094      L1-icache-load-misses                                       
        6810775696      icache.hit:u                                                

      46.867715727 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 108000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 108000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 108000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 108000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 108000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 108000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 108000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 108000 cpus 8
meanInterarrival 74
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 2031019776
starting receive base loop
num_worker_connections 64
Creating worker on tid 1431738112
starting receive base loop
num_worker_connections 64
Creating worker on tid 842430208
starting receive base loop
num_worker_connections 64
Creating worker on tid 249476864
starting receive base loop
num_worker_connections 64
Creating worker on tid 3948476160
starting receive base loop
num_worker_connections 64
Creating worker on tid 3352508160
starting receive base loop
num_worker_connections 64
Creating worker on tid 2756540160
starting receive base loop
Created 512 connections total
Creating worker on tid 2164537088
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575371386.369811,       0.0,      319202,     287416,      31786,     190862,      96554,   3.297455,  12.200000,  16.700000,  25.600000,   6.418942,   0.000000, 167.189002, 479.787590
Outstanding requests per worker:
76 51 63 68 70 70 52 55 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108127.5,      540638,     486648,      53990,     362850,     123798,   4.558726,  13.900000,  17.900000,  23.300000,   6.200153,   0.023000,  36.244001, 568.520547
Outstanding requests per worker:
58 54 61 56 52 67 59 54 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108113.5,      540568,     486467,      54101,     380308,     106159,   4.753608,  14.300000,  18.800000,  24.300000,   6.452508,   0.023000,  37.292000, 609.742577
Outstanding requests per worker:
72 60 59 65 59 63 54 41 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108099.1,      540496,     486763,      53733,     391804,      94959,   4.850784,  14.400000,  19.500000,  24.700000,   6.549542,   0.022000,  29.806999, 634.566635
Outstanding requests per worker:
84 76 78 82 58 63 71 40 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108061.1,      540306,     486213,      54093,     398765,      87448,   5.502762,  16.500000,  22.100000,  29.000000,   7.710854,   0.023000,  77.601001, 651.129408
Outstanding requests per worker:
117 93 86 113 106 93 99 107 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108155.9,      540780,     486632,      54148,     404771,      81861,   5.675817,  16.500000,  22.500000,  29.700000,   7.717653,   0.023000,  54.131001, 663.431751
Outstanding requests per worker:
87 79 77 70 86 62 69 89 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108117.5,      540588,     486474,      54114,     408944,      77530,   5.547058,  16.300000,  22.100000,  29.400000,   7.587421,   0.023000,  36.662001, 673.579684
Outstanding requests per worker:
96 72 68 75 59 94 75 64 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'7\r'
+ echo 'memcached pid is: 7'
memcached pid is: 7
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.4  0.0  18032  2856 pts/0    Ss+  10:43   0:00 bash docker-ent
memcache     6  0.4  0.0  96672  6260 pts/0    S+   10:43   0:00 /usr/lib/linux-
memcache     7  130  0.0 274816 121944 pts/0   Sl+  10:43   1:00 memcached -t 2 
memcache    16  0.0  0.0  34424  2864 pts/1    Rs+  10:44   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       13646167269      instructions:u                                              
         639047160      L1-icache-load-misses                                       
        7378857873      icache.hit:u                                                

      46.874072986 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 110000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 110000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 110000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 110000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 110000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 110000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 110000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 110000 cpus 8
meanInterarrival 72
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 3638757120
starting receive base loop
num_worker_connections 64
Creating worker on tid 3047487232
starting receive base loop
num_worker_connections 64
Creating worker on tid 2456057600
starting receive base loop
num_worker_connections 64
Creating worker on tid 1860089600
starting receive base loop
num_worker_connections 64
Creating worker on tid 1264121600
starting receive base loop
num_worker_connections 64
Creating worker on tid 668153600
starting receive base loop
num_worker_connections 64
Creating worker on tid 72185600
starting receive base loop
Created 512 connections total
Creating worker on tid 3775149824
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575371434.369859,       0.0,      326642,     293937,      32705,     195570,      98367,   4.656459,  17.200000,  23.200000,  35.600000,   8.824264,   0.000000, 215.908006, 481.180416
Outstanding requests per worker:
110 90 77 94 71 94 92 53 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  111123.7,      555619,     500549,      55070,     373817,     126732,   6.329349,  18.500000,  24.400000,  33.900000,   8.674879,   0.023000,  63.198999, 569.798343
Outstanding requests per worker:
82 99 71 98 69 85 88 80 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  111102.5,      555513,     500173,      55340,     391626,     108547,   6.354062,  18.600000,  24.700000,  34.100000,   8.740238,   0.023000,  53.877000, 610.371877
Outstanding requests per worker:
76 101 86 92 88 119 90 102 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  111124.3,      555622,     500127,      55495,     402613,      97514,   6.376409,  18.500000,  24.400000,  34.200000,   8.686963,   0.023000,  56.177001, 634.654176
Outstanding requests per worker:
73 83 86 103 82 113 86 100 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  111114.1,      555571,     500275,      55296,     411065,      89210,   7.023281,  20.500000,  27.100000,  37.900000,   9.698624,   0.023000,  85.991003, 652.753977
Outstanding requests per worker:
82 101 95 96 71 107 102 87 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  111119.1,      555596,     499923,      55673,     416483,      83440,   6.577872,  19.200000,  24.900000,  35.800000,   8.993028,   0.023000,  58.502000, 664.670635
Outstanding requests per worker:
88 95 79 85 99 102 101 101 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  111123.1,      555616,     499740,      55876,     420256,      79484,   6.888119,  20.100000,  25.600000,  37.700000,   9.417931,   0.023000,  62.008001, 674.228631
Outstanding requests per worker:
81 98 91 85 100 88 90 88 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18032  2736 pts/0    Ss+  10:44   0:00 bash docker-ent
memcache     7  0.4  0.0  96672  6464 pts/0    S+   10:44   0:00 /usr/lib/linux-
memcache     8  129  0.0 276864 124264 pts/0   Sl+  10:44   1:00 memcached -t 2 
memcache    17  0.0  0.0  34424  2800 pts/1    Rs+  10:44   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       13994021614      instructions:u                                              
         663249316      L1-icache-load-misses                                       
        7745274396      icache.hit:u                                                

      46.911188312 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 112000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 112000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 112000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 112000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 112000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 112000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 112000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 112000 cpus 8
meanInterarrival 71
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 1975531264
starting receive base loop
num_worker_connections 64
Creating worker on tid 1382315776
starting receive base loop
num_worker_connections 64
Creating worker on tid 786347776
starting receive base loop
num_worker_connections 64
Creating worker on tid 190379776
starting receive base loop
num_worker_connections 64
Creating worker on tid 3889379072
starting receive base loop
num_worker_connections 64
Creating worker on tid 3293411072
starting receive base loop
num_worker_connections 64
Creating worker on tid 2697443072
starting receive base loop
Created 512 connections total
Creating worker on tid 2101475072
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575371483.369908,       0.0,      333714,     300240,      33474,     199532,     100708,   9.193690,  23.200000,  28.800000,  43.200000,  11.126146,   0.000000, 267.616004, 480.759432
Outstanding requests per worker:
183 155 142 122 160 178 173 176 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  112665.5,      563328,     507175,      56153,     378562,     128613,  12.368062,  24.100000,  29.300000,  35.700000,   8.312122,   0.056000,  60.802002, 570.190092
Outstanding requests per worker:
167 184 203 177 170 166 184 176 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  112680.5,      563403,     507160,      56243,     397950,     109210,  13.193131,  25.700000,  31.200000,  38.400000,   8.942295,   0.054000,  84.756002, 612.232167
Outstanding requests per worker:
182 208 187 169 194 192 172 176 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  112770.1,      563851,     507122,      56729,     409108,      98014,  11.724164,  24.600000,  31.000000,  38.400000,   9.606558,   0.024000,  84.950998, 636.838826
Outstanding requests per worker:
134 117 146 142 134 133 118 125 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  112763.9,      563820,     507596,      56224,     417373,      90223,   6.771503,  20.000000,  25.700000,  37.600000,   9.400192,   0.023000,  81.106998, 653.024401
Outstanding requests per worker:
58 75 100 100 70 91 79 62 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  112671.9,      563360,     507315,      56045,     422719,      84596,   5.506010,  16.700000,  21.100000,  31.800000,   7.737108,   0.023000,  41.595999, 665.754900
Outstanding requests per worker:
86 95 88 90 83 79 91 96 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  112685.5,      563428,     506756,      56672,     427342,      79414,   6.550331,  19.200000,  24.800000,  36.000000,   8.997351,   0.022000,  59.900001, 676.769499
Outstanding requests per worker:
93 84 72 73 91 93 78 103 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'7\r'
+ echo 'memcached pid is: 7'
memcached pid is: 7
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.4  0.0  18032  2736 pts/0    Ss+  10:44   0:00 bash docker-ent
memcache     6  0.4  0.0  96672  6464 pts/0    S+   10:44   0:00 /usr/lib/linux-
memcache     7  135  0.0 278912 126060 pts/0   Sl+  10:44   1:03 memcached -t 2 
memcache    16  0.0  0.0  34424  2868 pts/1    Rs+  10:45   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       14026551625      instructions:u                                              
         717548113      L1-icache-load-misses                                       
        7286278781      icache.hit:u                                                

      46.865801077 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 114000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 114000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 114000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 114000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 114000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 114000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 114000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 114000 cpus 8
meanInterarrival 70
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 1938036480
starting receive base loop
num_worker_connections 64
Creating worker on tid 1347254016
starting receive base loop
num_worker_connections 64
Creating worker on tid 751286016
starting receive base loop
num_worker_connections 64
Creating worker on tid 155318016
starting receive base loop
num_worker_connections 64
Creating worker on tid 3857331968
starting receive base loop
num_worker_connections 64
Creating worker on tid 3261363968
starting receive base loop
num_worker_connections 64
Creating worker on tid 2665395968
starting receive base loop
Created 512 connections total
Creating worker on tid 2069427968
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575371532.369957,       0.0,      334646,     301457,      33189,     200205,     101252,   5.717629,  21.100000,  27.800000,  44.500000,  11.424376,   0.000000, 310.146987, 479.170409
Outstanding requests per worker:
115 98 76 98 100 106 117 96 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114250.5,      571253,     514265,      56988,     384096,     130169,   8.091751,  23.900000,  29.400000,  45.400000,  11.126005,   0.023000,  99.280998, 570.212110
Outstanding requests per worker:
115 124 127 135 123 126 140 142 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114277.9,      571390,     514236,      57154,     403996,     110240,   7.831300,  23.800000,  28.300000,  46.200000,  10.945635,   0.022000,  82.120001, 613.124579
Outstanding requests per worker:
139 147 161 153 106 124 164 130 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114315.1,      571576,     514624,      56952,     415809,      98815,   8.872738,  26.100000,  31.400000,  50.000000,  12.193381,   0.023000, 104.610004, 637.772986
Outstanding requests per worker:
152 108 108 123 119 114 173 109 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114282.1,      571411,     513862,      57549,     422988,      90874,   9.060217,  26.900000,  30.800000,  51.900000,  12.383388,   0.023000,  91.317996, 654.243163
Outstanding requests per worker:
116 153 120 178 135 138 90 127 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114300.3,      571502,     514313,      57189,     429589,      84724,   9.066514,  26.900000,  31.000000,  52.100000,  12.404566,   0.023000,  91.254003, 667.158818
Outstanding requests per worker:
116 125 114 135 161 163 129 94 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114289.3,      571447,     514195,      57252,     433627,      80568,  10.945992,  31.100000,  42.200000,  62.400000,  15.706607,   0.023000, 159.747005, 676.006476
Outstanding requests per worker:
126 113 128 131 121 133 157 141 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18032  2864 pts/0    Ss+  10:45   0:00 bash docker-ent
memcache     7  0.3  0.0  96672  6404 pts/0    S+   10:45   0:00 /usr/lib/linux-
memcache     8  132  0.0 279936 127788 pts/0   Sl+  10:45   1:01 memcached -t 2 
memcache    18  0.0  0.0  34424  2820 pts/1    Rs+  10:46   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       14391023931      instructions:u                                              
         662212142      L1-icache-load-misses                                       
        7813484345      icache.hit:u                                                

      46.835866075 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 116000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 116000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 116000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 116000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 116000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 116000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 116000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 116000 cpus 8
meanInterarrival 68
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 273987328
starting receive base loop
num_worker_connections 64
Creating worker on tid 3977684736
starting receive base loop
num_worker_connections 64
Creating worker on tid 3384555264
starting receive base loop
num_worker_connections 64
Creating worker on tid 2791601920
starting receive base loop
num_worker_connections 64
Creating worker on tid 2195633920
starting receive base loop
num_worker_connections 64
Creating worker on tid 1599665920
starting receive base loop
num_worker_connections 64
Creating worker on tid 1003697920
starting receive base loop
Created 512 connections total
Creating worker on tid 407729920
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575371581.370006,       0.0,      344982,     310484,      34498,     207480,     103004,   5.187064,  19.700000,  26.100000,  43.100000,  10.031140,   0.000000, 186.308995, 483.377169
Outstanding requests per worker:
92 110 81 127 115 118 101 116 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117594.7,      587974,     529272,      58702,     397366,     131906,   8.810206,  26.100000,  31.700000,  49.800000,  12.141480,   0.023000, 111.575998, 574.203224
Outstanding requests per worker:
163 152 158 141 97 174 126 166 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117673.5,      588368,     529772,      58596,     416659,     113113,   9.205559,  27.300000,  31.300000,  52.800000,  12.585297,   0.023000,  98.729998, 614.530838
Outstanding requests per worker:
159 125 150 150 137 127 125 112 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117656.5,      588283,     529630,      58653,     428722,     100908,  10.001889,  29.400000,  34.900000,  57.300000,  13.782904,   0.022000, 118.708998, 639.541310
Outstanding requests per worker:
141 128 135 113 125 131 174 127 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117627.3,      588137,     529130,      59007,     436403,      92727,   9.821068,  29.100000,  33.400000,  56.400000,  13.434510,   0.022000, 106.046997, 655.790792
Outstanding requests per worker:
148 143 122 142 130 170 154 191 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117660.3,      588302,     529372,      58930,     442652,      86720,   9.851317,  29.300000,  33.200000,  57.000000,  13.488944,   0.023000, 100.294001, 667.828502
Outstanding requests per worker:
171 154 141 133 150 135 138 168 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117670.5,      588353,     529466,      58887,     447164,      82302,   9.979594,  29.700000,  33.800000,  57.900000,  13.688940,   0.023000, 103.592999, 677.918856
Outstanding requests per worker:
170 150 140 134 102 130 121 159 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'7\r'
+ echo 'memcached pid is: 7'
memcached pid is: 7
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18032  2860 pts/0    Ss+  10:46   0:00 bash docker-ent
memcache     6  0.5  0.0  96672  6380 pts/0    S+   10:46   0:00 /usr/lib/linux-
memcache     7  133  0.0 281984 130268 pts/0   Sl+  10:46   1:01 memcached -t 2 
memcache    17  0.0  0.0  34424  2796 pts/1    Rs+  10:47   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       14897092569      instructions:u                                              
         667368600      L1-icache-load-misses                                       
        8155352400      icache.hit:u                                                

      46.849641245 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 118000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 118000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 118000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 118000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 118000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 118000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 118000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 118000 cpus 8
meanInterarrival 67
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 1663293184
starting receive base loop
num_worker_connections 64
Creating worker on tid 1070806784
starting receive base loop
num_worker_connections 64
Creating worker on tid 474838784
starting receive base loop
num_worker_connections 64
Creating worker on tid 4173838080
starting receive base loop
num_worker_connections 64
Creating worker on tid 3577870080
starting receive base loop
num_worker_connections 64
Creating worker on tid 2984916736
starting receive base loop
num_worker_connections 64
Creating worker on tid 2388948736
starting receive base loop
Created 512 connections total
Creating worker on tid 1792980736
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575371630.370055,       0.0,      349460,     314728,      34732,     209569,     105159,   7.848559,  27.900000,  36.000000,  62.900000,  17.365380,   0.000000, 424.255013, 482.131002
Outstanding requests per worker:
162 132 160 171 148 137 174 160 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  119383.1,      596916,     537123,      59793,     402651,     134472,  11.428715,  33.400000,  40.400000,  66.000000,  15.837218,   0.023000, 135.379001, 573.514093
Outstanding requests per worker:
170 141 235 186 180 135 187 159 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  118800.5,      594003,     534934,      59069,     421090,     113844,  19.814864,  62.500000,  88.900000, 119.100000,  29.696233,   0.023000, 195.608005, 615.343403
Outstanding requests per worker:
547 494 674 633 533 515 545 516 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117888.1,      589441,     530649,      58792,     429192,     101457,  70.438758, 192.700000, 218.600000, 278.800000,  82.514721,   0.023000, 447.719008, 639.673032
Outstanding requests per worker:
1472 1536 1510 1540 1362 1564 1482 1598 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121523.3,      607617,     547702,      59915,     451338,      96364,  61.307555, 234.800000, 283.800000, 361.600000,  99.933258,   0.023000, 515.133977, 655.604225
Outstanding requests per worker:
177 183 175 238 191 201 164 166 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  118476.5,      592383,     532920,      59463,     445579,      87341,  21.519176,  70.300000,  98.900000, 137.200000,  33.396759,   0.023000, 280.499995, 667.901843
Outstanding requests per worker:
723 728 802 849 632 786 775 882 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117617.1,      588086,     529711,      58375,     447476,      82235,  89.365916, 237.100000, 279.900000, 355.500000, 103.968209,   0.023000, 531.325996, 677.625898
Outstanding requests per worker:
1943 1831 1861 1904 1747 1978 1956 1917 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'7\r'
+ echo 'memcached pid is: 7'
memcached pid is: 7
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.4  0.0  18032  2788 pts/0    Ss+  10:47   0:00 bash docker-ent
memcache     6  0.4  0.0  96672  6316 pts/0    S+   10:47   0:00 /usr/lib/linux-
memcache     7  134  0.0 281984 134672 pts/0   Sl+  10:47   1:01 memcached -t 2 
memcache    17  0.0  0.0  34424  2784 pts/1    Rs+  10:48   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       14934554331      instructions:u                                              
         677160219      L1-icache-load-misses                                       
        8263705272      icache.hit:u                                                

      46.750096944 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 120000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 120000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 120000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 120000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 120000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 120000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 120000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 120000 cpus 8
meanInterarrival 66
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 185603840
starting receive base loop
num_worker_connections 64
Creating worker on tid 3889301248
starting receive base loop
num_worker_connections 64
Creating worker on tid 3293411072
starting receive base loop
num_worker_connections 64
Creating worker on tid 2697443072
starting receive base loop
num_worker_connections 64
Creating worker on tid 2101475072
starting receive base loop
num_worker_connections 64
Creating worker on tid 1508521728
starting receive base loop
num_worker_connections 64
Creating worker on tid 912553728
starting receive base loop
Created 512 connections total
Creating worker on tid 317536000
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575371678.370103,       0.0,      355157,     319793,      35364,     212746,     107047,  11.955554,  41.300000,  64.300000, 120.200000,  27.233952,   0.000000, 484.326005, 481.440932
Outstanding requests per worker:
203 206 147 179 216 230 259 187 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  119425.9,      597130,     537327,      59803,     403702,     133625,  46.004472, 144.300000, 180.900000, 236.100000,  63.811630,   0.024000, 397.406995, 575.450552
Outstanding requests per worker:
1325 1272 1342 1334 1376 1344 1307 1315 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  119192.9,      595965,     536508,      59457,     422821,     113687, 122.539476, 314.000000, 366.500000, 464.300000, 139.002848,   0.023000, 733.605027, 615.164432
Outstanding requests per worker:
2748 2508 2633 2613 2607 2534 2459 2659 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  119637.5,      598188,     537858,      60330,     435262,     102596, 198.542487, 494.400000, 563.300000, 704.500000, 219.830847,   0.023000, 1061.076999, 639.347828
Outstanding requests per worker:
3525 3639 3542 3817 3592 3306 3593 3649 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  118717.5,      593588,     534395,      59193,     441265,      93130, 278.586279, 711.600000, 809.900000, 994.100000, 311.568982,   0.024000, 1330.718994, 657.045564
Outstanding requests per worker:
5236 5280 5057 5317 5256 4779 5151 5095 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  118635.1,      593176,     533965,      59211,     446838,      87127, 383.842378, 979.200000, 1083.200000, 1278.300000, 423.138614,   0.023000, 1647.647023, 669.182883
Outstanding requests per worker:
6542 6772 6768 6870 6711 6661 6709 7075 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  118973.1,      594866,     535513,      59353,     452795,      82718, 480.740444, 1212.500000, 1334.800000, 1567.800000, 526.836259,   0.023000, 1998.705029, 679.348287
Outstanding requests per worker:
8252 8156 8220 8400 7961 8061 8099 8190 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'7\r'
+ echo 'memcached pid is: 7'
memcached pid is: 7
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18032  2760 pts/0    Ss+  10:48   0:00 bash docker-ent
memcache     6  0.5  0.0  96672  6380 pts/0    S+   10:48   0:00 /usr/lib/linux-
memcache     7  132  0.0 283008 136312 pts/0   Sl+  10:48   1:02 memcached -t 2 
memcache    16 18.0  0.0  34424  2864 pts/1    Rs+  10:48   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       15058232157      instructions:u                                              
         661924280      L1-icache-load-misses                                       
        8303456913      icache.hit:u                                                

      46.814377383 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 122000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 122000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 122000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 122000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 122000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 122000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 122000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 122000 cpus 8
meanInterarrival 65
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 4029040384
starting receive base loop
num_worker_connections 64
Creating worker on tid 3435640576
starting receive base loop
num_worker_connections 64
Creating worker on tid 2836358912
starting receive base loop
num_worker_connections 64
Creating worker on tid 2246719232
starting receive base loop
num_worker_connections 64
Creating worker on tid 1650751232
starting receive base loop
num_worker_connections 64
Creating worker on tid 1054783232
starting receive base loop
num_worker_connections 64
Creating worker on tid 458815232
starting receive base loop
Created 512 connections total
Creating worker on tid 4159796992
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575371727.370152,       0.0,      355665,     320104,      35561,     213820,     106284,  23.772018,  98.200000, 127.000000, 185.700000,  47.495087,   0.000000, 549.718022, 483.211028
Outstanding requests per worker:
983 932 958 899 907 895 899 1024 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  120486.7,      602434,     542199,      60235,     406926,     135273, 113.174104, 304.000000, 354.000000, 439.900000, 131.974083,   0.022000, 646.808982, 574.501532
Outstanding requests per worker:
2573 2596 2588 2656 2461 2563 2476 2587 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121918.7,      609594,     548882,      60712,     433485,     115397, 192.058883, 475.900000, 540.500000, 663.300000, 209.627950,   0.023000, 937.458992, 617.693597
Outstanding requests per worker:
3384 3304 3304 3543 3209 3004 3196 3392 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  124000.9,      620005,     557857,      62148,     452567,     105290, 154.364735, 413.200000, 492.800000, 688.600000, 182.829924,   0.023000, 996.011972, 640.978711
Outstanding requests per worker:
2677 3174 2522 2823 2684 2266 2859 2739 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  119350.3,      596752,     536825,      59927,     443989,      92836, 240.637735, 620.100000, 713.800000, 885.500000, 273.033108,   0.024000, 1381.024003, 658.632625
Outstanding requests per worker:
4918 5306 4778 5286 4771 4655 5432 5258 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  119275.7,      596379,     536716,      59663,     449628,      87088, 390.754915, 981.100000, 1085.600000, 1272.800000, 430.013320,   0.024000, 1667.678952, 670.319409
Outstanding requests per worker:
7403 7589 7191 7602 7376 7065 7785 7447 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  118727.1,      593636,     534717,      58919,     452359,      82358, 549.830169, 1345.300000, 1467.700000, 1691.300000, 597.007345,   0.024000, 2156.675100, 680.014550
Outstanding requests per worker:
10436 10645 9835 10069 10162 9685 10610 9800 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18032  2880 pts/0    Ss+  10:48   0:00 bash docker-ent
memcache     7  0.5  0.0  96672  6444 pts/0    S+   10:48   0:00 /usr/lib/linux-
memcache     8  135  0.0 284032 137772 pts/0   Sl+  10:48   1:02 memcached -t 2 
memcache    17  0.0  0.0  34424  2884 pts/1    Rs+  10:49   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       15251249677      instructions:u                                              
         683245882      L1-icache-load-misses                                       
        8418069926      icache.hit:u                                                

      46.754305651 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 124000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 124000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 124000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 124000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 124000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 124000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 124000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 124000 cpus 8
meanInterarrival 64
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 2306152192
starting receive base loop
num_worker_connections 64
Creating worker on tid 1714882304
starting receive base loop
num_worker_connections 64
Creating worker on tid 1121892096
starting receive base loop
num_worker_connections 64
Creating worker on tid 525924096
starting receive base loop
num_worker_connections 64
Creating worker on tid 4224923392
starting receive base loop
num_worker_connections 64
Creating worker on tid 3625641728
starting receive base loop
num_worker_connections 64
Creating worker on tid 3032987392
starting receive base loop
Created 512 connections total
Creating worker on tid 2442016512
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575371776.370201,       0.0,      358745,     323078,      35667,     215995,     107083,  25.592630, 104.800000, 134.100000, 194.500000,  53.341679,   0.000000, 667.677999, 483.615669
Outstanding requests per worker:
1057 907 997 1109 1176 1015 1072 1301 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121696.1,      608481,     547997,      60484,     412160,     135837, 132.822338, 358.300000, 412.100000, 512.400000, 154.558953,   0.023000, 767.769992, 575.871260
Outstanding requests per worker:
3201 3198 3205 3191 3104 3190 3012 3104 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121442.7,      607214,     546297,      60917,     431793,     114504, 254.914043, 655.000000, 745.100000, 896.200000, 285.802384,   0.023000, 1332.450986, 618.579749
Outstanding requests per worker:
5320 5492 5266 5416 5334 5561 5333 5322 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121051.5,      605258,     544923,      60335,     442145,     102778, 404.508357, 1012.900000, 1124.200000, 1344.800000, 446.643579,   0.023000, 1821.961999, 641.531433
Outstanding requests per worker:
7711 7900 7866 7898 7673 8071 7788 7914 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121744.1,      608721,     547751,      60970,     452634,      95117, 571.525326, 1392.700000, 1535.900000, 1803.200000, 618.492659,   0.023000, 2328.788996, 657.716534
Outstanding requests per worker:
9778 9811 9857 9828 9575 9941 10474 9761 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  120042.3,      600212,     540300,      59912,     452428,      87872, 699.844073, 1710.500000, 1861.300000, 2188.100000, 763.142438,   0.023000, 2677.468061, 670.354240
Outstanding requests per worker:
13088 13075 12690 12862 12906 13235 13182 12945 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  120021.1,      600106,     540106,      60000,     456539,      83567, 889.343702, 2129.900000, 2301.300000, 2602.400000, 958.451836,   0.024000, 3123.996973, 679.080114
Outstanding requests per worker:
16160 16369 15843 15866 15913 16204 16392 16166 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18032  2780 pts/0    Ss+  10:49   0:00 bash docker-ent
memcache     7  0.5  0.0  96672  6468 pts/0    S+   10:49   0:00 /usr/lib/linux-
memcache     8  136  0.0 283008 135720 pts/0   Sl+  10:49   1:02 memcached -t 2 
memcache    17  0.0  0.0  34424  2852 pts/1    Rs+  10:50   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       15362008807      instructions:u                                              
         695107362      L1-icache-load-misses                                       
        8488116256      icache.hit:u                                                

      46.816191947 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 126000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 126000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 126000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 126000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 126000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 126000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 126000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 126000 cpus 8
meanInterarrival 63
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 215435008
starting receive base loop
num_worker_connections 64
Creating worker on tid 3921426176
starting receive base loop
num_worker_connections 64
Creating worker on tid 3322144512
starting receive base loop
num_worker_connections 64
Creating worker on tid 2732504832
starting receive base loop
num_worker_connections 64
Creating worker on tid 2136536832
starting receive base loop
num_worker_connections 64
Creating worker on tid 1540568832
starting receive base loop
num_worker_connections 64
Creating worker on tid 944600832
starting receive base loop
Created 512 connections total
Creating worker on tid 348632832
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575371825.370250,       0.0,      363929,     327664,      36265,     219335,     108329,  27.439909, 113.400000, 143.100000, 205.100000,  53.245379,   0.000000, 535.703003, 485.143119
Outstanding requests per worker:
1025 1224 1149 1191 1201 1174 1119 1200 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  122975.7,      614879,     553541,      61338,     416457,     137084, 149.863209, 404.600000, 470.400000, 594.100000, 176.290588,   0.023000, 817.071974, 575.700869
Outstanding requests per worker:
3655 3714 3663 3675 3767 3888 3506 3518 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  122621.1,      613106,     551863,      61243,     435778,     116085, 302.540245, 774.700000, 873.800000, 1055.300000, 339.369513,   0.023000, 1451.362014, 617.470624
Outstanding requests per worker:
6182 6903 6254 6428 6838 6637 6099 5926 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  122215.5,      611078,     550324,      60754,     446599,     103725, 475.089156, 1191.700000, 1315.200000, 1526.900000, 524.484768,   0.023000, 2104.911089, 641.834634
Outstanding requests per worker:
8911 10085 9104 9353 9880 9596 9316 8898 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121331.1,      606656,     546036,      60620,     451364,      94672, 668.763902, 1649.500000, 1788.700000, 2075.500000, 732.892750,   0.023000, 2808.892012, 659.017250
Outstanding requests per worker:
12297 13520 12707 12910 13500 13030 13075 12413 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  129129.5,      645648,     580600,      65048,     486080,      94520, 923.411937, 2061.000000, 2206.600000, 2453.200000, 901.587834,   0.024000, 3244.837046, 670.291312
Outstanding requests per worker:
10916 12386 11326 11453 12396 11570 11949 10794 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  141953.7,      709769,     638740,      71029,     541855,      96885, 308.341148, 911.500000, 1180.200000, 1564.500000, 375.481255,   0.023000, 2702.662945, 682.277053
Outstanding requests per worker:
2040 2362 2245 2287 2309 2170 2371 2190 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18032  2772 pts/0    Ss+  10:50   0:00 bash docker-ent
memcache     7  0.4  0.0  96672  6424 pts/0    S+   10:50   0:00 /usr/lib/linux-
memcache     8  137  0.0 288128 147820 pts/0   Sl+  10:50   1:03 memcached -t 2 
memcache    17  0.0  0.0  34424  2864 pts/1    Rs+  10:51   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       15904834796      instructions:u                                              
         689612964      L1-icache-load-misses                                       
        8791567286      icache.hit:u                                                

      46.864180996 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 128000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 128000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 128000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 128000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 128000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 128000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 128000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 128000 cpus 8
meanInterarrival 62
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 959215360
starting receive base loop
num_worker_connections 64
Creating worker on tid 359933696
starting receive base loop
num_worker_connections 64
Creating worker on tid 4063655680
starting receive base loop
num_worker_connections 64
Creating worker on tid 3464374016
starting receive base loop
num_worker_connections 64
Creating worker on tid 2874734336
starting receive base loop
num_worker_connections 64
Creating worker on tid 2278766336
starting receive base loop
num_worker_connections 64
Creating worker on tid 1682798336
starting receive base loop
Created 512 connections total
Creating worker on tid 1090795264
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575371873.370298,       0.0,      364569,     327999,      36570,     219275,     108724,  35.673441, 144.900000, 187.200000, 282.700000,  72.258826,   0.000000, 726.185024, 485.046363
Outstanding requests per worker:
1689 1799 1619 1640 1676 1534 1585 2064 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  128748.1,      643741,     579619,      64122,     437048,     142571, 133.362409, 371.100000, 435.000000, 543.000000, 157.778259,   0.023000, 1058.822989, 577.753719
Outstanding requests per worker:
1822 1892 1814 1992 1893 1996 1922 1754 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  122847.7,      614239,     553559,      60680,     438767,     114792, 220.657793, 608.800000, 702.100000, 855.100000, 260.934194,   0.023000, 1168.048024, 620.588698
Outstanding requests per worker:
5996 5888 5673 5782 5745 5811 5615 5557 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  122669.9,      613350,     552179,      61171,     448044,     104135, 453.875886, 1137.300000, 1243.000000, 1409.200000, 500.841779,   0.024000, 1757.832050, 642.300998
Outstanding requests per worker:
9880 9976 9434 9936 9451 9947 9659 9639 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121799.7,      608999,     548277,      60722,     453668,      94609, 693.599375, 1691.700000, 1823.000000, 2065.100000, 761.056935,   0.024000, 2470.139980, 659.318542
Outstanding requests per worker:
14292 14458 13782 14647 13969 14554 14235 14188 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  135634.7,      678174,     609724,      68450,     511957,      97767, 930.123838, 2059.300000, 2193.800000, 2439.600000, 881.602698,   0.024000, 2900.331974, 671.900998
Outstanding requests per worker:
10274 10606 9372 10952 9787 10191 9872 10128 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121864.3,      609322,     548238,      61084,     465429,      82809, 719.033945, 1788.100000, 1942.000000, 2245.100000, 796.829094,   0.024000, 2979.619026, 682.752093
Outstanding requests per worker:
14517 14898 13948 15539 14158 14938 14440 14616 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'7\r'
+ echo 'memcached pid is: 7'
memcached pid is: 7
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18032  2864 pts/0    Ss+  10:51   0:00 bash docker-ent
memcache     6  0.3  0.0  96672  6412 pts/0    S+   10:51   0:00 /usr/lib/linux-
memcache     7  135  0.0 286080 146128 pts/0   Sl+  10:51   1:03 memcached -t 2 
memcache    16  0.0  0.0  34424  2860 pts/1    Rs+  10:52   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       15693161625      instructions:u                                              
         683367718      L1-icache-load-misses                                       
        8734681693      icache.hit:u                                                

      46.867771976 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 130000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 130000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 130000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,L1-icache-load-misses:u,icache.hit:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-icache-load-misses:u,icache.hit:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 130000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 130000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 130000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 130000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 130000 cpus 8
meanInterarrival 61
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 896661248
starting receive base loop
num_worker_connections 64
Creating worker on tid 305559296
starting receive base loop
num_worker_connections 64
Creating worker on tid 4001244928
starting receive base loop
num_worker_connections 64
Creating worker on tid 3411605248
starting receive base loop
num_worker_connections 64
Creating worker on tid 2815637248
starting receive base loop
num_worker_connections 64
Creating worker on tid 2219669248
starting receive base loop
num_worker_connections 64
Creating worker on tid 1623701248
starting receive base loop
Created 512 connections total
Creating worker on tid 1031698176
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575371922.370347,       0.0,      371403,     334213,      37190,     224158,     110055,  41.393953, 169.800000, 215.500000, 316.600000,  83.484822,   0.000000, 929.678023, 486.375102
Outstanding requests per worker:
2002 1908 2165 1785 1967 1973 1913 2447 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  123976.7,      619884,     558215,      61669,     420826,     137389, 242.032503, 671.600000, 776.000000, 941.100000, 288.718874,   0.023000, 1360.085964, 578.371165
Outstanding requests per worker:
6592 6517 6307 6511 6330 6364 6673 6783 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  123510.3,      617552,     555647,      61905,     439191,     116456, 507.308919, 1287.700000, 1408.200000, 1622.900000, 567.753842,   0.023000, 2146.374941, 618.196198
Outstanding requests per worker:
11217 11702 11130 11239 11224 10830 11239 11734 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  122778.7,      613894,     552393,      61501,     448840,     103553, 784.876746, 1926.400000, 2082.600000, 2341.400000, 867.099051,   0.024000, 2834.397078, 642.855668
Outstanding requests per worker:
16565 16682 16590 16456 16548 16082 16500 16778 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  122471.7,      612359,     551170,      61189,     456572,      94598, 1088.356524, 2619.600000, 2787.200000, 3066.600000, 1193.260903,   0.024000, 3656.754017, 660.316759
Outstanding requests per worker:
21833 21965 21954 21921 22120 21517 21928 22378 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  154152.2,      770762,     693820,      76942,     582961,     110859, 1097.951814, 2403.700000, 2651.700000, 3001.900000, 856.677603,   0.077000, 3652.853012, 673.504925
Outstanding requests per worker:
7649 7467 7551 7821 7603 7118 7560 7885 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  137058.9,      685295,     616574,      68721,     524360,      92214, 263.214219, 724.300000, 834.700000, 986.100000, 285.188371,   0.023000, 1404.535055, 684.317941
Outstanding requests per worker:
3818 3734 3991 3864 4057 3982 3822 3868 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.4  0.0  18032  2836 pts/0    Ss+  10:52   0:00 bash docker-ent
memcache     7  0.4  0.0  96672  6352 pts/0    S+   10:52   0:00 /usr/lib/linux-
memcache     8  136  0.0 291200 151664 pts/0   Sl+  10:52   1:04 memcached -t 2 
memcache    17 18.0  0.0  34424  2872 pts/1    Rs+  10:52   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       16273334339      instructions:u                                              
         694262408      L1-icache-load-misses                                       
        8957241961      icache.hit:u                                                

      46.865512242 seconds time elapsed

