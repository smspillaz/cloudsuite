+ for keys in '$KEYS'
+ for conns in '$CONNS'
+ for threads in '$THREADS'
+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 104000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 104000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 104000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
caching_network
+ docker network create caching_network
1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396
+ echo 'Starting server with perf args -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
Error: No such container: dc-server
+ true
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 104000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 104000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 104000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 104000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 104000 cpus 4
meanInterarrival 38
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 23029504
starting receive base loop
num_worker_connections 128
Creating worker on tid 3215357696
starting receive base loop
num_worker_connections 128
Creating worker on tid 2109568768
starting receive base loop
Created 512 connections total
Creating worker on tid 1003779840
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575369264.367689,       0.0,      245194,     220631,      24563,     143209,      77422,   3.779940,  11.500000,  20.100000,  34.500000,   7.345267,   0.000000,  69.963001, 462.724563
Outstanding requests per worker:
28 51 39 47 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  105253.9,      526270,     473725,      52545,     348010,     125715,   2.222927,   6.600000,   7.700000,   9.900000,   2.771683,   0.032000,  16.853999, 556.561093
Outstanding requests per worker:
63 73 55 60 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  105286.3,      526432,     473424,      53008,     368741,     104683,   2.278498,   6.700000,   7.800000,  10.500000,   2.873061,   0.033000,  19.393999, 605.116221
Outstanding requests per worker:
44 39 45 41 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  105264.7,      526324,     473806,      52518,     379726,      94080,   2.169115,   6.500000,   7.600000,   9.100000,   2.656946,   0.033000,  11.535000, 630.909028
Outstanding requests per worker:
45 51 49 52 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  105263.5,      526318,     473272,      53046,     386974,      86298,   2.494133,   7.500000,   8.700000,  11.500000,   3.179484,   0.032000,  20.954000, 647.720518
Outstanding requests per worker:
63 47 57 54 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  105260.3,      526302,     473267,      53035,     392017,      81250,   2.356618,   7.200000,   8.200000,   9.700000,   2.897552,   0.032000,  12.076000, 659.912092
Outstanding requests per worker:
74 67 68 66 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  105274.7,      526374,     473387,      52987,     397551,      75836,   2.401255,   7.400000,   8.400000,  10.000000,   2.968863,   0.032000,  12.907000, 672.215466
Outstanding requests per worker:
61 54 66 62 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'7\r'
+ echo 'memcached pid is: 7'
memcached pid is: 7
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.4  0.0  18028  2880 pts/0    Ss+  10:07   0:00 bash docker-ent
memcache     6  0.5  0.0  96652  6292 pts/0    S+   10:07   0:00 /usr/lib/linux-
memcache     7  127  0.0 272768 118556 pts/0   Sl+  10:07   0:58 memcached -t 2 
memcache    17 19.0  0.0  34424  2852 pts/1    Rs+  10:08   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       13133552426      instructions:u                                              
         402872408      L1-dcache-load-misses     # [35m  16.59%[m of all L1-dcache hits  
        2428406884      L1-dcache-loads                                             

      45.895571992 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 106000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 106000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 106000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 106000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 106000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 106000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 106000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 106000 cpus 4
meanInterarrival 37
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 3255973632
starting receive base loop
num_worker_connections 128
Creating worker on tid 2152642304
starting receive base loop
num_worker_connections 128
Creating worker on tid 1043838720
starting receive base loop
Created 512 connections total
Creating worker on tid 4234999552
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575369312.367737,       0.0,      250523,     225336,      25187,     146527,      78809,   4.216412,  12.800000,  19.800000,  33.900000,   7.238429,   0.000000,  59.271999, 463.711582
Outstanding requests per worker:
79 82 86 88 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108107.3,      540537,     486607,      53930,     358471,     128136,   3.010211,   9.300000,  10.900000,  14.100000,   3.876763,   0.032000,  22.178000, 558.934763
Outstanding requests per worker:
76 112 101 93 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108132.5,      540663,     486882,      53781,     378955,     107927,   3.087919,   9.500000,  11.300000,  14.100000,   3.965787,   0.032000,  23.344001, 604.332046
Outstanding requests per worker:
77 79 59 74 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108110.3,      540552,     486041,      54511,     390194,      95847,   3.013240,   9.500000,  11.200000,  13.100000,   3.821165,   0.033000,  17.395001, 631.970085
Outstanding requests per worker:
78 95 79 69 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108098.7,      540494,     486334,      54160,     397794,      88540,   3.382530,  10.500000,  12.500000,  15.800000,   4.406441,   0.033000,  27.586000, 649.224157
Outstanding requests per worker:
91 99 97 106 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108121.1,      540606,     486381,      54225,     403877,      82504,   3.272438,  10.200000,  12.300000,  14.600000,   4.182446,   0.032000,  17.198000, 662.324828
Outstanding requests per worker:
102 95 87 83 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108113.7,      540569,     486390,      54179,     408379,      78011,   3.137876,   9.800000,  11.700000,  13.900000,   4.001482,   0.032000,  17.282000, 672.777397
Outstanding requests per worker:
81 93 94 99 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18028  2756 pts/0    Ss+  10:08   0:00 bash docker-ent
memcache     7  0.5  0.0  96652  6404 pts/0    S+   10:08   0:00 /usr/lib/linux-
memcache     8  130  0.0 273792 119908 pts/0   Sl+  10:08   0:58 memcached -t 2 
memcache    17  0.0  0.0  34424  2772 pts/1    Rs+  10:09   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       13425017177      instructions:u                                              
         395597963      L1-dcache-load-misses     # [35m  15.94%[m of all L1-dcache hits  
        2481907778      L1-dcache-loads                                             

      45.777046172 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 108000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 108000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 108000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 108000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 108000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 108000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 108000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 108000 cpus 4
meanInterarrival 37
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 3958089472
starting receive base loop
num_worker_connections 128
Creating worker on tid 2854065920
starting receive base loop
num_worker_connections 128
Creating worker on tid 1749989120
starting receive base loop
Created 512 connections total
Creating worker on tid 643086080
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575369360.367785,       0.0,      247767,     223183,      24584,     144948,      78235,   4.886395,  15.500000,  24.600000,  40.300000,   8.800165,   0.000000,  95.477998, 463.147426
Outstanding requests per worker:
93 77 96 100 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108131.5,      540658,     486626,      54032,     358315,     128311,   3.276149,  10.100000,  12.100000,  15.600000,   4.265346,   0.033000,  24.227999, 558.889019
Outstanding requests per worker:
73 68 84 68 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108106.7,      540534,     486520,      54014,     378953,     107567,   3.351793,  10.400000,  12.500000,  15.500000,   4.348235,   0.033000,  25.625000, 605.256446
Outstanding requests per worker:
81 96 72 79 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108107.9,      540540,     486395,      54145,     390363,      96032,   3.332320,  10.400000,  12.500000,  15.400000,   4.289869,   0.032000,  19.561000, 631.360709
Outstanding requests per worker:
88 87 92 108 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108113.5,      540568,     486497,      54071,     398128,      88369,   3.657959,  11.300000,  13.700000,  17.700000,   4.812966,   0.033000,  30.655000, 648.794757
Outstanding requests per worker:
77 105 98 95 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108106.3,      540532,     486303,      54229,     402944,      83359,   3.652007,  11.200000,  13.900000,  17.000000,   4.719043,   0.032000,  22.747001, 661.297627
Outstanding requests per worker:
115 93 116 99 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108116.9,      540585,     486483,      54102,     408762,      77721,   3.606641,  11.200000,  13.800000,  16.500000,   4.652827,   0.033000,  21.903999, 673.111918
Outstanding requests per worker:
96 111 89 108 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18028  2860 pts/0    Ss+  10:09   0:00 bash docker-ent
memcache     7  0.3  0.0  96652  6240 pts/0    S+   10:09   0:00 /usr/lib/linux-
memcache     8  131  0.0 273792 119684 pts/0   Sl+  10:09   0:58 memcached -t 2 
memcache    17  0.0  0.0  34424  2852 pts/1    Rs+  10:10   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       13506704727      instructions:u                                              
         398327486      L1-dcache-load-misses     # [35m  16.04%[m of all L1-dcache hits  
        2482888191      L1-dcache-loads                                             

      45.799151566 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 110000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 110000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 110000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 110000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 110000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 110000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 110000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 110000 cpus 4
meanInterarrival 36
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 250742528
starting receive base loop
num_worker_connections 128
Creating worker on tid 3443734272
starting receive base loop
num_worker_connections 128
Creating worker on tid 2337945344
starting receive base loop
Created 512 connections total
Creating worker on tid 1229141760
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575369407.367832,       0.0,      254900,     229307,      25593,     149442,      79865,   4.937057,  15.100000,  22.900000,  39.100000,   8.602560,   0.000000, 103.997998, 466.376739
Outstanding requests per worker:
111 102 114 111 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  111131.3,      555657,     500118,      55539,     369409,     130709,   3.843662,  11.800000,  14.800000,  18.000000,   5.024353,   0.033000,  26.835000, 561.409041
Outstanding requests per worker:
103 102 81 98 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  111108.9,      555545,     500115,      55430,     390633,     109482,   3.937083,  12.100000,  15.000000,  18.900000,   5.195882,   0.032000,  32.131001, 608.008932
Outstanding requests per worker:
103 111 102 102 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  111118.1,      555591,     499793,      55798,     401813,      97980,   3.943329,  12.000000,  15.400000,  18.400000,   5.135595,   0.033000,  23.458000, 632.572999
Outstanding requests per worker:
124 92 107 101 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  111104.1,      555521,     499957,      55564,     409813,      90144,   4.235424,  13.000000,  16.300000,  20.800000,   5.653988,   0.033000,  37.264001, 650.432831
Outstanding requests per worker:
112 120 127 125 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  111127.1,      555636,     500240,      55396,     415879,      84361,   4.115894,  12.300000,  16.100000,  19.500000,   5.373827,   0.033000,  23.707001, 664.050574
Outstanding requests per worker:
93 95 125 130 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  111105.9,      555530,     499776,      55754,     420069,      79707,   4.171796,  12.500000,  16.300000,  19.900000,   5.455061,   0.032000,  25.594000, 674.226696
Outstanding requests per worker:
123 123 108 138 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'7\r'
+ echo 'memcached pid is: 7'
memcached pid is: 7
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18028  2880 pts/0    Ss+  10:10   0:00 bash docker-ent
memcache     6  0.4  0.0  96652  6388 pts/0    S+   10:10   0:00 /usr/lib/linux-
memcache     7  128  0.0 275840 121912 pts/0   Sl+  10:10   0:59 memcached -t 2 
memcache    16  0.0  0.0  34424  2768 pts/1    Rs+  10:11   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       13792962656      instructions:u                                              
         410968224      L1-dcache-load-misses     # [35m  16.18%[m of all L1-dcache hits  
        2540724113      L1-dcache-loads                                             

      45.887747776 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 112000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 112000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 112000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 112000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 112000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 112000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 112000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 112000 cpus 4
meanInterarrival 35
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 673249024
starting receive base loop
num_worker_connections 128
Creating worker on tid 3862411008
starting receive base loop
num_worker_connections 128
Creating worker on tid 2756622080
starting receive base loop
Created 512 connections total
Creating worker on tid 1647818496
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575369455.367880,       0.0,      261262,     235094,      26168,     153740,      81354,   6.540032,  21.200000,  30.200000,  47.700000,  11.310129,   0.000000, 145.490006, 467.720954
Outstanding requests per worker:
157 134 129 129 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114285.5,      571428,     514291,      57137,     380031,     134260,   5.059106,  14.800000,  19.700000,  25.500000,   6.721607,   0.033000,  36.706001, 562.011546
Outstanding requests per worker:
141 133 159 166 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114304.7,      571524,     514623,      56901,     402903,     111720,   4.923026,  14.500000,  19.100000,  24.800000,   6.555272,   0.032000,  37.179001, 609.924558
Outstanding requests per worker:
129 119 149 139 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114296.9,      571485,     514141,      57344,     413961,     100180,   5.013392,  14.500000,  19.700000,  25.200000,   6.637463,   0.032000,  32.586001, 635.057792
Outstanding requests per worker:
135 137 157 100 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114279.9,      571400,     514031,      57369,     421799,      92232,   5.567950,  16.300000,  21.600000,  28.700000,   7.533931,   0.032000,  53.427000, 651.373318
Outstanding requests per worker:
133 157 155 142 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114274.3,      571372,     514262,      57110,     428408,      85854,   5.383539,  15.400000,  21.100000,  27.400000,   7.137756,   0.032000,  33.002000, 665.099768
Outstanding requests per worker:
167 176 169 180 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114306.5,      571533,     514294,      57239,     433056,      81238,   5.333962,  15.400000,  20.900000,  27.100000,   7.094830,   0.033000,  34.398999, 675.640077
Outstanding requests per worker:
162 146 153 153 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.4  0.0  18028  2872 pts/0    Ss+  10:11   0:00 bash docker-ent
memcache     7  0.4  0.0  96652  6364 pts/0    S+   10:11   0:00 /usr/lib/linux-
memcache     8  129  0.0 278912 125020 pts/0   Sl+  10:11   0:59 memcached -t 2 
memcache    18 18.0  0.0  34424  2856 pts/1    Rs+  10:11   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       14121594710      instructions:u                                              
         404980309      L1-dcache-load-misses     # [35m  15.58%[m of all L1-dcache hits  
        2599510751      L1-dcache-loads                                             

      45.775133788 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 114000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 114000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 114000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 114000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 114000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 114000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 114000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 114000 cpus 4
meanInterarrival 35
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 3850663680
starting receive base loop
num_worker_connections 128
Creating worker on tid 2746640128
starting receive base loop
num_worker_connections 128
Creating worker on tid 1639806720
starting receive base loop
Created 512 connections total
Creating worker on tid 534017792
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575369503.367928,       0.0,      262835,     236491,      26344,     156339,      80152,   6.323573,  20.800000,  28.000000,  42.600000,  10.377610,   0.000000, 119.974002, 476.141925
Outstanding requests per worker:
165 144 184 133 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114300.9,      571505,     514603,      56902,     383388,     131215,   5.265722,  15.300000,  20.500000,  26.900000,   7.031237,   0.032000,  41.140001, 567.796437
Outstanding requests per worker:
169 152 149 124 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114285.7,      571429,     514225,      57204,     404940,     109285,   5.494277,  15.900000,  21.200000,  28.200000,   7.328198,   0.032000,  57.285000, 614.291985
Outstanding requests per worker:
128 152 159 187 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114299.1,      571496,     514319,      57177,     416737,      97582,   5.271407,  15.300000,  20.600000,  26.900000,   7.006411,   0.032000,  34.501001, 639.571497
Outstanding requests per worker:
148 149 156 149 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114275.1,      571376,     514027,      57349,     424068,      89959,   5.946700,  17.200000,  23.300000,  30.600000,   8.050516,   0.032000,  56.060001, 656.592698
Outstanding requests per worker:
190 162 167 165 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114310.7,      571554,     514317,      57237,     430059,      84258,   5.709565,  16.300000,  22.100000,  29.500000,   7.591251,   0.032000,  36.903001, 669.488321
Outstanding requests per worker:
152 137 152 160 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114291.1,      571456,     514657,      56799,     434531,      80126,   5.686068,  16.300000,  22.100000,  29.500000,   7.572263,   0.032000,  35.333999, 677.934551
Outstanding requests per worker:
167 149 144 136 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'9\r'
+ echo 'memcached pid is: 9'
memcached pid is: 9
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18028  2756 pts/0    Ss+  10:11   0:00 bash docker-ent
memcache     8  0.5  0.0  96652  6336 pts/0    S+   10:11   0:00 /usr/lib/linux-
memcache     9  132  0.0 274816 121132 pts/0   Sl+  10:11   0:59 memcached -t 2 
memcache    18  0.0  0.0  34424  2912 pts/1    Rs+  10:12   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       14273506381      instructions:u                                              
         409939108      L1-dcache-load-misses     # [35m  15.67%[m of all L1-dcache hits  
        2616602400      L1-dcache-loads                                             

      45.884999253 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 116000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 116000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 116000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 116000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 116000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 116000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 116000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 116000 cpus 4
meanInterarrival 34
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 885069568
starting receive base loop
num_worker_connections 128
Creating worker on tid 4068001536
starting receive base loop
num_worker_connections 128
Creating worker on tid 2965960448
starting receive base loop
Created 512 connections total
Creating worker on tid 1857156864
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575369551.367976,       0.0,      270420,     243222,      27198,     158764,      84458,  11.600643,  37.200000,  54.400000, 100.000000,  20.919428,   0.000000, 179.796994, 467.455103
Outstanding requests per worker:
217 188 211 180 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117674.5,      588373,     529669,      58704,     392888,     136781,   7.041156,  20.400000,  26.300000,  37.600000,   9.525477,   0.032000,  83.524004, 564.463614
Outstanding requests per worker:
176 184 162 187 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117626.3,      588132,     529146,      58986,     414738,     114408,   7.197124,  20.700000,  27.600000,  38.000000,   9.823774,   0.045000,  93.087003, 609.895991
Outstanding requests per worker:
192 221 233 195 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117664.1,      588321,     529713,      58608,     427143,     102570,   6.877605,  19.800000,  24.800000,  37.100000,   9.219287,   0.044000,  63.087001, 635.782580
Outstanding requests per worker:
188 219 196 204 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117607.9,      588040,     528824,      59216,     434735,      94089,   8.380418,  24.400000,  30.300000,  46.400000,  11.356336,   0.032000,  99.716000, 653.499051
Outstanding requests per worker:
254 285 287 205 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117683.5,      588418,     529367,      59051,     441567,      87800,   7.727089,  22.300000,  27.200000,  42.300000,  10.380593,   0.033000,  81.109002, 666.601983
Outstanding requests per worker:
235 224 226 207 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117658.5,      588293,     529371,      58922,     445854,      83517,   7.917759,  22.900000,  27.100000,  43.700000,  10.619753,   0.045000,  77.451997, 675.644795
Outstanding requests per worker:
233 218 175 239 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'7\r'
+ echo 'memcached pid is: 7'
memcached pid is: 7
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18028  2852 pts/0    Ss+  10:12   0:00 bash docker-ent
memcache     6  0.4  0.0  96652  6220 pts/0    S+   10:12   0:00 /usr/lib/linux-
memcache     7  133  0.0 279936 127176 pts/0   Sl+  10:12   1:00 memcached -t 2 
memcache    17  0.0  0.0  34424  2820 pts/1    Rs+  10:13   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       14535790656      instructions:u                                              
         409216446      L1-dcache-load-misses     # [35m  15.32%[m of all L1-dcache hits  
        2671142135      L1-dcache-loads                                             

      45.900488072 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 118000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 118000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 118000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 118000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 118000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 118000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 118000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 118000 cpus 4
meanInterarrival 33
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 2788701952
starting receive base loop
num_worker_connections 128
Creating worker on tid 1676666624
starting receive base loop
num_worker_connections 128
Creating worker on tid 574076672
starting receive base loop
Created 512 connections total
Creating worker on tid 3760240384
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575369599.368024,       0.0,      275039,     247570,      27469,     161884,      85686,  31.986194, 110.800000, 129.500000, 168.400000,  47.278837,   0.000000, 248.809993, 468.246145
Outstanding requests per worker:
1133 1302 1332 1265 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  120743.1,      603716,     543262,      60454,     403265,     139997,  51.822299, 135.200000, 161.100000, 199.300000,  60.125357,   0.044000, 292.302012, 565.802182
Outstanding requests per worker:
1743 1885 1926 1877 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121037.5,      605188,     544737,      60451,     427848,     116889,  61.241123, 162.900000, 186.700000, 230.600000,  69.974972,   0.044000, 348.430008, 613.121325
Outstanding requests per worker:
2215 2035 1987 2102 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121092.1,      605461,     544592,      60869,     439834,     104758,  71.516057, 186.300000, 206.200000, 256.200000,  79.892232,   0.045000, 375.748008, 637.488182
Outstanding requests per worker:
2160 2313 2436 2081 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  120376.3,      601882,     541234,      60648,     445409,      95825,  89.115064, 227.000000, 261.500000, 316.600000,  99.342390,   0.044000, 572.583973, 655.181864
Outstanding requests per worker:
3471 3263 3198 3267 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  120835.5,      604178,     543535,      60643,     453634,      89901, 116.792396, 290.000000, 333.500000, 424.100000, 128.654619,   0.045000, 688.971996, 667.377856
Outstanding requests per worker:
3651 3860 3828 3789 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  120978.1,      604891,     544648,      60243,     460324,      84324, 130.337208, 324.600000, 365.000000, 442.200000, 141.933295,   0.045000, 707.792997, 678.771285
Outstanding requests per worker:
4035 3973 4102 4219 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18028  2768 pts/0    Ss+  10:13   0:00 bash docker-ent
memcache     7  0.5  0.0  96652  6228 pts/0    S+   10:13   0:00 /usr/lib/linux-
memcache     8  135  0.0 281984 133860 pts/0   Sl+  10:13   1:00 memcached -t 2 
memcache    18  0.0  0.0  34424  2860 pts/1    Rs+  10:14   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       15075915583      instructions:u                                              
         420088739      L1-dcache-load-misses     # [35m  15.18%[m of all L1-dcache hits  
        2767850268      L1-dcache-loads                                             

      45.734669789 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 120000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 120000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 120000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 120000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 120000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 120000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 120000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 120000 cpus 4
meanInterarrival 33
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 1196443392
starting receive base loop
num_worker_connections 128
Creating worker on tid 88291072
starting receive base loop
num_worker_connections 128
Creating worker on tid 3271223040
starting receive base loop
Created 512 connections total
Creating worker on tid 2168665856
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575369646.368071,       0.0,      276356,     248709,      27647,     163620,      85089,  25.802732,  91.200000, 110.500000, 143.900000,  38.999702,   0.000000, 206.414998, 472.611192
Outstanding requests per worker:
622 697 767 749 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121611.7,      608059,     547252,      60807,     407518,     139734,   9.406878,  26.000000,  35.500000,  60.100000,  13.794011,   0.044000, 158.586994, 567.141134
Outstanding requests per worker:
231 216 208 232 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121216.7,      606084,     545587,      60497,     428661,     116926,   8.610143,  25.100000,  29.700000,  48.000000,  11.577666,   0.041000,  94.733998, 613.476588
Outstanding requests per worker:
233 205 237 218 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121148.1,      605741,     545006,      60735,     440983,     104023,   9.073071,  26.300000,  32.600000,  50.200000,  12.345805,   0.044000, 117.619000, 639.479046
Outstanding requests per worker:
297 333 339 290 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121212.3,      606062,     545444,      60618,     449612,      95832,   9.162003,  26.800000,  30.900000,  51.900000,  12.326425,   0.044000,  99.041998, 655.097011
Outstanding requests per worker:
326 316 307 337 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121246.3,      606232,     545659,      60573,     456136,      89523,   9.488431,  27.700000,  31.700000,  53.200000,  12.701726,   0.044000,  97.616002, 668.845319
Outstanding requests per worker:
320 265 308 270 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121197.9,      605990,     545565,      60425,     461348,      84217,   9.466786,  27.700000,  31.600000,  53.400000,  12.702661,   0.044000,  93.645997, 679.717176
Outstanding requests per worker:
290 317 307 346 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'7\r'
+ echo 'memcached pid is: 7'
memcached pid is: 7
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18028  2764 pts/0    Ss+  10:14   0:00 bash docker-ent
memcache     6  0.5  0.0  96652  6308 pts/0    S+   10:14   0:00 /usr/lib/linux-
memcache     7  131  0.0 283008 130988 pts/0   Sl+  10:14   1:00 memcached -t 2 
memcache    16  0.0  0.0  34424  2856 pts/1    Rs+  10:15   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       14938445291      instructions:u                                              
         419100812      L1-dcache-load-misses     # [35m  15.28%[m of all L1-dcache hits  
        2743433278      L1-dcache-loads                                             

      45.783449017 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 122000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 122000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 122000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 122000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 122000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 122000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 122000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 122000 cpus 4
meanInterarrival 32
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 1355785984
starting receive base loop
num_worker_connections 128
Creating worker on tid 254555904
starting receive base loop
num_worker_connections 128
Creating worker on tid 3443734272
starting receive base loop
Created 512 connections total
Creating worker on tid 2337945344
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575369694.368119,       0.0,      278979,     250959,      28020,     164503,      86456,  40.673744, 139.000000, 165.400000, 205.100000,  60.421636,   0.000000, 310.139000, 470.783148
Outstanding requests per worker:
2225 2187 2320 2286 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  122823.7,      614119,     552607,      61512,     410880,     141727, 116.509742, 307.600000, 358.000000, 448.000000, 134.000668,   0.044000, 643.386006, 566.981289
Outstanding requests per worker:
5048 4828 4977 5096 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  122912.7,      614564,     553390,      61174,     434645,     118745, 193.212167, 482.000000, 555.000000, 689.700000, 214.064524,   0.044000, 981.005013, 612.891960
Outstanding requests per worker:
7242 7877 7439 7856 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  122174.3,      610872,     549584,      61288,     444130,     105454, 289.993963, 741.800000, 827.200000, 971.900000, 320.586107,   0.045000, 1344.656944, 638.360638
Outstanding requests per worker:
10633 11517 11284 11153 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  120879.5,      604398,     543949,      60449,     448573,      95376, 420.314114, 1056.600000, 1157.400000, 1357.100000, 462.866174,   0.045000, 1885.231018, 656.212855
Outstanding requests per worker:
15394 17278 16683 15864 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  120861.5,      604308,     543773,      60535,     454766,      89007, 579.712802, 1424.800000, 1545.100000, 1767.100000, 629.337368,   0.044000, 2217.741966, 668.574806
Outstanding requests per worker:
20563 22635 21322 21438 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  120515.5,      602578,     541978,      60600,     458417,      83561, 747.037870, 1799.600000, 1937.000000, 2202.400000, 806.311146,   0.045000, 2685.206890, 679.532448
Outstanding requests per worker:
26172 28164 26704 27376 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18028  2788 pts/0    Ss+  10:15   0:00 bash docker-ent
memcache     7  0.5  0.0  96652  6348 pts/0    S+   10:15   0:00 /usr/lib/linux-
memcache     8  133  0.0 283008 135464 pts/0   Sl+  10:15   1:01 memcached -t 2 
memcache    18 17.0  0.0  34424  2796 pts/1    Rs+  10:15   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       15059227551      instructions:u                                              
         422802593      L1-dcache-load-misses     # [35m  15.30%[m of all L1-dcache hits  
        2764254519      L1-dcache-loads                                             

      45.830999281 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 124000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 124000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 124000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 124000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 124000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 124000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 124000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 124000 cpus 4
meanInterarrival 32
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 1360901888
starting receive base loop
num_worker_connections 128
Creating worker on tid 256878336
starting receive base loop
num_worker_connections 128
Creating worker on tid 3443734272
starting receive base loop
Created 512 connections total
Creating worker on tid 2337945344
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575369742.368167,       0.0,      279674,     251510,      28164,     164835,      86675,  33.479164,  86.900000, 115.900000, 621.000000, 105.325870,   0.000000, 1377.189040, 470.329546
Outstanding requests per worker:
1429 1292 1186 3679 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  123466.5,      617333,     555468,      61865,     412582,     142886,  93.004492, 234.300000, 281.600000, 602.600000, 130.226956,   0.045000, 1294.656992, 566.017103
Outstanding requests per worker:
3682 3637 3667 4317 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  123686.3,      618432,     556570,      61862,     436969,     119601, 146.428897, 363.600000, 410.300000, 523.700000, 164.831416,   0.044000, 1096.019983, 613.093349
Outstanding requests per worker:
5488 5418 5335 5665 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  123607.7,      618039,     556018,      62021,     449562,     106456, 199.548862, 489.500000, 562.500000, 731.800000, 220.657885,   0.045000, 1132.923007, 638.641522
Outstanding requests per worker:
6970 7691 6932 7320 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  122541.7,      612709,     551462,      61247,     454927,      96535, 271.546223, 694.000000, 804.300000, 1023.600000, 305.758900,   0.044000, 1377.586961, 656.936427
Outstanding requests per worker:
10485 10847 9770 10143 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  122200.3,      611002,     550081,      60921,     460286,      89795, 374.570870, 961.400000, 1094.300000, 1328.000000, 418.346867,   0.044000, 1636.394978, 669.512777
Outstanding requests per worker:
14001 14470 13287 13531 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121888.7,      609444,     548368,      61076,     464210,      84158, 488.984462, 1248.900000, 1416.400000, 1712.600000, 545.859241,   0.045000, 2033.401012, 679.913461
Outstanding requests per worker:
18208 17871 16984 17812 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'7\r'
+ echo 'memcached pid is: 7'
memcached pid is: 7
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18028  2764 pts/0    Ss+  10:15   0:00 bash docker-ent
memcache     6  0.3  0.0  96652  6384 pts/0    S+   10:15   0:00 /usr/lib/linux-
memcache     7  136  0.0 283008 136288 pts/0   Sl+  10:15   1:01 memcached -t 2 
memcache    17  0.0  0.0  34424  2852 pts/1    Rs+  10:16   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       15198006768      instructions:u                                              
         421037261      L1-dcache-load-misses     # [35m  15.08%[m of all L1-dcache hits  
        2792551777      L1-dcache-loads                                             

      45.937183443 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 126000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 126000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 126000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 126000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 126000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 126000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 126000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 126000 cpus 4
meanInterarrival 31
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 1892730624
starting receive base loop
num_worker_connections 128
Creating worker on tid 788707072
starting receive base loop
num_worker_connections 128
Creating worker on tid 3980605184
starting receive base loop
Created 512 connections total
Creating worker on tid 2874816256
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575369791.368216,       0.0,      353468,     317966,      35502,     212162,     105804,  30.809579, 125.800000, 153.300000, 195.800000,  54.214802,   0.000000, 332.957000, 483.237566
Outstanding requests per worker:
2500 2328 2410 2366 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  125577.5,      627888,     564947,      62941,     424712,     140235, 139.423303, 373.500000, 433.400000, 546.000000, 162.668566,   0.045000, 854.915977, 575.376356
Outstanding requests per worker:
6713 6675 6832 6714 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  124832.3,      624162,     562050,      62112,     443562,     118488, 276.118242, 710.000000, 800.800000, 959.800000, 309.375648,   0.044000, 1419.006944, 617.133719
Outstanding requests per worker:
11996 12088 11945 11954 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  124165.5,      620828,     558585,      62243,     453580,     105005, 446.103336, 1109.300000, 1227.100000, 1457.600000, 491.928944,   0.044000, 1950.500011, 642.318596
Outstanding requests per worker:
18084 18023 18139 18107 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  123426.9,      617135,     555287,      61848,     459591,      95696, 640.402709, 1562.200000, 1701.700000, 1951.000000, 698.893412,   0.045000, 2508.686066, 658.937177
Outstanding requests per worker:
24998 25244 25053 25118 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  123138.1,      615691,     553715,      61976,     464554,      89161, 848.935569, 2029.900000, 2185.900000, 2478.000000, 917.663282,   0.045000, 3011.794090, 671.788633
Outstanding requests per worker:
32620 32501 32425 32387 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  122849.9,      614250,     552532,      61718,     468461,      84071, 1068.548204, 2536.100000, 2694.300000, 2980.600000, 1151.020647,   0.044000, 3474.402905, 681.506152
Outstanding requests per worker:
40304 40092 40408 40070 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.4  0.0  18028  2856 pts/0    Ss+  10:16   0:00 bash docker-ent
memcache     7  0.4  0.0  96652  6384 pts/0    S+   10:16   0:00 /usr/lib/linux-
memcache     8  137  0.0 286080 138496 pts/0   Sl+  10:16   1:03 memcached -t 2 
memcache    18  0.0  0.0  34424  2812 pts/1    Rs+  10:17   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       15618744096      instructions:u                                              
         438436006      L1-dcache-load-misses     # [35m  15.26%[m of all L1-dcache hits  
        2873819582      L1-dcache-loads                                             

      46.977992774 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 128000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 128000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 128000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 128000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 128000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 128000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 128000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 128000 cpus 4
meanInterarrival 31
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 3905918720
starting receive base loop
num_worker_connections 128
Creating worker on tid 2804692736
starting receive base loop
num_worker_connections 128
Creating worker on tid 1692657408
starting receive base loop
Created 512 connections total
Creating worker on tid 590100224
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575369839.368264,       0.0,      284094,     255793,      28301,     167878,      87915,  49.547937, 168.700000, 195.400000, 248.500000,  72.975096,   0.000000, 400.691986, 471.451775
Outstanding requests per worker:
2824 3110 3026 3036 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  125464.9,      627325,     564755,      62570,     419303,     145452, 156.277815, 410.600000, 476.000000, 602.800000, 180.093685,   0.044000, 903.845012, 566.374461
Outstanding requests per worker:
7501 7516 7423 7447 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  124577.3,      622887,     560599,      62288,     440862,     119737, 299.785298, 773.300000, 864.200000, 1033.500000, 335.901203,   0.045000, 1489.812016, 613.903760
Outstanding requests per worker:
12993 13213 13121 12870 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  123792.9,      618965,     556611,      62354,     450719,     105892, 481.802798, 1201.900000, 1325.200000, 1521.700000, 529.660391,   0.045000, 1846.464038, 639.162722
Outstanding requests per worker:
19096 19343 20172 19838 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  122965.9,      614830,     553080,      61750,     456805,      96275, 686.739445, 1677.200000, 1816.000000, 2042.200000, 747.567670,   0.044000, 2441.907883, 656.926079
Outstanding requests per worker:
26396 27338 27873 27211 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  123015.3,      615077,     553413,      61664,     463995,      89418, 911.671347, 2173.200000, 2344.100000, 2570.900000, 982.859221,   0.045000, 3127.548933, 670.712636
Outstanding requests per worker:
33869 34442 35570 35074 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  122839.1,      614196,     552415,      61781,     467275,      85140, 1132.943411, 2666.200000, 2820.900000, 3142.400000, 1216.315675,   0.045000, 3699.666023, 679.854732
Outstanding requests per worker:
41339 42584 43155 42882 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'7\r'
+ echo 'memcached pid is: 7'
memcached pid is: 7
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18028  2852 pts/0    Ss+  10:17   0:00 bash docker-ent
memcache     6  0.5  0.0  96652  6436 pts/0    S+   10:17   0:00 /usr/lib/linux-
memcache     7  137  0.0 283008 135632 pts/0   Sl+  10:17   1:01 memcached -t 2 
memcache    17  0.0  0.0  34424  2852 pts/1    Rs+  10:18   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       15269951974      instructions:u                                              
         426013317      L1-dcache-load-misses     # [35m  15.16%[m of all L1-dcache hits  
        2809314733      L1-dcache-loads                                             

      45.876669339 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 130000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 130000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 130000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 130000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 130000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 130000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 130000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 130000 cpus 4
meanInterarrival 30
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 333022976
starting receive base loop
num_worker_connections 128
Creating worker on tid 3526866688
starting receive base loop
num_worker_connections 128
Creating worker on tid 2421077760
starting receive base loop
Created 512 connections total
Creating worker on tid 1312274176
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575369887.368312,       0.0,      288076,     259356,      28720,     170548,      88808,  69.225025, 232.100000, 275.400000, 339.900000, 100.957586,   0.000000, 478.307992, 472.517247
Outstanding requests per worker:
4622 4640 4597 4567 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  126548.7,      632744,     569720,      63024,     424244,     145476, 246.435012, 674.000000, 772.700000, 929.800000, 289.716151,   0.045000, 1226.685047, 568.203855
Outstanding requests per worker:
13240 12697 13080 13387 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  125413.5,      627068,     564537,      62531,     444367,     120170, 502.396105, 1279.600000, 1394.600000, 1591.300000, 561.571991,   0.045000, 2034.068108, 614.930481
Outstanding requests per worker:
23246 22677 22966 23148 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  125153.7,      625769,     563139,      62630,     456571,     106568, 784.635206, 1921.100000, 2054.500000, 2265.400000, 862.376938,   0.044000, 2767.929077, 641.403476
Outstanding requests per worker:
33775 33104 32762 33352 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  124422.3,      622112,     559896,      62216,     463005,      96891, 1080.400772, 2601.000000, 2739.100000, 2955.600000, 1184.911030,   0.045000, 3330.877066, 658.657599
Outstanding requests per worker:
44929 44337 44016 44303 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  124354.5,      621773,     559793,      61980,     469289,      90504, 1391.673467, 3285.800000, 3443.600000, 3696.600000, 1516.650118,   0.045000, 4076.856136, 670.331664
Outstanding requests per worker:
56095 55681 55281 55472 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  123915.9,      619580,     557627,      61953,     471944,      85683, 1707.237607, 3992.700000, 4159.800000, 4447.400000, 1857.128947,   0.046000, 5001.346111, 680.457035
Outstanding requests per worker:
67846 67527 67178 67100 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.4  0.0  18028  2848 pts/0    Ss+  10:18   0:00 bash docker-ent
memcache     7  0.5  0.0  96652  6368 pts/0    S+   10:18   0:00 /usr/lib/linux-
memcache     8  138  0.0 284032 136664 pts/0   Sl+  10:18   1:02 memcached -t 2 
memcache    18  0.0  0.0  34424  2820 pts/1    Rs+  10:19   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       15465841844      instructions:u                                              
         429681954      L1-dcache-load-misses     # [35m  15.13%[m of all L1-dcache hits  
        2839657530      L1-dcache-loads                                             

      46.024993400 seconds time elapsed

+ for threads in '$THREADS'
+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 104000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 104000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 104000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 104000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 104000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 104000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 104000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 104000 cpus 8
meanInterarrival 76
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 2059073280
starting receive base loop
num_worker_connections 64
Creating worker on tid 1459791616
starting receive base loop
num_worker_connections 64
Creating worker on tid 869480192
starting receive base loop
num_worker_connections 64
Creating worker on tid 273512192
starting receive base loop
num_worker_connections 64
Creating worker on tid 3972511488
starting receive base loop
num_worker_connections 64
Creating worker on tid 3376543488
starting receive base loop
num_worker_connections 64
Creating worker on tid 2783590144
starting receive base loop
Created 512 connections total
Creating worker on tid 2187622144
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575369936.368361,       0.0,      310182,     279089,      31093,     184620,      94469,   2.709125,  10.100000,  13.700000,  19.500000,   4.858872,   0.000000,  73.974997, 476.559008
Outstanding requests per worker:
47 45 49 48 50 51 60 45 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  105281.5,      526408,     473841,      52567,     352081,     121760,   3.514411,  11.100000,  13.300000,  17.300000,   4.711928,   0.023000,  28.834000, 565.867489
Outstanding requests per worker:
49 48 39 32 50 39 49 42 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  105274.1,      526371,     473875,      52496,     369896,     103979,   3.697380,  11.700000,  14.300000,  17.600000,   4.948703,   0.024000,  29.967999, 607.703992
Outstanding requests per worker:
46 43 49 44 43 42 25 38 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  105260.5,      526303,     473771,      52532,     380895,      92876,   3.717722,  11.600000,  14.600000,  17.500000,   4.921928,   0.023000,  21.834999, 633.038213
Outstanding requests per worker:
55 42 46 42 53 38 46 46 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  105257.3,      526287,     473548,      52739,     387166,      86382,   3.835609,  11.900000,  15.200000,  18.200000,   5.108064,   0.023000,  23.964999, 648.650753
Outstanding requests per worker:
48 44 53 60 55 54 63 50 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  105269.3,      526347,     473800,      52547,     393724,      80076,   4.387682,  13.500000,  17.300000,  22.600000,   6.012043,   0.023000,  38.196001, 662.599126
Outstanding requests per worker:
64 61 49 58 54 55 49 49 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  105258.7,      526294,     473099,      53195,     397442,      75657,   4.167198,  12.700000,  16.700000,  20.200000,   5.576239,   0.024000,  27.837001, 673.266600
Outstanding requests per worker:
75 66 46 60 68 55 69 51 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.4  0.0  18028  2880 pts/0    Ss+  10:19   0:00 bash docker-ent
memcache     7  0.3  0.0  96652  6400 pts/0    S+   10:19   0:00 /usr/lib/linux-
memcache     8  129  0.0 274816 121712 pts/0   Sl+  10:19   0:59 memcached -t 2 
memcache    17  0.0  0.0  34424  2864 pts/1    Rs+  10:19   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       13278567530      instructions:u                                              
         403999653      L1-dcache-load-misses     # [35m  16.57%[m of all L1-dcache hits  
        2438686540      L1-dcache-loads                                             

      47.010622113 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 106000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 106000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 106000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 106000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 106000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 106000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 106000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 106000 cpus 8
meanInterarrival 75
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 1790568192
starting receive base loop
num_worker_connections 64
Creating worker on tid 1191286528
starting receive base loop
num_worker_connections 64
Creating worker on tid 601044736
starting receive base loop
num_worker_connections 64
Creating worker on tid 5076736
starting receive base loop
num_worker_connections 64
Creating worker on tid 3704076032
starting receive base loop
num_worker_connections 64
Creating worker on tid 3108108032
starting receive base loop
num_worker_connections 64
Creating worker on tid 2515154688
starting receive base loop
Created 512 connections total
Creating worker on tid 1920136960
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575369985.368410,       0.0,      316221,     284505,      31716,     188504,      96001,   3.448239,  12.800000,  17.400000,  27.300000,   6.812546,   0.000000, 206.667006, 477.785051
Outstanding requests per worker:
67 54 58 47 43 74 74 54 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  106688.7,      533444,     480613,      52831,     356854,     123759,   3.807925,  12.100000,  15.200000,  20.600000,   5.338036,   0.022000,  32.669999, 565.997628
Outstanding requests per worker:
58 50 54 49 39 53 64 44 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  106677.5,      533388,     480054,      53334,     374588,     105466,   3.768322,  11.800000,  15.200000,  18.400000,   5.098297,   0.023000,  30.375000, 607.366334
Outstanding requests per worker:
50 53 55 40 47 60 58 41 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  106570.3,      532852,     479324,      53528,     385110,      94214,   9.006252,  17.700000,  20.400000,  26.200000,   6.052264,   0.053000,  40.318999, 632.455283
Outstanding requests per worker:
113 95 109 102 134 126 114 122 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  106649.7,      533249,     479763,      53486,     392796,      86967,   9.050287,  18.000000,  20.800000,  24.400000,   5.898816,   0.058000,  28.982000, 649.811230
Outstanding requests per worker:
138 142 146 108 122 114 132 137 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  106683.5,      533418,     480295,      53123,     399063,      81232,   9.248434,  18.600000,  21.300000,  24.500000,   6.029085,   0.058000,  30.916000, 662.529606
Outstanding requests per worker:
140 127 123 124 119 131 124 133 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  106681.3,      533407,     479681,      53726,     402970,      76711,   9.493296,  19.000000,  21.900000,  25.400000,   6.196143,   0.059000,  29.959001, 673.405799
Outstanding requests per worker:
124 122 108 118 150 119 119 128 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18028  2756 pts/0    Ss+  10:19   0:00 bash docker-ent
memcache     7  0.4  0.0  96652  6404 pts/0    S+   10:19   0:00 /usr/lib/linux-
memcache     8  138  0.0 272768 119976 pts/0   Sl+  10:19   1:03 memcached -t 2 
memcache    18  0.0  0.0  34424  2912 pts/1    Rs+  10:20   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       13113228298      instructions:u                                              
         398964155      L1-dcache-load-misses     # [35m  17.14%[m of all L1-dcache hits  
        2327585756      L1-dcache-loads                                             

      46.843091269 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 108000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 108000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 108000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 108000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 108000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 108000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 108000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 108000 cpus 8
meanInterarrival 74
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 1303209728
starting receive base loop
num_worker_connections 64
Creating worker on tid 703928064
starting receive base loop
num_worker_connections 64
Creating worker on tid 115259136
starting receive base loop
num_worker_connections 64
Creating worker on tid 3814258432
starting receive base loop
num_worker_connections 64
Creating worker on tid 3218290432
starting receive base loop
num_worker_connections 64
Creating worker on tid 2619008768
starting receive base loop
num_worker_connections 64
Creating worker on tid 2026354432
starting receive base loop
Created 512 connections total
Creating worker on tid 1430386432
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575370033.368458,       0.0,      318580,     287043,      31537,     189544,      97499,   3.275281,  12.200000,  17.000000,  26.400000,   6.187830,   0.000000, 111.552000, 475.411576
Outstanding requests per worker:
55 64 64 76 64 60 62 70 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108131.3,      540657,     486656,      54001,     361325,     125331,   4.440148,  13.500000,  17.600000,  22.500000,   6.010460,   0.024000,  33.546001, 566.126654
Outstanding requests per worker:
51 52 51 61 72 57 51 52 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108012.7,      540064,     486298,      53766,     380371,     105927,   8.944218,  17.800000,  20.600000,  25.400000,   6.048451,   0.026000,  39.951999, 609.396033
Outstanding requests per worker:
116 115 130 85 120 147 131 129 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108122.1,      540611,     486744,      53867,     391271,      95473,   9.017721,  18.300000,  20.600000,  23.600000,   5.851920,   0.060000,  29.030001, 632.972630
Outstanding requests per worker:
116 128 100 116 110 117 137 116 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108176.3,      540882,     486566,      54316,     398814,      87752,   7.119363,  17.400000,  20.900000,  25.200000,   6.886476,   0.024000,  45.724999, 650.320937
Outstanding requests per worker:
75 77 76 76 67 82 95 81 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108130.1,      540651,     486531,      54120,     404233,      82298,   4.761259,  14.100000,  19.000000,  24.200000,   6.439714,   0.024000,  31.029001, 663.059443
Outstanding requests per worker:
58 67 80 63 78 69 77 62 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108113.9,      540570,     486299,      54271,     408526,      77773,   4.565352,  13.700000,  18.600000,  23.700000,   6.240616,   0.023000,  29.028000, 672.956806
Outstanding requests per worker:
63 68 49 60 76 66 92 78 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'7\r'
+ echo 'memcached pid is: 7'
memcached pid is: 7
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18028  2836 pts/0    Ss+  10:20   0:00 bash docker-ent
memcache     6  0.4  0.0  96652  6368 pts/0    S+   10:20   0:00 /usr/lib/linux-
memcache     7  133  0.0 275840 123140 pts/0   Sl+  10:20   1:02 memcached -t 2 
memcache    16  0.0  0.0  34424  2792 pts/1    Rs+  10:21   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       13399081989      instructions:u                                              
         404227943      L1-dcache-load-misses     # [35m  16.74%[m of all L1-dcache hits  
        2414915045      L1-dcache-loads                                             

      46.817633953 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 110000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 110000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 110000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 110000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 110000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 110000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 110000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 110000 cpus 8
meanInterarrival 72
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 2087339776
starting receive base loop
num_worker_connections 64
Creating worker on tid 1497495296
starting receive base loop
num_worker_connections 64
Creating worker on tid 901527296
starting receive base loop
num_worker_connections 64
Creating worker on tid 308573952
starting receive base loop
num_worker_connections 64
Creating worker on tid 4007573248
starting receive base loop
num_worker_connections 64
Creating worker on tid 3411605248
starting receive base loop
num_worker_connections 64
Creating worker on tid 2815637248
starting receive base loop
Created 512 connections total
Creating worker on tid 2219669248
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575370082.368507,       0.0,      328117,     295062,      33055,     196047,      99015,   6.094875,  18.500000,  23.900000,  35.900000,   9.011720,   0.000000, 172.202006, 479.274417
Outstanding requests per worker:
90 93 78 88 97 96 83 80 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  111143.7,      555719,     500149,      55570,     373196,     126953,   5.674003,  16.600000,  22.300000,  30.000000,   7.736865,   0.023000,  41.841999, 569.074590
Outstanding requests per worker:
67 64 73 68 80 78 73 85 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  111104.9,      555525,     500410,      55115,     391967,     108443,   6.008166,  17.500000,  23.700000,  31.400000,   8.231742,   0.023000,  60.311999, 610.657952
Outstanding requests per worker:
65 67 115 85 87 67 101 75 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  111040.9,      555205,     499797,      55408,     402547,      97250,   6.101800,  17.700000,  24.200000,  32.200000,   8.375616,   0.023000,  69.468997, 635.057507
Outstanding requests per worker:
149 112 114 138 137 115 155 124 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  111188.3,      555942,     500169,      55773,     410743,      89426,   6.369061,  18.500000,  25.100000,  33.500000,   8.782617,   0.022000,  82.611002, 652.617279
Outstanding requests per worker:
79 89 99 89 78 85 76 93 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  111114.3,      555572,     499940,      55632,     416080,      83860,   6.261871,  18.100000,  24.100000,  33.500000,   8.513804,   0.023000,  41.637000, 664.786476
Outstanding requests per worker:
82 95 106 99 68 82 78 103 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  111110.1,      555551,     499743,      55808,     421027,      78716,   6.179286,  18.000000,  23.900000,  33.000000,   8.435906,   0.023000,  42.160999, 675.150663
Outstanding requests per worker:
108 94 86 95 85 96 77 106 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.4  0.0  18028  2856 pts/0    Ss+  10:21   0:00 bash docker-ent
memcache     7  0.4  0.0  96652  6388 pts/0    S+   10:21   0:00 /usr/lib/linux-
memcache     8  129  0.0 277888 124824 pts/0   Sl+  10:21   1:00 memcached -t 2 
memcache    17 18.0  0.0  34424  2908 pts/1    Rs+  10:22   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       13995662372      instructions:u                                              
         407841056      L1-dcache-load-misses     # [35m  15.91%[m of all L1-dcache hits  
        2564049934      L1-dcache-loads                                             

      46.867332763 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 112000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 112000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 112000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 112000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 112000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 112000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 112000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 112000 cpus 8
meanInterarrival 71
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 831010560
starting receive base loop
num_worker_connections 64
Creating worker on tid 241465088
starting receive base loop
num_worker_connections 64
Creating worker on tid 3940464384
starting receive base loop
num_worker_connections 64
Creating worker on tid 3344496384
starting receive base loop
num_worker_connections 64
Creating worker on tid 2748528384
starting receive base loop
num_worker_connections 64
Creating worker on tid 2152560384
starting receive base loop
num_worker_connections 64
Creating worker on tid 1556592384
starting receive base loop
Created 512 connections total
Creating worker on tid 960624384
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575370131.368556,       0.0,      332003,     299067,      32936,     198352,     100715,   4.567416,  17.100000,  23.300000,  35.700000,   8.672898,   0.000000, 171.271995, 478.714358
Outstanding requests per worker:
109 105 175 118 126 135 121 107 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  112737.9,      563690,     507496,      56194,     379418,     128078,   6.453104,  18.800000,  24.600000,  34.700000,   8.816222,   0.023000,  65.918997, 571.447753
Outstanding requests per worker:
92 61 109 83 100 98 102 98 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  112680.5,      563403,     507110,      56293,     398734,     108376,   6.810233,  19.800000,  26.500000,  36.300000,   9.417832,   0.023000,  93.056001, 613.797330
Outstanding requests per worker:
107 89 102 87 99 86 99 106 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  112689.1,      563446,     507357,      56089,     409662,      97695,   6.770712,  19.800000,  25.300000,  36.900000,   9.268578,   0.023000,  48.942000, 637.530630
Outstanding requests per worker:
70 92 95 106 86 109 99 86 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  112677.1,      563386,     506697,      56689,     416721,      89976,   7.002470,  20.400000,  25.900000,  38.200000,   9.570819,   0.023000,  62.224001, 653.171801
Outstanding requests per worker:
111 97 95 92 100 92 86 103 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  112667.9,      563340,     506971,      56369,     423139,      83832,   8.137773,  23.900000,  30.600000,  45.100000,  11.243765,   0.023000, 101.479001, 666.520223
Outstanding requests per worker:
105 98 121 98 122 118 108 91 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  112701.5,      563508,     507134,      56374,     427660,      79474,   6.206327,  18.700000,  23.600000,  35.700000,   8.730389,   0.023000,  62.509999, 676.233025
Outstanding requests per worker:
97 109 82 98 115 90 102 72 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18028  2880 pts/0    Ss+  10:22   0:00 bash docker-ent
memcache     7  0.5  0.0  96652  6380 pts/0    S+   10:22   0:00 /usr/lib/linux-
memcache     8  132  0.0 277888 125316 pts/0   Sl+  10:22   1:00 memcached -t 2 
memcache    18  0.0  0.0  34424  2912 pts/1    Rs+  10:23   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       14193947634      instructions:u                                              
         412372757      L1-dcache-load-misses     # [35m  15.83%[m of all L1-dcache hits  
        2604762955      L1-dcache-loads                                             

      46.822693966 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 114000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 114000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 114000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 114000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 114000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 114000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 114000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 114000 cpus 8
meanInterarrival 70
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 330618624
starting receive base loop
num_worker_connections 64
Creating worker on tid 4026304256
starting receive base loop
num_worker_connections 64
Creating worker on tid 3435640576
starting receive base loop
num_worker_connections 64
Creating worker on tid 2839672576
starting receive base loop
num_worker_connections 64
Creating worker on tid 2246719232
starting receive base loop
num_worker_connections 64
Creating worker on tid 1650751232
starting receive base loop
num_worker_connections 64
Creating worker on tid 1054783232
starting receive base loop
Created 512 connections total
Creating worker on tid 458815232
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575370180.368605,       0.0,      339740,     305794,      33946,     204210,     101584,   4.575597,  17.100000,  23.200000,  36.400000,   9.038600,   0.000000, 235.275000, 483.015602
Outstanding requests per worker:
91 72 85 79 93 66 102 104 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114224.9,      571125,     514209,      56916,     384575,     129634,   6.360482,  18.800000,  24.300000,  35.200000,   8.811545,   0.023000,  69.686003, 571.815803
Outstanding requests per worker:
166 123 132 109 123 139 135 118 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114352.5,      571763,     514759,      57004,     404511,     110248,   6.942240,  20.300000,  26.800000,  38.100000,   9.619015,   0.023000,  89.353003, 613.161147
Outstanding requests per worker:
90 89 88 104 105 90 92 101 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114239.9,      571200,     514126,      57074,     415199,      98927,   7.460599,  21.700000,  28.900000,  40.500000,  10.363416,   0.023000,  98.362997, 637.497880
Outstanding requests per worker:
125 126 148 116 124 124 139 121 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114318.1,      571591,     514483,      57108,     423152,      91331,   7.755109,  22.700000,  27.600000,  43.500000,  10.591184,   0.023000,  79.565004, 653.706976
Outstanding requests per worker:
102 94 105 115 121 107 135 112 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114301.5,      571508,     514606,      56902,     429432,      85174,   8.059265,  23.700000,  28.400000,  45.300000,  11.015849,   0.023000,  82.125001, 667.149740
Outstanding requests per worker:
117 94 100 113 107 107 112 105 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114278.1,      571391,     514372,      57019,     433939,      80433,   7.648165,  22.600000,  27.700000,  42.900000,  10.517986,   0.023000,  78.948997, 677.790432
Outstanding requests per worker:
121 111 105 117 116 132 87 129 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18028  2768 pts/0    Ss+  10:23   0:00 bash docker-ent
memcache     7  0.5  0.0  96652  6288 pts/0    S+   10:23   0:00 /usr/lib/linux-
memcache     8  133  0.0 279936 126928 pts/0   Sl+  10:23   1:01 memcached -t 2 
memcache    17  0.0  0.0  34424  2876 pts/1    Rs+  10:23   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       14419547089      instructions:u                                              
         413252006      L1-dcache-load-misses     # [35m  15.63%[m of all L1-dcache hits  
        2644458218      L1-dcache-loads                                             

      46.856539177 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 116000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 116000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 116000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 116000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 116000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 116000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 116000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 116000 cpus 8
meanInterarrival 68
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 3089102592
starting receive base loop
num_worker_connections 64
Creating worker on tid 2496116480
starting receive base loop
num_worker_connections 64
Creating worker on tid 1900148480
starting receive base loop
num_worker_connections 64
Creating worker on tid 1307195136
starting receive base loop
num_worker_connections 64
Creating worker on tid 711227136
starting receive base loop
num_worker_connections 64
Creating worker on tid 115259136
starting receive base loop
num_worker_connections 64
Creating worker on tid 3814258432
starting receive base loop
Created 512 connections total
Creating worker on tid 3218290432
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575370229.368654,       0.0,      349063,     314109,      34954,     209406,     104703,   6.474001,  24.400000,  31.300000,  52.700000,  12.966479,   0.000000, 323.224008, 482.119557
Outstanding requests per worker:
146 178 131 134 123 137 135 151 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117656.9,      588285,     529731,      58554,     397490,     132241,   9.451889,  28.600000,  33.000000,  55.800000,  13.124531,   0.023000, 101.008996, 574.065018
Outstanding requests per worker:
139 138 155 138 152 125 144 148 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117624.7,      588124,     529424,      58700,     416410,     113014,  10.020639,  29.700000,  33.900000,  57.400000,  13.665344,   0.023000, 103.519000, 613.845003
Outstanding requests per worker:
158 175 158 172 131 179 175 152 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117670.9,      588355,     529302,      59053,     428293,     101009,  10.790031,  32.200000,  39.500000,  63.700000,  15.329997,   0.023000, 145.209998, 639.682958
Outstanding requests per worker:
115 143 178 158 159 157 159 145 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117495.3,      587477,     528876,      58601,     435750,      93126,  12.522834,  35.800000,  49.600000,  86.000000,  18.635721,   0.023000, 165.962994, 655.489039
Outstanding requests per worker:
205 232 242 252 315 206 291 257 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117825.1,      589126,     530091,      59035,     443217,      86874,  10.783901,  31.200000,  38.800000,  62.300000,  15.206686,   0.023000, 156.310007, 668.939608
Outstanding requests per worker:
155 159 122 173 144 165 120 121 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117649.1,      588246,     529552,      58694,     447576,      81976,  10.241705,  30.300000,  34.400000,  59.300000,  14.016713,   0.023000, 102.709003, 677.660704
Outstanding requests per worker:
135 161 146 166 152 138 144 139 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'7\r'
+ echo 'memcached pid is: 7'
memcached pid is: 7
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18028  2736 pts/0    Ss+  10:23   0:00 bash docker-ent
memcache     6  0.3  0.0  96652  6368 pts/0    S+   10:23   0:00 /usr/lib/linux-
memcache     7  134  0.0 281984 130524 pts/0   Sl+  10:23   1:02 memcached -t 2 
memcache    17  0.0  0.0  34424  2872 pts/1    Rs+  10:24   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       14852029666      instructions:u                                              
         424668282      L1-dcache-load-misses     # [35m  15.57%[m of all L1-dcache hits  
        2728306707      L1-dcache-loads                                             

      46.888547653 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 118000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 118000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 118000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 118000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 118000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 118000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 118000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 118000 cpus 8
meanInterarrival 67
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 4182554368
starting receive base loop
num_worker_connections 64
Creating worker on tid 3583272704
starting receive base loop
num_worker_connections 64
Creating worker on tid 2992928512
starting receive base loop
num_worker_connections 64
Creating worker on tid 2396960512
starting receive base loop
num_worker_connections 64
Creating worker on tid 1800992512
starting receive base loop
num_worker_connections 64
Creating worker on tid 1205024512
starting receive base loop
num_worker_connections 64
Creating worker on tid 609056512
starting receive base loop
Created 512 connections total
Creating worker on tid 17053440
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575370277.368702,       0.0,      354707,     319519,      35188,     213877,     105642,   6.166342,  23.400000,  31.100000,  51.200000,  13.292345,   0.000000, 386.837989, 484.734845
Outstanding requests per worker:
166 182 125 157 155 180 171 134 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  119378.1,      596891,     537235,      59656,     402922,     134313,  10.228251,  31.100000,  36.000000,  61.200000,  14.301072,   0.024000, 115.969002, 573.916031
Outstanding requests per worker:
146 148 208 223 185 174 180 181 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  119444.5,      597223,     537651,      59572,     424116,     113535,  10.900576,  32.600000,  37.200000,  63.800000,  15.014185,   0.023000, 114.197001, 616.375303
Outstanding requests per worker:
121 168 160 143 172 184 173 169 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  118762.9,      593815,     534697,      59118,     433137,     101560,  16.112969,  46.700000,  71.100000, 117.100000,  25.532193,   0.024000, 195.126995, 640.282543
Outstanding requests per worker:
537 671 548 591 593 531 524 527 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117552.3,      587762,     528813,      58949,     436422,      92391,  76.545157, 210.700000, 247.400000, 315.600000,  91.604556,   0.023000, 478.673011, 656.665008
Outstanding requests per worker:
1731 1724 1600 1740 1795 1653 1805 1766 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  118005.7,      590029,     530947,      59082,     444112,      86835, 143.859915, 360.300000, 401.800000, 495.900000, 158.263816,   0.023000, 884.284019, 669.855605
Outstanding requests per worker:
2603 2596 2542 2649 2699 2553 2626 2591 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117885.9,      589430,     530504,      58926,     448272,      82232, 202.402470, 503.700000, 581.200000, 720.500000, 222.709074,   0.024000, 997.548997, 678.755706
Outstanding requests per worker:
3365 3638 3633 3627 3547 3239 3579 3845 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'7\r'
+ echo 'memcached pid is: 7'
memcached pid is: 7
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.4  0.0  18028  2772 pts/0    Ss+  10:24   0:00 bash docker-ent
memcache     6  0.5  0.0  96652  6336 pts/0    S+   10:24   0:00 /usr/lib/linux-
memcache     7  131  0.0 283008 137072 pts/0   Sl+  10:24   1:01 memcached -t 2 
memcache    17  0.0  0.0  34424  2916 pts/1    Rs+  10:25   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       14982007325      instructions:u                                              
         427931927      L1-dcache-load-misses     # [35m  15.50%[m of all L1-dcache hits  
        2760101512      L1-dcache-loads                                             

      46.812219111 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 120000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 120000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 120000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 120000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 120000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 120000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 120000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 120000 cpus 8
meanInterarrival 66
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 3918624512
starting receive base loop
num_worker_connections 64
Creating worker on tid 3328472832
starting receive base loop
num_worker_connections 64
Creating worker on tid 2732504832
starting receive base loop
num_worker_connections 64
Creating worker on tid 2136536832
starting receive base loop
num_worker_connections 64
Creating worker on tid 1540568832
starting receive base loop
num_worker_connections 64
Creating worker on tid 944600832
starting receive base loop
num_worker_connections 64
Creating worker on tid 348632832
starting receive base loop
Created 512 connections total
Creating worker on tid 4047632128
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575370326.368751,       0.0,      345493,     311236,      34257,     207319,     103917,  36.066771, 101.700000, 119.100000, 158.200000,  43.648098,   0.000000, 481.256992, 481.575097
Outstanding requests per worker:
1505 1436 1364 1400 1311 1408 1357 1389 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  116568.3,      582842,     524735,      58107,     392956,     131779, 191.990586, 301.700000, 341.900000, 424.000000,  83.166920,   0.296000, 704.737008, 573.065431
Outstanding requests per worker:
4330 4308 4188 4230 4255 4457 4415 4301 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  116944.5,      584723,     526193,      58530,     414042,     112151, 366.905734, 525.800000, 584.600000, 699.600000, 118.978302,  22.874000, 1045.017958, 614.060345
Outstanding requests per worker:
6841 7107 6937 7010 6988 6941 7046 7040 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  116456.1,      582281,     524321,      57960,     423466,     100855, 558.477249, 785.000000, 859.400000, 1011.800000, 169.489397, 101.549998, 1357.929945, 637.200763
Outstanding requests per worker:
9953 9699 9996 9880 9806 10239 10020 10134 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114962.3,      574812,     517186,      57626,     425813,      91373, 772.523687, 1076.800000, 1174.500000, 1327.900000, 224.745966, 169.699997, 1828.889012, 654.472169
Outstanding requests per worker:
13734 13780 14068 14215 13654 14021 13791 13771 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114624.7,      573124,     515858,      57266,     430325,      85533, 1051.376862, 1407.400000, 1505.100000, 1703.500000, 269.148241, 245.933995, 1957.790971, 667.033122
Outstanding requests per worker:
18049 17750 18411 18181 17844 18207 17810 17799 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  113978.5,      569893,     512664,      57229,     432616,      80048, 1336.041820, 1748.800000, 1863.400000, 2070.000000, 317.047426, 343.272001, 2602.674961, 677.225781
Outstanding requests per worker:
22566 22267 22759 22755 22381 22726 22395 22429 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'7\r'
+ echo 'memcached pid is: 7'
memcached pid is: 7
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18028  2872 pts/0    Ss+  10:25   0:00 bash docker-ent
memcache     6  0.4  0.0  96652  6336 pts/0    S+   10:25   0:00 /usr/lib/linux-
memcache     7  141  0.0 280960 141152 pts/0   Sl+  10:25   1:06 memcached -t 2 
memcache    16 18.0  0.0  34424  2812 pts/1    Rs+  10:26   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       14077725712      instructions:u                                              
         395055185      L1-dcache-load-misses     # [35m  16.27%[m of all L1-dcache hits  
        2427484212      L1-dcache-loads                                             

      46.888874030 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 122000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 122000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 122000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 122000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 122000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 122000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 122000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 122000 cpus 8
meanInterarrival 65
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 1498367744
starting receive base loop
num_worker_connections 64
Creating worker on tid 907097856
starting receive base loop
num_worker_connections 64
Creating worker on tid 316585728
starting receive base loop
num_worker_connections 64
Creating worker on tid 4015585024
starting receive base loop
num_worker_connections 64
Creating worker on tid 3419617024
starting receive base loop
num_worker_connections 64
Creating worker on tid 2823649024
starting receive base loop
num_worker_connections 64
Creating worker on tid 2227681024
starting receive base loop
Created 512 connections total
Creating worker on tid 1631713024
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575370375.368800,       0.0,      356040,     320252,      35788,     214250,     106002,  21.776633,  85.700000, 116.600000, 186.600000,  49.994693,   0.000000, 737.192988, 484.136880
Outstanding requests per worker:
742 909 855 928 890 818 904 1175 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  120502.9,      602515,     542203,      60312,     407149,     135054, 109.428454, 293.800000, 342.300000, 430.300000, 127.562114,   0.023000, 624.243021, 574.561137
Outstanding requests per worker:
2601 2631 2444 2504 2551 2459 2374 2580 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  126246.1,      631231,     567847,      63384,     447852,     119995, 154.558216, 446.000000, 507.200000, 613.800000, 191.100128,   0.023000, 873.647988, 616.538849
Outstanding requests per worker:
541 573 546 524 521 527 599 516 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  119981.1,      599906,     539918,      59988,     437995,     101923,  92.337124, 271.800000, 320.000000, 405.100000, 115.954948,   0.024000, 609.489977, 641.223851
Outstanding requests per worker:
2526 2536 2512 2426 2455 2700 2427 2283 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  120752.1,      603761,     543212,      60549,     449154,      94058, 206.392333, 514.100000, 578.200000, 714.300000, 227.563495,   0.023000, 1052.382946, 659.155766
Outstanding requests per worker:
4098 3668 3773 3809 4061 4289 3898 3927 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  119576.1,      597881,     537806,      60075,     450433,      87373, 318.493374, 809.300000, 902.000000, 1079.700000, 353.260634,   0.023000, 1558.616042, 670.404767
Outstanding requests per worker:
6237 6040 5673 5998 6173 6473 6339 6144 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  119201.9,      596010,     536212,      59798,     453851,      82361, 457.404872, 1142.100000, 1254.500000, 1469.700000, 500.973065,   0.023000, 1986.361980, 680.027670
Outstanding requests per worker:
8888 8210 8054 8710 8333 8778 9044 8465 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'7\r'
+ echo 'memcached pid is: 7'
memcached pid is: 7
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18028  2768 pts/0    Ss+  10:26   0:00 bash docker-ent
memcache     6  0.5  0.0  96652  6244 pts/0    S+   10:26   0:00 /usr/lib/linux-
memcache     7  136  0.0 284032 144396 pts/0   Sl+  10:26   1:02 memcached -t 2 
memcache    16  0.0  0.0  34424  2848 pts/1    Rs+  10:27   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       15329285966      instructions:u                                              
         436109952      L1-dcache-load-misses     # [35m  15.47%[m of all L1-dcache hits  
        2818259457      L1-dcache-loads                                             

      46.730018341 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 124000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 124000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 124000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 124000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 124000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 124000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 124000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 124000 cpus 8
meanInterarrival 64
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 819033856
starting receive base loop
num_worker_connections 64
Creating worker on tid 230438656
starting receive base loop
num_worker_connections 64
Creating worker on tid 3932452608
starting receive base loop
num_worker_connections 64
Creating worker on tid 3336484608
starting receive base loop
num_worker_connections 64
Creating worker on tid 2737202944
starting receive base loop
num_worker_connections 64
Creating worker on tid 2137921280
starting receive base loop
num_worker_connections 64
Creating worker on tid 1548580608
starting receive base loop
Created 512 connections total
Creating worker on tid 952612608
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575370424.368849,       0.0,      362018,     325674,      36344,     216962,     108712,  25.548177, 109.700000, 136.300000, 183.000000,  47.757255,   0.000000, 281.062007, 482.635292
Outstanding requests per worker:
1105 1025 1049 971 1006 992 1138 1110 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117365.7,      586829,     527942,      58887,     395742,     132200, 224.955944, 393.400000, 449.200000, 559.200000, 126.891947,   0.049000, 805.720985, 573.571364
Outstanding requests per worker:
5648 5761 5862 6322 5811 5845 5526 5864 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  116220.9,      581105,     523025,      58080,     412513,     110512, 550.619336, 798.200000, 877.300000, 1025.900000, 181.987879,  59.363000, 1532.235026, 616.091087
Outstanding requests per worker:
11385 11301 11198 11723 11292 11351 11406 10966 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  115209.9,      576050,     517971,      58079,     419165,      98806, 913.496031, 1235.000000, 1332.400000, 1508.800000, 239.165918, 212.809995, 2030.566931, 639.318626
Outstanding requests per worker:
17377 17371 17556 17751 17416 17579 17333 17239 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  113650.9,      568255,     511531,      56724,     421430,      90101, 1352.411321, 1736.200000, 1841.200000, 2037.700000, 287.271319, 388.581008, 2409.719944, 654.847780
Outstanding requests per worker:
24594 24409 24618 24966 24420 24847 24446 24136 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114020.1,      570101,     513438,      56663,     429271,      84167, 1788.608261, 2214.900000, 2350.200000, 2600.000000, 326.031949, 749.073982, 3198.120117, 668.746649
Outstanding requests per worker:
31264 31371 31417 31734 31306 31721 31580 31015 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  113567.7,      567839,     511145,      56694,     431448,      79697, 2230.775236, 2730.100000, 2862.400000, 3083.200000, 363.141379, 925.728977, 3559.144974, 677.649074
Outstanding requests per worker:
38317 38655 38401 39035 38388 38771 38848 38214 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18028  2852 pts/0    Ss+  10:27   0:00 bash docker-ent
memcache     7  0.4  0.0  96652  6488 pts/0    S+   10:27   0:00 /usr/lib/linux-
memcache     8  144  0.0 280960 141068 pts/0   Sl+  10:27   1:06 memcached -t 2 
memcache    18  0.0  0.0  34424  2908 pts/1    Rs+  10:27   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       14061372715      instructions:u                                              
         395078146      L1-dcache-load-misses     # [35m  16.21%[m of all L1-dcache hits  
        2437204859      L1-dcache-loads                                             

      46.932081331 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 126000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 126000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 126000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 126000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 126000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 126000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 126000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 126000 cpus 8
meanInterarrival 63
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 10483456
starting receive base loop
num_worker_connections 64
Creating worker on tid 3712087808
starting receive base loop
num_worker_connections 64
Creating worker on tid 3112806144
starting receive base loop
num_worker_connections 64
Creating worker on tid 2523166464
starting receive base loop
num_worker_connections 64
Creating worker on tid 1927198464
starting receive base loop
num_worker_connections 64
Creating worker on tid 1331230464
starting receive base loop
num_worker_connections 64
Creating worker on tid 735262464
starting receive base loop
Created 512 connections total
Creating worker on tid 139294464
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575370472.368897,       0.0,      364501,     328110,      36391,     219444,     108666,  26.595093, 116.000000, 145.600000, 194.600000,  50.696462,   0.000000, 300.857991, 484.198805
Outstanding requests per worker:
1135 1147 1196 1243 1214 1243 1221 1277 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  6.000006,  102769.6,      616618,     554830,      61788,     417469,     137361, 140.069296, 374.900000, 437.400000, 555.000000, 162.048136,   0.023000, 859.118998, 576.551165
Outstanding requests per worker:
3353 3541 3480 3708 3530 3298 3411 3712 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  122191.1,      610956,     549906,      61050,     434853,     115053, 299.176010, 774.500000, 867.200000, 1028.900000, 336.427146,   0.024000, 1347.712040, 618.803437
Outstanding requests per worker:
6022 6479 6681 6816 6688 6565 6530 6275 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121998.1,      609991,     548832,      61159,     445470,     103362, 487.221668, 1205.600000, 1310.800000, 1494.700000, 531.528775,   0.023000, 1897.505045, 642.235440
Outstanding requests per worker:
9196 9544 9507 10078 9808 9558 9667 9666 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121012.1,      605061,     544220,      60841,     449735,      94485, 690.703827, 1676.900000, 1811.300000, 2035.000000, 749.263983,   0.023000, 2501.446009, 658.120556
Outstanding requests per worker:
13000 13328 13142 13584 13448 13573 13610 13226 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  120983.7,      604919,     544349,      60570,     456027,      88322, 911.184268, 2174.700000, 2316.000000, 2554.700000, 980.792433,   0.024000, 2963.815928, 670.782520
Outstanding requests per worker:
16731 17276 16567 17605 17065 17248 17559 16914 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  127186.1,      635931,     572334,      63597,     484782,      87552, 991.737785, 2266.300000, 2415.900000, 2652.500000, 1014.862824,   0.024000, 3216.494083, 681.088738
Outstanding requests per worker:
16815 17335 16309 17550 16575 17095 17369 16950 
Ran for 33.000033, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'7\r'
+ echo 'memcached pid is: 7'
memcached pid is: 7
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18028  2884 pts/0    Ss+  10:28   0:00 bash docker-ent
memcache     6  0.4  0.0  96652  6336 pts/0    S+   10:28   0:00 /usr/lib/linux-
memcache     7  137  0.0 285056 138924 pts/0   Sl+  10:28   1:03 memcached -t 2 
memcache    17  0.0  0.0  34424  2860 pts/1    Rs+  10:28   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       15536084393      instructions:u                                              
         431700366      L1-dcache-load-misses     # [35m  15.18%[m of all L1-dcache hits  
        2844206395      L1-dcache-loads                                             

      46.851284748 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 128000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 128000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 128000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 128000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 128000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 128000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 128000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 128000 cpus 8
meanInterarrival 62
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 3487516416
starting receive base loop
num_worker_connections 64
Creating worker on tid 2898769664
starting receive base loop
num_worker_connections 64
Creating worker on tid 2302801664
starting receive base loop
num_worker_connections 64
Creating worker on tid 1709848320
starting receive base loop
num_worker_connections 64
Creating worker on tid 1113880320
starting receive base loop
num_worker_connections 64
Creating worker on tid 514598656
starting receive base loop
num_worker_connections 64
Creating worker on tid 4216911616
starting receive base loop
Created 512 connections total
Creating worker on tid 3624908544
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575370521.368946,       0.0,      370624,     333789,      36835,     223115,     110674,  25.987040, 114.900000, 150.900000, 208.100000,  52.249619,   0.000000, 394.329011, 485.007064
Outstanding requests per worker:
1461 1386 1373 1439 1322 1312 1359 1414 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  123085.9,      615430,     553812,      61618,     416513,     137299, 194.507278, 539.900000, 621.500000, 760.300000, 231.619537,   0.023000, 1088.776946, 575.669572
Outstanding requests per worker:
5311 4860 5164 5131 5134 4939 5163 5145 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  115130.7,      575654,     517954,      57700,     408220,     109734, 586.997498, 1085.800000, 1202.200000, 1388.000000, 366.401000,   0.026000, 1703.639984, 616.123951
Outstanding requests per worker:
13943 13686 13723 13861 13747 13726 13967 13771 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114576.5,      572883,     515577,      57306,     417603,      97974, 1131.846686, 1683.700000, 1814.200000, 2026.000000, 401.834554, 111.442000, 2342.761040, 640.097599
Outstanding requests per worker:
22975 22700 23034 23127 22709 22589 22886 22736 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  113844.1,      569221,     512234,      56987,     422408,      89826, 1701.196719, 2295.600000, 2444.500000, 2684.100000, 437.281537, 498.950988, 3151.618958, 655.935289
Outstanding requests per worker:
32463 32152 32533 32652 32145 31987 32760 32058 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  112357.9,      561790,     505628,      56162,     422638,      82990, 2322.233387, 2967.600000, 3135.600000, 3419.400000, 485.575770, 947.591007, 3949.739933, 668.600669
Outstanding requests per worker:
42915 42436 42607 43281 42609 42365 43180 42845 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  112686.9,      563435,     507293,      56142,     428448,      78845, 2959.939487, 3648.600000, 3824.300000, 4148.900000, 516.752160, 1510.705948, 4675.470829, 678.483103
Outstanding requests per worker:
53405 52343 52947 53747 52932 52455 53353 52840 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'7\r'
+ echo 'memcached pid is: 7'
memcached pid is: 7
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.4  0.0  18028  2756 pts/0    Ss+  10:28   0:00 bash docker-ent
memcache     6  0.5  0.0  96652  6328 pts/0    S+   10:28   0:00 /usr/lib/linux-
memcache     7  140  0.0 281984 142268 pts/0   Sl+  10:28   1:06 memcached -t 2 
memcache    17  0.0  0.0  34424  2788 pts/1    Rs+  10:29   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       14183305145      instructions:u                                              
         398663721      L1-dcache-load-misses     # [35m  16.06%[m of all L1-dcache hits  
        2481937861      L1-dcache-loads                                             

      46.921161946 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 130000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 130000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 130000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,L1-dcache-load-misses:u,L1-dcache-loads:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 130000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 130000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 130000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 130000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 130000 cpus 8
meanInterarrival 61
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 3868575488
starting receive base loop
num_worker_connections 64
Creating worker on tid 3277305600
starting receive base loop
num_worker_connections 64
Creating worker on tid 2681419520
starting receive base loop
num_worker_connections 64
Creating worker on tid 2085451520
starting receive base loop
num_worker_connections 64
Creating worker on tid 1489483520
starting receive base loop
num_worker_connections 64
Creating worker on tid 893515520
starting receive base loop
num_worker_connections 64
Creating worker on tid 300562176
starting receive base loop
Created 512 connections total
Creating worker on tid 3999561472
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575370570.368995,       0.0,      379482,     341799,      37683,     229659,     112140,  15.569996,  55.300000,  93.900000, 136.500000,  31.160926,   0.000000, 215.290993, 488.269413
Outstanding requests per worker:
800 956 909 841 886 784 758 894 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  124435.3,      622177,     560224,      61953,     422050,     138174, 171.850556, 501.300000, 588.400000, 726.300000, 214.640947,   0.023000, 1014.204979, 576.836153
Outstanding requests per worker:
4917 5120 5044 4922 4984 5042 5316 5096 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  124211.9,      621060,     558925,      62135,     441425,     117500, 413.013174, 1069.900000, 1177.900000, 1378.600000, 466.330439,   0.023000, 1805.140018, 618.294707
Outstanding requests per worker:
9344 9251 9432 9120 9485 9286 9758 9495 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  123175.7,      615879,     554220,      61659,     450668,     103552, 682.554036, 1691.900000, 1815.700000, 2041.400000, 754.080317,   0.023000, 2679.212093, 643.081312
Outstanding requests per worker:
14471 14051 14540 14403 14354 14092 14651 14499 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  122734.5,      613673,     552143,      61530,     456769,      95374, 960.664596, 2326.700000, 2477.900000, 2736.200000, 1053.715579,   0.023000, 3249.026060, 659.388139
Outstanding requests per worker:
19623 19382 19722 19716 19710 19350 20034 19633 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  122625.9,      613130,     551970,      61160,     462978,      88992, 1265.292212, 2999.500000, 3161.300000, 3436.400000, 1376.947041,   0.024000, 3992.557049, 671.550872
Outstanding requests per worker:
24785 24784 25495 25116 24882 24725 25103 24929 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  122476.7,      612384,     551043,      61341,     466981,      84062, 1567.152734, 3689.500000, 3863.800000, 4137.300000, 1705.610076,   0.024000, 4752.610207, 681.148484
Outstanding requests per worker:
30088 30137 31041 30186 30728 30289 30355 30387 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18028  2776 pts/0    Ss+  10:29   0:00 bash docker-ent
memcache     7  0.5  0.0  96652  6388 pts/0    S+   10:29   0:00 /usr/lib/linux-
memcache     8  135  0.0 285056 140148 pts/0   Sl+  10:29   1:03 memcached -t 2 
memcache    17  0.0  0.0  34424  2820 pts/1    Rs+  10:30   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       15639124713      instructions:u                                              
         434351004      L1-dcache-load-misses     # [35m  15.14%[m of all L1-dcache hits  
        2868449837      L1-dcache-loads                                             

      46.909691247 seconds time elapsed

