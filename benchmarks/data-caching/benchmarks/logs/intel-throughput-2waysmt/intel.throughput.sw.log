+ for keys in '$KEYS'
+ for conns in '$CONNS'
+ for threads in '$THREADS'
+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 104000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 104000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 104000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 104000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 104000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 104000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 104000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 104000 cpus 4
meanInterarrival 38
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 2266167040
starting receive base loop
num_worker_connections 128
Creating worker on tid 1154131712
starting receive base loop
num_worker_connections 128
Creating worker on tid 42096384
starting receive base loop
Created 512 connections total
Creating worker on tid 3233040128
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575374674.373099,       0.0,      240235,     216145,      24090,     140631,      75514,   2.990091,   8.800000,  13.100000,  23.100000,   4.911107,   0.000000,  39.060000, 464.786727
Outstanding requests per worker:
79 87 82 74 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  105301.9,      526510,     474210,      52300,     348796,     125414,   2.266500,   6.600000,   7.800000,  10.800000,   2.857228,   0.032000,  17.486000, 557.818545
Outstanding requests per worker:
45 37 46 35 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  105251.9,      526260,     473649,      52611,     367764,     105885,   2.206462,   6.600000,   7.700000,  10.000000,   2.751440,   0.033000,  15.679000, 602.526280
Outstanding requests per worker:
66 59 55 65 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  105281.1,      526406,     473817,      52589,     379206,      94611,   2.140263,   6.400000,   7.400000,   9.000000,   2.615836,   0.033000,  11.735000, 629.897883
Outstanding requests per worker:
46 54 52 46 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  105261.9,      526310,     473549,      52761,     386586,      86963,   2.407113,   7.100000,   8.300000,  11.500000,   3.087707,   0.032000,  20.579999, 646.940509
Outstanding requests per worker:
66 47 58 57 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  105266.5,      526333,     473481,      52852,     392542,      80939,   2.383170,   7.300000,   8.400000,  10.000000,   2.941638,   0.031000,  12.803000, 661.068512
Outstanding requests per worker:
55 62 78 55 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  105267.1,      526336,     473980,      52356,     396875,      77105,   2.329028,   7.100000,   8.200000,   9.800000,   2.870235,   0.032000,  13.619000, 670.287337
Outstanding requests per worker:
71 63 68 53 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18032  2884 pts/0    Ss+  11:38   0:00 bash docker-ent
memcache     7  0.5  0.0  96552  6472 pts/0    S+   11:38   0:00 /usr/lib/linux-
memcache     8  127  0.0 271744 117752 pts/0   Sl+  11:38   0:58 memcached -t 2 
memcache    17  0.0  0.0  34424  2760 pts/1    Rs+  11:38   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       13073251748      instructions:u            #    0.58  insn per cycle         
       82652819447      instructions:k            #    0.59  insn per cycle         
      139419792155      cycles:k                                                    
       22637833788      cycles:u                                                    

      45.848743953 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 106000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 106000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 106000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 106000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 106000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 106000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 106000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 106000 cpus 4
meanInterarrival 37
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 495781632
starting receive base loop
num_worker_connections 128
Creating worker on tid 3688134400
starting receive base loop
num_worker_connections 128
Creating worker on tid 2579330816
starting receive base loop
Created 512 connections total
Creating worker on tid 1473541888
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575374722.373147,       0.0,      247550,     222864,      24686,     145075,      77789,   5.426040,  17.000000,  28.300000,  47.900000,  10.391300,   0.000000, 115.983002, 464.370966
Outstanding requests per worker:
110 84 102 90 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108108.1,      540541,     486483,      54058,     357519,     128964,   4.352049,   8.400000,   9.900000,  13.000000,   3.080460,   0.032000,  17.541001, 557.184833
Outstanding requests per worker:
117 116 122 88 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108106.1,      540531,     486756,      53775,     379102,     107654,   4.723339,   8.300000,   9.200000,  12.300000,   2.781568,   0.105000,  21.856001, 605.041380
Outstanding requests per worker:
115 116 135 121 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108110.3,      540552,     486489,      54063,     389945,      96544,   4.680073,   8.400000,   9.100000,  10.400000,   2.621211,   0.112000,  13.127000, 630.123364
Outstanding requests per worker:
136 136 141 134 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108124.7,      540624,     486635,      53989,     397844,      88791,   5.252279,   9.500000,  10.600000,  13.700000,   3.155104,   0.111000,  22.891000, 648.045958
Outstanding requests per worker:
132 123 130 120 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108144.5,      540723,     486777,      53946,     404188,      82589,   4.089642,   9.400000,  11.600000,  14.600000,   3.854609,   0.033000,  25.556000, 662.357392
Outstanding requests per worker:
105 90 107 91 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108122.5,      540613,     486539,      54074,     408813,      77726,   3.743711,  11.700000,  13.900000,  18.000000,   4.962536,   0.032000,  36.392000, 673.219103
Outstanding requests per worker:
77 96 95 81 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'7\r'
+ echo 'memcached pid is: 7'
memcached pid is: 7
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.4  0.0  18032  2760 pts/0    Ss+  11:38   0:00 bash docker-ent
memcache     6  0.5  0.0  96552  6456 pts/0    S+   11:38   0:00 /usr/lib/linux-
memcache     7  136  0.0 273792 121196 pts/0   Sl+  11:38   1:02 memcached -t 2 
memcache    17 19.0  0.0  34424  2860 pts/1    Rs+  11:39   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       13057013999      instructions:u            #    0.54  insn per cycle         
       85378256337      instructions:k            #    0.54  insn per cycle         
      158174316256      cycles:k                                                    
       24204302461      cycles:u                                                    

      45.821123510 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 108000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 108000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 108000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 108000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 108000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 108000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 108000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 108000 cpus 4
meanInterarrival 37
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 1487218432
starting receive base loop
num_worker_connections 128
Creating worker on tid 380761856
starting receive base loop
num_worker_connections 128
Creating worker on tid 3569940224
starting receive base loop
Created 512 connections total
Creating worker on tid 2462004992
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575374770.373195,       0.0,      249273,     224150,      25123,     145324,      78826,   4.749679,  14.700000,  23.600000,  39.600000,   8.429222,   0.000000,  80.720000, 462.355815
Outstanding requests per worker:
98 94 104 106 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108134.1,      540671,     486507,      54164,     358154,     128353,   3.320430,  10.300000,  12.200000,  15.600000,   4.303200,   0.032000,  25.260000, 558.495489
Outstanding requests per worker:
85 87 72 73 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108109.7,      540549,     486601,      53948,     378251,     108350,   3.409655,  10.600000,  12.700000,  15.700000,   4.426603,   0.032000,  25.774000, 603.869495
Outstanding requests per worker:
87 73 87 93 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108110.7,      540554,     486367,      54187,     389804,      96563,   3.337868,  10.500000,  12.700000,  14.800000,   4.272277,   0.031000,  17.812001, 630.607815
Outstanding requests per worker:
85 107 88 85 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108106.5,      540533,     486636,      53897,     398420,      88216,   3.627106,  11.100000,  13.600000,  17.700000,   4.781613,   0.032000,  29.255999, 649.693586
Outstanding requests per worker:
96 103 100 103 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108111.5,      540558,     486135,      54423,     403360,      82775,   3.606649,  11.200000,  13.800000,  16.400000,   4.647896,   0.032000,  21.193000, 661.671577
Outstanding requests per worker:
110 101 110 102 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108113.1,      540566,     486435,      54131,     408272,      78163,   3.534080,  11.000000,  13.500000,  15.800000,   4.541842,   0.032000,  19.114001, 672.188050
Outstanding requests per worker:
97 87 117 124 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'7\r'
+ echo 'memcached pid is: 7'
memcached pid is: 7
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18032  2784 pts/0    Ss+  11:39   0:00 bash docker-ent
memcache     6  0.4  0.0  96552  6504 pts/0    S+   11:39   0:00 /usr/lib/linux-
memcache     7  131  0.0 273792 119840 pts/0   Sl+  11:39   0:59 memcached -t 2 
memcache    16  0.0  0.0  34424  2824 pts/1    Rs+  11:40   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       13406306227      instructions:u            #    0.58  insn per cycle         
       83659978498      instructions:k            #    0.60  insn per cycle         
      140392243198      cycles:k                                                    
       23188142684      cycles:u                                                    

      45.869475562 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 110000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 110000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 110000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 110000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 110000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 110000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 110000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 110000 cpus 4
meanInterarrival 36
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 3203290880
starting receive base loop
num_worker_connections 128
Creating worker on tid 2101556992
starting receive base loop
num_worker_connections 128
Creating worker on tid 995768064
starting receive base loop
Created 512 connections total
Creating worker on tid 4181931776
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575374818.373243,       0.0,      255885,     230426,      25459,     150296,      80130,   4.830453,  15.300000,  21.600000,  35.800000,   8.127615,   0.000000,  93.197003, 465.346866
Outstanding requests per worker:
111 96 79 113 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  111126.9,      555635,     499924,      55711,     369488,     130436,   4.000687,  12.300000,  15.400000,  19.200000,   5.264786,   0.032000,  29.545000, 561.929325
Outstanding requests per worker:
89 78 102 100 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  111100.1,      555501,     499982,      55519,     389960,     110022,   4.130379,  12.600000,  15.900000,  19.800000,   5.476062,   0.032000,  36.522999, 606.952984
Outstanding requests per worker:
96 121 109 126 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  111130.5,      555653,     500017,      55636,     401962,      98055,   4.010342,  12.100000,  15.700000,  18.900000,   5.235179,   0.032000,  23.287000, 633.278145
Outstanding requests per worker:
104 97 90 108 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  111101.7,      555509,     500237,      55272,     410170,      90067,   4.467560,  13.500000,  17.300000,  22.100000,   6.015132,   0.032000,  60.896002, 650.893067
Outstanding requests per worker:
144 99 116 117 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  111105.9,      555530,     499598,      55932,     415268,      84330,   4.284539,  12.800000,  16.900000,  20.500000,   5.619676,   0.032000,  27.749000, 662.820622
Outstanding requests per worker:
155 143 129 116 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  111110.1,      555551,     500134,      55417,     420590,      79544,   4.286282,  12.800000,  16.900000,  20.700000,   5.630479,   0.032000,  25.117001, 674.259069
Outstanding requests per worker:
139 141 167 131 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18032  2840 pts/0    Ss+  11:40   0:00 bash docker-ent
memcache     7  0.5  0.0  96552  6488 pts/0    S+   11:40   0:00 /usr/lib/linux-
memcache     8  132  0.0 275840 122056 pts/0   Sl+  11:40   0:59 memcached -t 2 
memcache    17  0.0  0.0  34424  2868 pts/1    Rs+  11:41   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       13797339360      instructions:u            #    0.59  insn per cycle         
       85235668137      instructions:k            #    0.60  insn per cycle         
      141365847179      cycles:k                                                    
       23301557031      cycles:u                                                    

      45.780702744 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 112000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 112000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 112000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 112000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 112000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 112000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 112000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 112000 cpus 4
meanInterarrival 35
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 1470093056
starting receive base loop
num_worker_connections 128
Creating worker on tid 364738304
starting receive base loop
num_worker_connections 128
Creating worker on tid 3553916672
starting receive base loop
Created 512 connections total
Creating worker on tid 2445113088
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575374866.373291,       0.0,      262974,     236543,      26431,     154294,      82249,   6.529936,  21.400000,  29.200000,  47.100000,  11.048861,   0.000000, 133.853003, 466.888198
Outstanding requests per worker:
133 118 128 148 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114290.5,      571453,     514472,      56981,     380447,     134025,   5.395771,  15.600000,  20.900000,  27.700000,   7.199620,   0.032000,  41.836001, 562.648105
Outstanding requests per worker:
150 131 151 120 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114278.3,      571392,     514462,      56930,     402341,     112121,   5.391634,  15.600000,  20.900000,  27.600000,   7.205682,   0.032000,  41.848000, 608.651102
Outstanding requests per worker:
158 148 148 166 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114314.7,      571574,     514508,      57066,     414571,      99937,   5.350678,  15.400000,  21.000000,  27.500000,   7.119383,   0.032000,  35.650998, 634.522060
Outstanding requests per worker:
121 143 125 131 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114282.5,      571413,     514361,      57052,     421790,      92571,   6.105378,  17.600000,  23.800000,  31.600000,   8.282488,   0.032000,  57.812002, 651.387358
Outstanding requests per worker:
155 137 140 133 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114273.5,      571368,     514279,      57089,     428199,      86080,   5.730343,  16.400000,  22.300000,  29.700000,   7.638949,   0.033000,  36.343999, 664.284200
Outstanding requests per worker:
161 164 152 190 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114307.1,      571536,     514131,      57405,     433385,      80746,   5.878362,  16.800000,  22.700000,  30.600000,   7.825123,   0.032000,  36.171999, 675.842081
Outstanding requests per worker:
144 162 138 146 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18032  2740 pts/0    Ss+  11:41   0:00 bash docker-ent
memcache     7  0.5  0.0  96552  6484 pts/0    S+   11:41   0:00 /usr/lib/linux-
memcache     8  133  0.0 276864 123008 pts/0   Sl+  11:41   0:59 memcached -t 2 
memcache    17  0.0  0.0  34424  2820 pts/1    Rs+  11:42   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       14137185425      instructions:u            #    0.58  insn per cycle         
       86166085771      instructions:k            #    0.61  insn per cycle         
      141790961758      cycles:k                                                    
       24344686176      cycles:u                                                    

      45.862696266 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 114000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 114000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 114000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 114000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 114000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 114000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 114000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 114000 cpus 4
meanInterarrival 35
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 480061184
starting receive base loop
num_worker_connections 128
Creating worker on tid 3669096192
starting receive base loop
num_worker_connections 128
Creating worker on tid 2563307264
starting receive base loop
Created 512 connections total
Creating worker on tid 1454503680
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575374913.373338,       0.0,      261762,     235418,      26344,     153427,      81991,   5.880895,  19.400000,  26.500000,  41.000000,   9.853514,   0.000000, 131.218001, 466.711263
Outstanding requests per worker:
139 135 116 139 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114298.5,      571493,     514550,      56943,     380010,     134540,   4.883494,  14.300000,  19.000000,  24.400000,   6.474580,   0.032000,  37.094001, 561.246948
Outstanding requests per worker:
152 111 109 142 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114295.9,      571480,     514520,      56960,     402544,     111976,   4.912756,  14.500000,  19.100000,  24.700000,   6.550250,   0.032000,  40.968999, 609.011008
Outstanding requests per worker:
133 104 114 140 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114278.1,      571391,     514149,      57242,     413422,     100727,   4.806361,  13.900000,  19.000000,  23.900000,   6.351631,   0.032000,  28.867999, 633.478060
Outstanding requests per worker:
141 132 147 153 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114286.9,      571435,     514262,      57173,     421976,      92286,   5.533041,  16.200000,  21.700000,  27.900000,   7.490997,   0.033000,  71.479999, 652.032277
Outstanding requests per worker:
141 165 146 143 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114295.3,      571477,     514271,      57206,     428319,      85952,   5.230587,  15.100000,  20.500000,  26.600000,   6.940064,   0.033000,  35.305001, 664.791779
Outstanding requests per worker:
153 114 144 180 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114287.3,      571437,     513889,      57548,     432658,      81231,   5.242587,  15.100000,  20.600000,  26.400000,   6.955186,   0.033000,  37.122000, 674.454744
Outstanding requests per worker:
141 148 162 156 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18032  2844 pts/0    Ss+  11:42   0:00 bash docker-ent
memcache     7  0.4  0.0  96552  6328 pts/0    S+   11:42   0:00 /usr/lib/linux-
memcache     8  130  0.0 277888 124124 pts/0   Sl+  11:42   0:59 memcached -t 2 
memcache    18  0.0  0.0  34424  2756 pts/1    Rs+  11:42   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       14184987605      instructions:u            #    0.59  insn per cycle         
       86589112351      instructions:k            #    0.61  insn per cycle         
      142557513469      cycles:k                                                    
       23919604270      cycles:u                                                    

      45.890460788 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 116000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 116000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 116000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 116000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 116000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 116000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 116000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 116000 cpus 4
meanInterarrival 34
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 4057323264
starting receive base loop
num_worker_connections 128
Creating worker on tid 2949936896
starting receive base loop
num_worker_connections 128
Creating worker on tid 1841133312
starting receive base loop
Created 512 connections total
Creating worker on tid 735344384
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575374961.373386,       0.0,      269637,     242573,      27064,     159046,      83527,  15.602941,  52.800000,  79.800000, 120.200000,  27.392170,   0.000000, 209.325001, 469.711930
Outstanding requests per worker:
179 216 179 191 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117652.3,      588262,     529644,      58618,     392780,     136864,   6.601451,  19.100000,  25.100000,  35.200000,   8.933027,   0.032000,  76.614000, 564.613758
Outstanding requests per worker:
225 176 186 204 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117642.1,      588211,     529783,      58428,     415325,     114458,   6.870627,  19.800000,  26.600000,  35.800000,   9.373096,   0.032000,  95.596999, 611.368477
Outstanding requests per worker:
207 195 231 213 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117674.7,      588374,     529320,      59054,     427136,     102184,   6.609567,  18.900000,  24.300000,  35.300000,   8.848624,   0.032000,  45.456000, 636.328767
Outstanding requests per worker:
198 194 168 192 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117637.1,      588186,     529431,      58755,     434998,      94433,   7.817055,  22.800000,  29.000000,  42.700000,  10.625603,   0.032000,  99.650003, 653.198664
Outstanding requests per worker:
181 221 229 202 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117671.9,      588360,     529259,      59101,     442269,      86990,   7.033928,  20.300000,  25.600000,  38.100000,   9.458162,   0.032000,  61.549999, 668.640354
Outstanding requests per worker:
197 199 186 171 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117643.5,      588218,     529413,      58805,     446906,      82507,   7.178132,  20.700000,  26.000000,  38.900000,   9.649569,   0.033000,  76.020002, 677.539339
Outstanding requests per worker:
206 197 191 208 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18032  2860 pts/0    Ss+  11:42   0:00 bash docker-ent
memcache     7  0.4  0.0  96552  6344 pts/0    S+   11:42   0:00 /usr/lib/linux-
memcache     8  131  0.0 279936 127108 pts/0   Sl+  11:42   1:00 memcached -t 2 
memcache    17 18.0  0.0  34424  2868 pts/1    Rs+  11:43   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       14536213195      instructions:u            #    0.60  insn per cycle         
       87329268532      instructions:k            #    0.61  insn per cycle         
      142921893665      cycles:k                                                    
       24162443771      cycles:u                                                    

      45.703313772 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 118000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 118000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 118000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 118000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 118000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 118000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 118000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 118000 cpus 4
meanInterarrival 33
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 2621978368
starting receive base loop
num_worker_connections 128
Creating worker on tid 1513600768
starting receive base loop
num_worker_connections 128
Creating worker on tid 407811840
starting receive base loop
Created 512 connections total
Creating worker on tid 3593975552
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575375009.373434,       0.0,      275152,     247803,      27349,     162000,      85803,  33.992379, 114.600000, 134.400000, 172.600000,  49.168991,   0.000000, 256.256014, 468.740463
Outstanding requests per worker:
1111 1078 1165 1116 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121896.5,      609483,     548614,      60869,     407460,     141154,  15.576637,  48.200000,  74.600000, 107.500000,  24.974361,   0.043000, 225.169003, 565.621960
Outstanding requests per worker:
284 290 282 246 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121214.1,      606071,     545411,      60660,     428289,     117122,   9.640010,  28.000000,  32.700000,  53.900000,  12.949821,   0.044000, 114.233002, 612.670186
Outstanding requests per worker:
254 294 279 296 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121216.5,      606083,     545349,      60734,     440901,     104448,   9.537792,  27.900000,  31.800000,  53.900000,  12.808325,   0.044000,  95.285997, 638.527371
Outstanding requests per worker:
241 263 339 303 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121208.3,      606042,     545207,      60835,     449367,      95840,  12.636172,  32.100000,  42.100000,  69.900000,  15.412129,   0.044000, 149.410993, 656.262907
Outstanding requests per worker:
267 326 254 346 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121226.5,      606133,     545846,      60287,     456728,      89118,   9.831581,  28.700000,  32.700000,  55.700000,  13.183314,   0.044000, 101.492003, 669.505273
Outstanding requests per worker:
285 306 301 281 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121200.5,      606003,     545428,      60575,     461110,      84318,  10.012878,  29.300000,  33.100000,  57.100000,  13.460452,   0.043000, 102.241002, 679.680656
Outstanding requests per worker:
325 286 326 322 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18032  2736 pts/0    Ss+  11:43   0:00 bash docker-ent
memcache     7  0.5  0.0  96552  6420 pts/0    S+   11:43   0:00 /usr/lib/linux-
memcache     8  135  0.0 281984 131228 pts/0   Sl+  11:43   1:00 memcached -t 2 
memcache    17  0.0  0.0  34424  2864 pts/1    Rs+  11:44   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       14927614831      instructions:u            #    0.61  insn per cycle         
       88522030876      instructions:k            #    0.61  insn per cycle         
      145197146533      cycles:k                                                    
       24474836118      cycles:u                                                    

      45.810035271 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 120000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 120000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 120000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 120000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 120000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 120000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 120000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 120000 cpus 4
meanInterarrival 33
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 1526744832
starting receive base loop
num_worker_connections 128
Creating worker on tid 423835392
starting receive base loop
num_worker_connections 128
Creating worker on tid 3613013760
starting receive base loop
Created 512 connections total
Creating worker on tid 2505078528
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575375057.373482,       0.0,      275419,     248081,      27338,     162954,      85127,  29.184589, 101.600000, 120.800000, 160.200000,  43.752108,   0.000000, 254.583001, 470.188011
Outstanding requests per worker:
954 848 1031 805 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121742.9,      608715,     548250,      60465,     407451,     140799,  12.887325,  36.500000,  53.700000,  94.700000,  20.072437,   0.044000, 176.133007, 566.906349
Outstanding requests per worker:
258 261 272 246 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121205.1,      606026,     545427,      60599,     427618,     117809,   9.080544,  26.300000,  31.700000,  50.600000,  12.268272,   0.044000, 111.455999, 611.640984
Outstanding requests per worker:
286 275 284 254 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121257.3,      606287,     545968,      60319,     440969,     104999,   9.169239,  26.800000,  31.300000,  51.500000,  12.321543,   0.046000,  92.900999, 637.587595
Outstanding requests per worker:
222 229 251 219 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121176.5,      605883,     545519,      60364,     449313,      96206,  10.726272,  30.600000,  39.900000,  60.600000,  14.913269,   0.045000, 134.333000, 654.867348
Outstanding requests per worker:
273 299 258 300 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121214.7,      606074,     545120,      60954,     455241,      89879,   9.740904,  28.500000,  32.500000,  55.000000,  13.062940,   0.046000,  96.175998, 667.211759
Outstanding requests per worker:
301 282 279 301 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121222.9,      606115,     545441,      60674,     460796,      84645,   9.875981,  28.900000,  32.800000,  56.000000,  13.238794,   0.045000,  98.816000, 678.836184
Outstanding requests per worker:
246 322 256 315 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18032  2860 pts/0    Ss+  11:44   0:00 bash docker-ent
memcache     7  0.4  0.0  96552  6472 pts/0    S+   11:44   0:00 /usr/lib/linux-
memcache     8  135  0.0 281984 129716 pts/0   Sl+  11:44   1:00 memcached -t 2 
memcache    18  0.0  0.0  34424  2812 pts/1    Rs+  11:45   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       14946798860      instructions:u            #    0.60  insn per cycle         
       88499003903      instructions:k            #    0.61  insn per cycle         
      144365039864      cycles:k                                                    
       24856473524      cycles:u                                                    

      45.768992150 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 122000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 122000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 122000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 122000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 122000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 122000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 122000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 122000 cpus 4
meanInterarrival 32
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 549783296
starting receive base loop
num_worker_connections 128
Creating worker on tid 3732715264
starting receive base loop
num_worker_connections 128
Creating worker on tid 2630416128
starting receive base loop
Created 512 connections total
Creating worker on tid 1521612544
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575375104.373529,       0.0,      286128,     257431,      28697,     169218,      88213,  11.736727,  33.900000,  49.000000,  91.100000,  19.188415,   0.000000, 199.760005, 472.030882
Outstanding requests per worker:
349 373 292 300 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  124915.5,      624578,     562131,      62447,     418517,     143614,  11.608445,  32.800000,  42.700000,  68.300000,  16.230495,   0.043000, 145.407006, 567.615675
Outstanding requests per worker:
516 430 403 439 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  124774.7,      623874,     561487,      62387,     442101,     119386,  12.598182,  34.700000,  48.300000,  84.000000,  18.374376,   0.043000, 170.669004, 614.659745
Outstanding requests per worker:
685 724 735 802 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  123679.5,      618398,     556548,      61850,     450673,     105875,  48.830214, 141.000000, 173.300000, 227.900000,  62.924688,   0.043000, 433.064014, 640.330750
Outstanding requests per worker:
2307 2457 2358 2476 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  123263.9,      616320,     554738,      61582,     457439,      97299, 105.714532, 274.400000, 313.800000, 394.500000, 119.486680,   0.044000, 637.319028, 656.744584
Outstanding requests per worker:
4722 4471 4590 4523 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  123414.9,      617075,     555587,      61488,     464970,      90617, 174.928052, 441.100000, 502.800000, 616.100000, 193.495823,   0.043000, 885.047972, 669.597251
Outstanding requests per worker:
6764 6577 6613 6325 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  123182.3,      615912,     554241,      61671,     469502,      84739, 239.847950, 602.500000, 685.600000, 841.100000, 264.163040,   0.043000, 1115.545034, 680.125314
Outstanding requests per worker:
8850 8470 8961 9118 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.4  0.0  18032  2884 pts/0    Ss+  11:45   0:00 bash docker-ent
memcache     7  0.5  0.0  96552  6464 pts/0    S+   11:45   0:00 /usr/lib/linux-
memcache     8  133  0.0 284032 138588 pts/0   Sl+  11:45   1:01 memcached -t 2 
memcache    17  0.0  0.0  34424  2808 pts/1    Rs+  11:46   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       15385453232      instructions:u            #    0.61  insn per cycle         
       89180975007      instructions:k            #    0.61  insn per cycle         
      146690007261      cycles:k                                                    
       25427010646      cycles:u                                                    

      45.813304679 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 124000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 124000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 124000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 124000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 124000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 124000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 124000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 124000 cpus 4
meanInterarrival 32
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 2860631808
starting receive base loop
num_worker_connections 128
Creating worker on tid 1758000896
starting receive base loop
num_worker_connections 128
Creating worker on tid 649197312
starting receive base loop
Created 512 connections total
Creating worker on tid 3836229376
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575375152.373577,       0.0,      279048,     251137,      27911,     164140,      86997,  42.786169, 144.800000, 170.300000, 205.300000,  62.263852,   0.000000, 302.727997, 468.419190
Outstanding requests per worker:
2126 2211 2054 2190 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  123476.3,      617382,     556049,      61333,     412627,     143422,  99.446438, 259.100000, 293.400000, 361.500000, 111.783218,   0.045000, 608.469009, 565.590245
Outstanding requests per worker:
4223 4171 3870 3981 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  123550.9,      617755,     555948,      61807,     437478,     118470, 152.861327, 381.600000, 437.900000, 536.200000, 168.769687,   0.044000, 827.941000, 614.734795
Outstanding requests per worker:
5896 5980 5698 5952 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  123257.1,      616286,     554692,      61594,     449112,     105580, 216.880145, 550.200000, 629.900000, 782.600000, 240.892359,   0.045000, 1057.978034, 638.915330
Outstanding requests per worker:
8211 7876 8177 8026 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  122079.7,      610399,     549269,      61130,     452906,      96363, 306.156883, 793.400000, 899.400000, 1074.100000, 343.450020,   0.045000, 1678.895950, 656.569546
Outstanding requests per worker:
11339 11886 12100 11598 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  122046.3,      610232,     549279,      60953,     459244,      90035, 421.593139, 1063.600000, 1177.900000, 1360.900000, 464.001038,   0.045000, 1857.784033, 668.506537
Outstanding requests per worker:
15380 15736 15568 15054 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121561.5,      607808,     546822,      60986,     462720,      84102, 543.182162, 1341.100000, 1463.100000, 1679.200000, 590.979642,   0.044000, 2305.372000, 679.004950
Outstanding requests per worker:
19798 20060 19993 19110 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.4  0.0  18032  2736 pts/0    Ss+  11:46   0:00 bash docker-ent
memcache     7  0.5  0.0  96552  6456 pts/0    S+   11:46   0:00 /usr/lib/linux-
memcache     8  133  0.0 283008 135356 pts/0   Sl+  11:46   1:01 memcached -t 2 
memcache    17  0.0  0.0  34424  2856 pts/1    Rs+  11:46   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       15188612941      instructions:u            #    0.60  insn per cycle         
       87672082948      instructions:k            #    0.60  insn per cycle         
      146224825358      cycles:k                                                    
       25213731285      cycles:u                                                    

      45.948331362 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 126000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 126000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 126000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 126000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 126000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 126000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 126000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 126000 cpus 4
meanInterarrival 31
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 3411777280
starting receive base loop
num_worker_connections 128
Creating worker on tid 2302883584
starting receive base loop
num_worker_connections 128
Creating worker on tid 1197094656
starting receive base loop
Created 512 connections total
Creating worker on tid 89159424
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575375200.373625,       0.0,      285794,     257372,      28422,     168785,      88587,  50.460167, 169.700000, 195.000000, 245.700000,  73.045715,   0.000000, 373.820990, 470.500855
Outstanding requests per worker:
2634 2685 2953 2993 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  125518.3,      627592,     564814,      62778,     420419,     144395, 152.916828, 409.300000, 464.900000, 567.600000, 175.790496,   0.045000, 837.049007, 566.813547
Outstanding requests per worker:
7085 6964 7451 7398 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  124613.1,      623066,     560814,      62252,     441484,     119330, 292.457824, 752.700000, 845.400000, 1003.900000, 326.660290,   0.044000, 1287.317991, 614.769615
Outstanding requests per worker:
12349 12681 13152 12855 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  124077.9,      620390,     558451,      61939,     452575,     105876, 467.247752, 1162.600000, 1271.000000, 1471.800000, 512.200204,   0.045000, 1920.815945, 640.012399
Outstanding requests per worker:
18383 18712 19479 19291 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  123389.1,      616946,     555000,      61946,     458423,      96577, 662.001792, 1620.500000, 1751.300000, 2007.200000, 722.031089,   0.045000, 2392.076015, 657.302939
Outstanding requests per worker:
25363 25896 26524 26336 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  123270.5,      616353,     554877,      61476,     465108,      89769, 875.528732, 2088.800000, 2240.800000, 2517.500000, 944.483698,   0.047000, 2953.383923, 671.632396
Outstanding requests per worker:
32800 33014 33853 33327 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  122813.1,      614066,     552666,      61400,     467904,      84762, 1092.327387, 2575.000000, 2750.800000, 3064.900000, 1172.904061,   0.045000, 3424.884081, 679.583640
Outstanding requests per worker:
40435 40821 41784 41086 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.4  0.0  18032  2840 pts/0    Ss+  11:46   0:00 bash docker-ent
memcache     7  0.5  0.0  96552  6440 pts/0    S+   11:46   0:00 /usr/lib/linux-
memcache     8  137  0.0 285056 137720 pts/0   Sl+  11:46   1:01 memcached -t 2 
memcache    17  0.0  0.0  34424  2868 pts/1    Rs+  11:47   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       15318379798      instructions:u            #    0.61  insn per cycle         
       88997612098      instructions:k            #    0.60  insn per cycle         
      148069919648      cycles:k                                                    
       25223960560      cycles:u                                                    

      45.794707552 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 128000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 128000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 128000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 128000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 128000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 128000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 128000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 128000 cpus 4
meanInterarrival 31
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 3817924352
starting receive base loop
num_worker_connections 128
Creating worker on tid 2705889024
starting receive base loop
num_worker_connections 128
Creating worker on tid 1599747840
starting receive base loop
Created 512 connections total
Creating worker on tid 490944256
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575375248.373673,       0.0,      286103,     257429,      28674,     168757,      88672,  47.730917, 162.200000, 188.000000, 231.900000,  69.786386,   0.000000, 355.821997, 470.391347
Outstanding requests per worker:
3031 2736 2866 2698 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  125511.9,      627560,     564370,      63190,     420405,     143965, 153.634252, 405.500000, 466.700000, 584.000000, 177.207861,   0.045000, 946.564972, 568.577416
Outstanding requests per worker:
7547 7097 7378 6965 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  124396.9,      621985,     560113,      61872,     441276,     118837, 296.793568, 759.200000, 865.200000, 1051.600000, 333.737439,   0.045000, 1481.358051, 615.633183
Outstanding requests per worker:
13415 12967 13165 12647 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  123969.3,      619847,     557546,      62301,     452368,     105178, 477.011113, 1192.600000, 1313.500000, 1509.200000, 524.804693,   0.044000, 1923.074007, 641.656622
Outstanding requests per worker:
20056 19203 19503 18797 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  123110.9,      615555,     553837,      61718,     457231,      96606, 681.360650, 1668.500000, 1808.700000, 2074.000000, 745.587334,   0.046000, 2572.581053, 657.201399
Outstanding requests per worker:
27535 26819 26729 26114 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  122755.5,      613778,     552343,      61435,     462975,      89368, 903.396853, 2179.600000, 2337.100000, 2593.400000, 978.727003,   0.045000, 3169.516087, 671.571896
Outstanding requests per worker:
35387 34641 34844 33754 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  122547.9,      612740,     551518,      61222,     467333,      84185, 1135.622629, 2700.000000, 2860.700000, 3176.900000, 1224.889781,   0.044000, 3905.431986, 680.494483
Outstanding requests per worker:
43344 43077 42526 42138 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'7\r'
+ echo 'memcached pid is: 7'
memcached pid is: 7
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18032  2764 pts/0    Ss+  11:47   0:00 bash docker-ent
memcache     6  0.5  0.0  96552  6344 pts/0    S+   11:47   0:00 /usr/lib/linux-
memcache     7  138  0.0 284032 136788 pts/0   Sl+  11:47   1:02 memcached -t 2 
memcache    16  0.0  0.0  34424  2852 pts/1    Rs+  11:48   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       15302467925      instructions:u            #    0.59  insn per cycle         
       88804021379      instructions:k            #    0.60  insn per cycle         
      149151088494      cycles:k                                                    
       26076467854      cycles:u                                                    

      45.875847349 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 130000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 130000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 130000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 130000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 130000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 130000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 130000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 130000 cpus 4
meanInterarrival 30
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 613340928
starting receive base loop
num_worker_connections 128
Creating worker on tid 3803313920
starting receive base loop
num_worker_connections 128
Creating worker on tid 2697524992
starting receive base loop
Created 512 connections total
Creating worker on tid 1588721408
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575375296.373721,       0.0,      291099,     262006,      29093,     172591,      89415,  34.892347,  51.700000, 104.100000, 851.200000, 145.318335,   0.000000, 1975.178957, 474.395964
Outstanding requests per worker:
1479 1315 1440 10851 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  127698.5,      638493,     575338,      63155,     429222,     146116, 213.790191, 503.900000, 720.500000, 2088.800000, 377.347228,   0.045000, 2705.982924, 569.787516
Outstanding requests per worker:
8449 8845 9095 16918 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  126844.1,      634221,     570600,      63621,     449660,     120940, 417.747487, 1014.300000, 1259.000000, 2508.400000, 540.456450,   0.046000, 3259.999037, 616.158861
Outstanding requests per worker:
16375 16873 17146 25397 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  126290.7,      631454,     568377,      63077,     460768,     107609, 656.953774, 1585.300000, 1850.600000, 3039.900000, 771.785024,   0.044000, 3838.711023, 641.226153
Outstanding requests per worker:
24916 25945 25826 34366 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  125405.3,      627027,     564221,      62806,     466130,      98091, 918.351978, 2197.300000, 2469.900000, 3583.800000, 1040.802741,   0.045000, 4533.677101, 657.489147
Outstanding requests per worker:
34798 35745 35800 44394 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  125342.9,      626715,     564076,      62639,     472583,      91493, 1196.123075, 2792.200000, 3124.000000, 4226.400000, 1326.859423,   0.045000, 5194.425106, 670.667630
Outstanding requests per worker:
44559 45652 45810 54715 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  125177.1,      625886,     563491,      62395,     477303,      86188, 1476.480287, 3425.600000, 3771.900000, 4861.200000, 1624.231285,   0.045000, 5941.883087, 680.567862
Outstanding requests per worker:
54879 56209 55808 64659 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'7\r'
+ echo 'memcached pid is: 7'
memcached pid is: 7
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18032  2740 pts/0    Ss+  11:48   0:00 bash docker-ent
memcache     6  0.5  0.0  96552  6404 pts/0    S+   11:48   0:00 /usr/lib/linux-
memcache     7  138  0.0 285056 139076 pts/0   Sl+  11:48   1:02 memcached -t 2 
memcache    17  0.0  0.0  34424  2860 pts/1    Rs+  11:49   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       15559110768      instructions:u            #    0.60  insn per cycle         
       90744158089      instructions:k            #    0.60  insn per cycle         
      150920059304      cycles:k                                                    
       25900514541      cycles:u                                                    

      45.921659149 seconds time elapsed

+ for threads in '$THREADS'
+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 104000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 104000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 104000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 104000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 104000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 104000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 104000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 104000 cpus 8
meanInterarrival 76
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 2333075200
starting receive base loop
num_worker_connections 64
Creating worker on tid 1741805312
starting receive base loop
num_worker_connections 64
Creating worker on tid 1145927424
starting receive base loop
num_worker_connections 64
Creating worker on tid 549959424
starting receive base loop
num_worker_connections 64
Creating worker on tid 4248958720
starting receive base loop
num_worker_connections 64
Creating worker on tid 3656005376
starting receive base loop
num_worker_connections 64
Creating worker on tid 3060037376
starting receive base loop
Created 512 connections total
Creating worker on tid 2464069376
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575375344.373769,       0.0,      308352,     277410,      30942,     183420,      93990,   2.842269,  10.400000,  14.000000,  20.800000,   5.315935,   0.000000, 116.446003, 475.801882
Outstanding requests per worker:
46 45 58 29 47 47 50 72 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  105282.7,      526414,     473553,      52861,     352106,     121447,   3.879422,  12.100000,  14.800000,  19.200000,   5.245809,   0.024000,  32.359999, 566.495043
Outstanding requests per worker:
56 40 40 42 38 45 36 45 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  105260.7,      526304,     473893,      52411,     370064,     103829,   3.959372,  12.400000,  15.400000,  19.300000,   5.340683,   0.022000,  35.362002, 607.400966
Outstanding requests per worker:
49 59 45 71 52 39 34 48 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  105270.9,      526355,     473479,      52876,     380138,      93341,   3.666558,  11.400000,  14.600000,  17.800000,   4.916387,   0.023000,  22.166001, 632.140593
Outstanding requests per worker:
43 48 42 56 54 32 58 54 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  105259.9,      526300,     473600,      52700,     387224,      86376,   4.073544,  12.700000,  15.700000,  20.500000,   5.529007,   0.023000,  34.938000, 648.334552
Outstanding requests per worker:
54 44 56 52 78 48 55 46 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  105271.1,      526356,     473503,      52853,     392605,      80898,   3.806629,  11.900000,  14.900000,  18.300000,   5.067819,   0.023000,  23.523999, 661.154147
Outstanding requests per worker:
52 53 54 58 43 48 60 64 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  105264.7,      526324,     473861,      52463,     397499,      76362,   4.012445,  12.300000,  15.900000,  19.300000,   5.343677,   0.024000,  35.571001, 671.586104
Outstanding requests per worker:
64 44 60 69 64 50 50 59 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'7\r'
+ echo 'memcached pid is: 7'
memcached pid is: 7
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18032  2844 pts/0    Ss+  11:49   0:00 bash docker-ent
memcache     6  0.4  0.0  96552  6464 pts/0    S+   11:49   0:00 /usr/lib/linux-
memcache     7  131  0.0 272768 119788 pts/0   Sl+  11:49   1:00 memcached -t 2 
memcache    16  0.0  0.0  34424  2852 pts/1    Rs+  11:50   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       13364355844      instructions:u            #    0.57  insn per cycle         
       84072773227      instructions:k            #    0.59  insn per cycle         
      143084825761      cycles:k                                                    
       23612322612      cycles:u                                                    

      46.792619291 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 106000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 106000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 106000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 106000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 106000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 106000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 106000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 106000 cpus 8
meanInterarrival 75
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 3290932992
starting receive base loop
num_worker_connections 64
Creating worker on tid 2697443072
starting receive base loop
num_worker_connections 64
Creating worker on tid 2101475072
starting receive base loop
num_worker_connections 64
Creating worker on tid 1508521728
starting receive base loop
num_worker_connections 64
Creating worker on tid 912553728
starting receive base loop
num_worker_connections 64
Creating worker on tid 316585728
starting receive base loop
num_worker_connections 64
Creating worker on tid 4015585024
starting receive base loop
Created 512 connections total
Creating worker on tid 3423581952
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575375393.373818,       0.0,      312240,     281107,      31133,     186389,      94718,   3.133725,  11.500000,  15.800000,  23.600000,   5.964292,   0.000000, 163.032994, 477.759259
Outstanding requests per worker:
83 57 51 60 54 62 64 52 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  106689.7,      533449,     479992,      53457,     356281,     123711,   4.243452,  13.100000,  16.800000,  20.900000,   5.730568,   0.023000,  31.004000, 565.059188
Outstanding requests per worker:
43 51 49 46 59 46 63 59 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  106665.3,      533327,     480225,      53102,     375332,     104893,   4.530297,  13.700000,  18.000000,  22.700000,   6.123930,   0.023000,  34.565002, 608.751664
Outstanding requests per worker:
63 78 58 64 55 54 48 49 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  106654.9,      533275,     480006,      53269,     386288,      93718,   4.453902,  13.400000,  17.900000,  22.200000,   5.997845,   0.023000,  27.632000, 633.891695
Outstanding requests per worker:
77 60 59 71 74 78 67 70 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  106682.9,      533415,     480030,      53385,     393123,      86907,   5.106906,  15.200000,  20.100000,  26.200000,   6.962510,   0.023000,  47.504999, 649.700898
Outstanding requests per worker:
62 60 63 69 55 64 63 57 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  106671.1,      533356,     479741,      53615,     398762,      80979,   4.478731,  13.600000,  18.100000,  23.800000,   6.165173,   0.023000,  31.087000, 663.766111
Outstanding requests per worker:
68 51 77 59 77 60 63 59 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  106665.9,      533330,     479774,      53556,     402862,      76912,   4.579135,  13.700000,  18.400000,  23.000000,   6.180855,   0.023000,  28.091000, 672.256381
Outstanding requests per worker:
64 73 65 72 68 77 67 70 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18032  2764 pts/0    Ss+  11:50   0:00 bash docker-ent
memcache     7  0.4  0.0  96552  6416 pts/0    S+   11:50   0:00 /usr/lib/linux-
memcache     8  127  0.0 274816 121972 pts/0   Sl+  11:50   1:00 memcached -t 2 
memcache    17  0.0  0.0  34424  2916 pts/1    Rs+  11:50   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       13494808957      instructions:u            #    0.60  insn per cycle         
       84777456235      instructions:k            #    0.60  insn per cycle         
      142406036525      cycles:k                                                    
       22555899356      cycles:u                                                    

      46.777864955 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 108000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 108000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 108000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 108000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 108000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 108000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 108000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 108000 cpus 8
meanInterarrival 74
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 2431903488
starting receive base loop
num_worker_connections 64
Creating worker on tid 1840633600
starting receive base loop
num_worker_connections 64
Creating worker on tid 1248098048
starting receive base loop
num_worker_connections 64
Creating worker on tid 652130048
starting receive base loop
num_worker_connections 64
Creating worker on tid 56162048
starting receive base loop
num_worker_connections 64
Creating worker on tid 3755161344
starting receive base loop
num_worker_connections 64
Creating worker on tid 3159193344
starting receive base loop
Created 512 connections total
Creating worker on tid 2563225344
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575375442.373867,       0.0,      320202,     288225,      31977,     190834,      97391,   3.180840,  11.800000,  16.600000,  26.500000,   6.124983,   0.000000, 108.250000, 476.966040
Outstanding requests per worker:
69 52 68 69 69 80 71 91 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108115.7,      540579,     486513,      54066,     362669,     123844,   4.872252,  14.500000,  19.400000,  24.800000,   6.604859,   0.024000,  38.362999, 569.118231
Outstanding requests per worker:
93 72 63 78 85 54 55 81 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108122.1,      540611,     486317,      54294,     380175,     106142,   5.060498,  15.100000,  20.000000,  26.000000,   6.906580,   0.023000,  41.459002, 609.442703
Outstanding requests per worker:
81 63 66 72 65 59 80 69 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108130.9,      540655,     486843,      53812,     391525,      95318,   5.014698,  14.800000,  20.100000,  26.100000,   6.826710,   0.023000,  31.713001, 633.293497
Outstanding requests per worker:
61 64 45 57 56 56 61 72 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108105.7,      540529,     486582,      53947,     398635,      87947,   4.966188,  14.700000,  19.800000,  25.500000,   6.721105,   0.023000,  32.758001, 650.035137
Outstanding requests per worker:
68 61 62 83 60 59 63 56 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108105.1,      540526,     486592,      53934,     404662,      81930,   5.067096,  14.900000,  20.300000,  26.100000,   6.864050,   0.023000,  32.928001, 663.444239
Outstanding requests per worker:
66 74 63 73 86 72 59 84 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108121.3,      540607,     486592,      54015,     408942,      77650,   5.605895,  16.600000,  22.400000,  29.100000,   7.770133,   0.023000,  63.914001, 673.192360
Outstanding requests per worker:
72 66 69 66 81 69 54 70 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'9\r'
+ echo 'memcached pid is: 9'
memcached pid is: 9
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18032  2864 pts/0    Ss+  11:50   0:00 bash docker-ent
memcache     8  0.3  0.0  96552  6320 pts/0    S+   11:50   0:00 /usr/lib/linux-
memcache     9  132  0.0 274816 122352 pts/0   Sl+  11:50   1:00 memcached -t 2 
memcache    18  0.0  0.0  34424  2796 pts/1    Rs+  11:51   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       13649414931      instructions:u            #    0.57  insn per cycle         
       85473428360      instructions:k            #    0.59  insn per cycle         
      143802924695      cycles:k                                                    
       23944190334      cycles:u                                                    

      46.829533927 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 110000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 110000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 110000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 110000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 110000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 110000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 110000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 110000 cpus 8
meanInterarrival 72
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 1645188864
starting receive base loop
num_worker_connections 64
Creating worker on tid 1054783232
starting receive base loop
num_worker_connections 64
Creating worker on tid 458815232
starting receive base loop
num_worker_connections 64
Creating worker on tid 4157814528
starting receive base loop
num_worker_connections 64
Creating worker on tid 3561846528
starting receive base loop
num_worker_connections 64
Creating worker on tid 2965878528
starting receive base loop
num_worker_connections 64
Creating worker on tid 2369910528
starting receive base loop
Created 512 connections total
Creating worker on tid 1777907456
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575375491.373916,       0.0,      328008,     295309,      32699,     195735,      99574,   3.753152,  13.800000,  19.000000,  28.600000,   6.996090,   0.000000, 157.986999, 478.866841
Outstanding requests per worker:
76 92 60 64 53 73 62 62 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  111103.1,      555516,     499961,      55555,     372734,     127227,   5.219793,  15.300000,  20.600000,  27.200000,   7.071705,   0.023000,  37.310999, 569.850050
Outstanding requests per worker:
88 86 84 68 68 72 87 75 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  111113.7,      555569,     500124,      55445,     391997,     108127,   5.379510,  15.700000,  21.400000,  27.900000,   7.330080,   0.024000,  43.806002, 611.380796
Outstanding requests per worker:
69 70 89 75 94 87 89 87 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  111104.3,      555522,     500424,      55098,     403743,      96681,   5.918891,  17.400000,  23.800000,  31.200000,   8.238026,   0.023000,  80.737002, 635.938274
Outstanding requests per worker:
92 73 91 105 88 88 83 102 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  111122.3,      555612,     500047,      55565,     410765,      89282,   5.915438,  17.200000,  23.200000,  31.500000,   8.061296,   0.023000,  40.010002, 652.047342
Outstanding requests per worker:
91 83 96 74 75 107 91 85 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  111134.7,      555674,     499871,      55803,     416609,      83262,   6.028502,  17.500000,  23.500000,  32.200000,   8.205006,   0.023000,  38.637999, 665.443194
Outstanding requests per worker:
89 72 66 84 77 66 77 101 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  111102.3,      555512,     500074,      55438,     421207,      78867,   6.150678,  17.800000,  23.700000,  32.800000,   8.362563,   0.024000,  41.924998, 675.745692
Outstanding requests per worker:
101 105 91 88 79 77 81 83 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'7\r'
+ echo 'memcached pid is: 7'
memcached pid is: 7
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18032  2768 pts/0    Ss+  11:51   0:00 bash docker-ent
memcache     6  0.3  0.0  96552  6504 pts/0    S+   11:51   0:00 /usr/lib/linux-
memcache     7  132  0.0 276864 124164 pts/0   Sl+  11:51   1:00 memcached -t 2 
memcache    17  0.0  0.0  34424  2872 pts/1    Rs+  11:52   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       14012985496      instructions:u            #    0.59  insn per cycle         
       86834934185      instructions:k            #    0.60  insn per cycle         
      143677817079      cycles:k                                                    
       23594200874      cycles:u                                                    

      46.921813802 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 112000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 112000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 112000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 112000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 112000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 112000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 112000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 112000 cpus 8
meanInterarrival 71
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 3408877312
starting receive base loop
num_worker_connections 64
Creating worker on tid 2815637248
starting receive base loop
num_worker_connections 64
Creating worker on tid 2219669248
starting receive base loop
num_worker_connections 64
Creating worker on tid 1623701248
starting receive base loop
num_worker_connections 64
Creating worker on tid 1024419584
starting receive base loop
num_worker_connections 64
Creating worker on tid 434779904
starting receive base loop
num_worker_connections 64
Creating worker on tid 4133779200
starting receive base loop
Created 512 connections total
Creating worker on tid 3537811200
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575375540.373965,       0.0,      330338,     297040,      33298,     197185,      99855,   5.112147,  18.600000,  25.600000,  38.400000,   9.818045,   0.000000, 244.992003, 479.687214
Outstanding requests per worker:
105 78 82 94 85 97 89 102 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  112702.1,      563511,     507276,      56235,     378502,     128774,   6.470255,  18.800000,  25.000000,  34.700000,   8.864472,   0.023000,  58.425002, 570.110932
Outstanding requests per worker:
84 78 90 76 78 84 92 75 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  112653.9,      563270,     507058,      56212,     397913,     109145,   6.834992,  20.000000,  26.000000,  37.400000,   9.414327,   0.023000,  84.942997, 612.373833
Outstanding requests per worker:
102 116 88 98 89 122 80 117 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  112621.9,      563110,     507029,      56081,     409032,      97997,   7.377682,  21.500000,  28.100000,  40.100000,  10.160773,   0.023000,  99.509001, 636.511823
Outstanding requests per worker:
142 154 122 135 153 136 133 140 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  112748.9,      563745,     507072,      56673,     416744,      90328,   7.077946,  20.700000,  26.600000,  38.800000,   9.736504,   0.023000,  75.680003, 652.933923
Outstanding requests per worker:
82 106 89 86 89 110 104 115 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  112677.1,      563386,     506769,      56617,     422132,      84637,   7.054204,  20.600000,  25.900000,  38.800000,   9.665493,   0.023000,  71.529999, 665.298769
Outstanding requests per worker:
123 70 100 115 101 106 114 101 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  112663.3,      563317,     506945,      56372,     427365,      79580,   7.432841,  21.800000,  27.000000,  41.400000,  10.192677,   0.024000,  76.284997, 676.105041
Outstanding requests per worker:
110 156 115 112 108 110 102 109 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'7\r'
+ echo 'memcached pid is: 7'
memcached pid is: 7
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18032  2880 pts/0    Ss+  11:52   0:00 bash docker-ent
memcache     6  0.4  0.0  96552  6384 pts/0    S+   11:52   0:00 /usr/lib/linux-
memcache     7  133  0.0 277888 125196 pts/0   Sl+  11:52   1:01 memcached -t 2 
memcache    16  0.0  0.0  34424  2868 pts/1    Rs+  11:53   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       14212859654      instructions:u            #    0.59  insn per cycle         
       87009121923      instructions:k            #    0.60  insn per cycle         
      145586163430      cycles:k                                                    
       23978405257      cycles:u                                                    

      46.767582236 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 114000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 114000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 114000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 114000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 114000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 114000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 114000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 114000 cpus 8
meanInterarrival 70
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 3772335872
starting receive base loop
num_worker_connections 64
Creating worker on tid 3183228672
starting receive base loop
num_worker_connections 64
Creating worker on tid 2590275328
starting receive base loop
num_worker_connections 64
Creating worker on tid 1994307328
starting receive base loop
num_worker_connections 64
Creating worker on tid 1398339328
starting receive base loop
num_worker_connections 64
Creating worker on tid 802371328
starting receive base loop
num_worker_connections 64
Creating worker on tid 206403328
starting receive base loop
Created 512 connections total
Creating worker on tid 3902088960
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575375588.374013,       0.0,      335082,     301486,      33596,     199958,     101528,   5.175850,  18.800000,  25.500000,  38.500000,  10.418927,   0.000000, 297.821999, 478.990713
Outstanding requests per worker:
119 106 115 116 121 89 128 124 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114311.7,      571559,     514558,      57001,     384958,     129600,   6.875922,  20.200000,  26.100000,  37.900000,   9.471653,   0.023000,  87.182999, 571.959043
Outstanding requests per worker:
133 87 107 105 95 91 112 103 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114315.9,      571580,     514855,      56725,     404732,     110123,   6.753855,  19.800000,  24.900000,  37.200000,   9.225595,   0.023000,  63.479997, 613.168430
Outstanding requests per worker:
92 94 75 87 91 84 96 101 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114284.5,      571423,     514128,      57295,     414943,      99185,   7.639794,  22.400000,  29.200000,  41.600000,  10.579265,   0.024000,  91.578998, 637.318384
Outstanding requests per worker:
102 107 74 102 119 86 89 81 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114264.3,      571322,     514106,      57216,     422951,      91155,   7.923526,  23.300000,  28.000000,  44.600000,  10.822746,   0.023000,  77.795997, 654.092269
Outstanding requests per worker:
100 114 136 101 101 118 110 113 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114305.1,      571526,     514124,      57402,     428890,      85234,   7.773001,  22.800000,  27.800000,  43.400000,  10.634823,   0.023000,  75.548999, 666.698133
Outstanding requests per worker:
97 96 105 105 98 116 105 112 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114269.7,      571349,     514461,      56888,     433953,      80508,   8.552106,  25.700000,  31.600000,  49.600000,  12.011432,   0.023000, 114.754997, 676.700922
Outstanding requests per worker:
122 116 132 108 102 120 106 135 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18032  2736 pts/0    Ss+  11:53   0:00 bash docker-ent
memcache     7  0.4  0.0  96552  6432 pts/0    S+   11:53   0:00 /usr/lib/linux-
memcache     8  129  0.0 279936 126680 pts/0   Sl+  11:53   1:01 memcached -t 2 
memcache    18  0.0  0.0  34424  2820 pts/1    Rs+  11:54   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       14348450155      instructions:u            #    0.60  insn per cycle         
       87747631335      instructions:k            #    0.61  insn per cycle         
      144791005607      cycles:k                                                    
       23828711955      cycles:u                                                    

      46.819538827 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 116000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 116000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 116000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 116000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 116000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 116000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 116000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 116000 cpus 8
meanInterarrival 68
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 4158240512
starting receive base loop
num_worker_connections 64
Creating worker on tid 3566970624
starting receive base loop
num_worker_connections 64
Creating worker on tid 2967688960
starting receive base loop
num_worker_connections 64
Creating worker on tid 2377922304
starting receive base loop
num_worker_connections 64
Creating worker on tid 1784968960
starting receive base loop
num_worker_connections 64
Creating worker on tid 1189000960
starting receive base loop
num_worker_connections 64
Creating worker on tid 593032960
starting receive base loop
Created 512 connections total
Creating worker on tid 4292032256
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575375637.374062,       0.0,      346324,     311400,      34924,     208548,     102852,   5.548643,  20.100000,  27.400000,  42.200000,  10.614921,   0.000000, 263.779014, 485.243131
Outstanding requests per worker:
91 74 76 90 93 83 91 101 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117631.5,      588158,     529217,      58941,     397442,     131775,   7.231015,  21.200000,  27.000000,  39.700000,   9.953909,   0.024000,  95.360003, 574.986280
Outstanding requests per worker:
71 69 96 106 125 94 114 150 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117636.1,      588181,     529716,      58465,     417083,     112633,   8.248013,  24.300000,  29.500000,  46.200000,  11.284317,   0.023000,  90.590000, 615.027164
Outstanding requests per worker:
103 118 104 116 102 104 142 134 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117603.7,      588019,     529486,      58533,     428230,     101256,   8.464311,  24.800000,  30.600000,  47.300000,  11.662272,   0.024000, 110.795997, 639.317676
Outstanding requests per worker:
203 148 152 127 155 140 110 132 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117659.7,      588299,     529219,      59080,     436535,      92684,   8.940523,  26.400000,  30.500000,  51.000000,  12.191845,   0.023000,  93.020000, 655.904486
Outstanding requests per worker:
135 161 154 141 133 125 128 154 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117654.7,      588274,     529676,      58598,     442751,      86925,   9.600973,  28.300000,  33.400000,  54.500000,  13.144146,   0.024000, 110.385001, 668.974887
Outstanding requests per worker:
157 146 125 119 153 117 160 160 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117640.7,      588204,     529438,      58766,     447189,      82249,   8.912044,  26.700000,  30.900000,  51.800000,  12.270185,   0.023000,  92.557997, 678.291970
Outstanding requests per worker:
149 170 139 178 149 165 122 121 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'7\r'
+ echo 'memcached pid is: 7'
memcached pid is: 7
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.4  0.0  18032  2856 pts/0    Ss+  11:54   0:00 bash docker-ent
memcache     6  0.3  0.0  96552  6516 pts/0    S+   11:54   0:00 /usr/lib/linux-
memcache     7  130  0.0 283008 130424 pts/0   Sl+  11:54   1:01 memcached -t 2 
memcache    16 18.0  0.0  34424  2852 pts/1    Rs+  11:54   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       14698345665      instructions:u            #    0.60  insn per cycle         
       89392450200      instructions:k            #    0.61  insn per cycle         
      146043791161      cycles:k                                                    
       24366744619      cycles:u                                                    

      46.875718003 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 118000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 118000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 118000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 118000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 118000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 118000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 118000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 118000 cpus 8
meanInterarrival 67
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 3875239680
starting receive base loop
num_worker_connections 64
Creating worker on tid 3283969792
starting receive base loop
num_worker_connections 64
Creating worker on tid 2689431296
starting receive base loop
num_worker_connections 64
Creating worker on tid 2093463296
starting receive base loop
num_worker_connections 64
Creating worker on tid 1497495296
starting receive base loop
num_worker_connections 64
Creating worker on tid 904541952
starting receive base loop
num_worker_connections 64
Creating worker on tid 308573952
starting receive base loop
Created 512 connections total
Creating worker on tid 4007573248
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575375686.374111,       0.0,      352471,     317291,      35180,     211755,     105536,   6.883568,  26.200000,  32.700000,  55.900000,  13.363902,   0.000000, 266.445994, 482.912629
Outstanding requests per worker:
153 165 159 147 158 130 135 154 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  119412.9,      597065,     537625,      59440,     403888,     133737,  10.492949,  31.000000,  36.400000,  60.500000,  14.454188,   0.024000, 127.357006, 574.750492
Outstanding requests per worker:
159 139 133 193 166 141 145 141 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  119411.3,      597057,     537225,      59832,     423958,     113267,  11.018012,  32.300000,  39.100000,  63.300000,  15.303030,   0.024000, 135.381997, 617.100665
Outstanding requests per worker:
170 156 137 148 147 185 146 142 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  119119.5,      595598,     535888,      59710,     434120,     101768,  12.075106,  33.900000,  46.700000,  77.100000,  17.820286,   0.023000, 172.942996, 639.321160
Outstanding requests per worker:
376 319 358 266 433 282 348 301 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117900.5,      589503,     530174,      59329,     437334,      92840,  53.012221, 155.000000, 187.200000, 239.100000,  67.832526,   0.024000, 440.425992, 656.642610
Outstanding requests per worker:
1295 1363 1246 1143 1229 1473 1186 1298 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  118209.7,      591049,     531928,      59121,     445016,      86912, 110.101537, 281.600000, 314.000000, 385.400000, 122.117844,   0.024000, 633.388996, 668.917991
Outstanding requests per worker:
1890 1969 2175 2050 2031 2134 1952 2054 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  118336.3,      591682,     532321,      59361,     450206,      82115, 157.377638, 392.700000, 448.100000, 550.100000, 173.001092,   0.023000, 791.426003, 678.822754
Outstanding requests per worker:
2570 2628 2592 2662 2629 2887 2939 2716 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'7\r'
+ echo 'memcached pid is: 7'
memcached pid is: 7
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18032  2848 pts/0    Ss+  11:54   0:00 bash docker-ent
memcache     6  0.5  0.0  96552  6340 pts/0    S+   11:54   0:00 /usr/lib/linux-
memcache     7  135  0.0 281984 134568 pts/0   Sl+  11:54   1:02 memcached -t 2 
memcache    16  0.0  0.0  34424  2860 pts/1    Rs+  11:55   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       15029647641      instructions:u            #    0.60  insn per cycle         
       88745094267      instructions:k            #    0.59  insn per cycle         
      149171347853      cycles:k                                                    
       25110132359      cycles:u                                                    

      46.800295981 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 120000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 120000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 120000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 120000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 120000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 120000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 120000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 120000 cpus 8
meanInterarrival 66
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 2510894848
starting receive base loop
num_worker_connections 64
Creating worker on tid 1911613184
starting receive base loop
num_worker_connections 64
Creating worker on tid 1323218688
starting receive base loop
num_worker_connections 64
Creating worker on tid 727250688
starting receive base loop
num_worker_connections 64
Creating worker on tid 131282688
starting receive base loop
num_worker_connections 64
Creating worker on tid 3830281984
starting receive base loop
num_worker_connections 64
Creating worker on tid 3231000320
starting receive base loop
Created 512 connections total
Creating worker on tid 2638345984
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575375735.374160,       0.0,      352396,     316822,      35574,     212382,     104440,  16.668357,  63.000000,  94.700000, 130.700000,  33.513743,   0.000000, 446.251005, 485.118221
Outstanding requests per worker:
620 633 526 659 614 621 612 522 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121725.9,      608630,     547968,      60662,     410943,     137025,  27.873460, 104.800000, 136.400000, 189.000000,  46.248685,   0.023000, 345.945001, 573.824756
Outstanding requests per worker:
276 282 327 240 332 305 255 275 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  119134.5,      595673,     536077,      59596,     422722,     113355,  53.477828, 164.400000, 204.300000, 278.600000,  73.009641,   0.024000, 445.674986, 616.369156
Outstanding requests per worker:
1612 1580 1577 1659 1489 1606 1537 1666 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  119221.5,      596108,     536754,      59354,     434520,     102234, 142.850622, 365.300000, 419.100000, 531.600000, 160.890994,   0.023000, 783.064008, 639.193377
Outstanding requests per worker:
2891 2819 2855 2899 2683 2851 3015 2702 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  118597.1,      592986,     533514,      59472,     439676,      93838, 233.837435, 593.000000, 677.300000, 849.300000, 261.019914,   0.023000, 1257.542014, 655.998583
Outstanding requests per worker:
4437 4525 4520 4664 4582 4284 4466 4346 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  118021.7,      590109,     531317,      58792,     444894,      86423, 354.947788, 901.600000, 1014.500000, 1197.400000, 393.404289,   0.023000, 1533.524990, 669.489945
Outstanding requests per worker:
6471 6823 6579 6531 6681 5989 6241 6506 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  118335.5,      591678,     532372,      59306,     449877,      82495, 472.851318, 1179.100000, 1302.100000, 1534.700000, 517.686831,   0.023000, 1971.577048, 678.674650
Outstanding requests per worker:
8364 8596 8272 8287 8552 7727 8124 8327 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18032  2876 pts/0    Ss+  11:55   0:00 bash docker-ent
memcache     7  0.3  0.0  96552  6324 pts/0    S+   11:55   0:00 /usr/lib/linux-
memcache     8  135  0.0 283008 136868 pts/0   Sl+  11:55   1:02 memcached -t 2 
memcache    18  0.0  0.0  34424  2816 pts/1    Rs+  11:56   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       15031941273      instructions:u            #    0.60  insn per cycle         
       88661820563      instructions:k            #    0.60  insn per cycle         
      148596265919      cycles:k                                                    
       25209550310      cycles:u                                                    

      46.836802050 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 122000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 122000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 122000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 122000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 122000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 122000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 122000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 122000 cpus 8
meanInterarrival 65
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 3822315264
starting receive base loop
num_worker_connections 64
Creating worker on tid 3223033600
starting receive base loop
num_worker_connections 64
Creating worker on tid 2630334208
starting receive base loop
num_worker_connections 64
Creating worker on tid 2034366208
starting receive base loop
num_worker_connections 64
Creating worker on tid 1441412864
starting receive base loop
num_worker_connections 64
Creating worker on tid 845444864
starting receive base loop
num_worker_connections 64
Creating worker on tid 249476864
starting receive base loop
Created 512 connections total
Creating worker on tid 3948476160
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575375783.374208,       0.0,      354722,     319297,      35425,     212722,     106575,  21.405026,  87.700000, 116.300000, 171.100000,  43.500298,   0.000000, 581.192017, 483.065181
Outstanding requests per worker:
849 874 872 822 811 859 896 868 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  124007.1,      620036,     558015,      62021,     418971,     139044,  78.354491, 231.400000, 276.900000, 351.300000, 100.541163,   0.024000, 557.918012, 574.217220
Outstanding requests per worker:
356 281 274 318 236 270 272 247 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  116325.3,      581627,     523646,      57981,     413026,     110620, 144.086655, 285.600000, 322.800000, 395.400000,  98.953357,   0.035000, 598.725021, 616.437618
Outstanding requests per worker:
4442 4505 4431 4512 4570 4575 4475 4572 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  118363.1,      591816,     532575,      59241,     431404,     101171, 407.621470, 580.700000, 643.600000, 768.500000, 128.822596,  38.849998, 1073.204041, 640.093146
Outstanding requests per worker:
7407 7384 7439 7110 7729 7586 7693 7332 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  133678.1,      668391,     601501,      66890,     497197,     104304, 300.437907, 722.800000, 815.300000, 973.400000, 299.663729,   0.024000, 1240.172029, 658.270922
Outstanding requests per worker:
688 809 918 649 1145 927 791 785 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  120667.3,      603337,     543297,      60040,     455578,      87719,  92.072673, 267.600000, 313.600000, 397.000000, 114.094374,   0.023000, 576.894999, 671.614583
Outstanding requests per worker:
2096 2535 2286 2474 2325 2456 2399 2242 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  115391.7,      576959,     519090,      57869,     440158,      78932, 307.365388, 549.500000, 625.200000, 762.900000, 181.898960,   0.026000, 1117.916942, 681.847818
Outstanding requests per worker:
6990 7220 7291 7138 7018 7164 7363 7109 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.4  0.0  18032  2736 pts/0    Ss+  11:56   0:00 bash docker-ent
memcache     7  0.3  0.0  96552  6320 pts/0    S+   11:56   0:00 /usr/lib/linux-
memcache     8  137  0.0 283008 142984 pts/0   Sl+  11:56   1:04 memcached -t 2 
memcache    17  0.0  0.0  34424  2892 pts/1    Rs+  11:57   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       14956804092      instructions:u            #    0.58  insn per cycle         
       87512898024      instructions:k            #    0.56  insn per cycle         
      157148657130      cycles:k                                                    
       25763548194      cycles:u                                                    

      46.912533849 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 124000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 124000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 124000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 124000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 124000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 124000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 124000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 124000 cpus 8
meanInterarrival 64
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 1188845312
starting receive base loop
num_worker_connections 64
Creating worker on tid 593032960
starting receive base loop
num_worker_connections 64
Creating worker on tid 4292032256
starting receive base loop
num_worker_connections 64
Creating worker on tid 3696064256
starting receive base loop
num_worker_connections 64
Creating worker on tid 3100096256
starting receive base loop
num_worker_connections 64
Creating worker on tid 2504128256
starting receive base loop
num_worker_connections 64
Creating worker on tid 1911174912
starting receive base loop
Created 512 connections total
Creating worker on tid 1322186496
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575375832.374257,       0.0,      367084,     330209,      36875,     221100,     109109,   9.706565,  33.500000,  48.500000, 101.100000,  21.071177,   0.000000, 356.965005, 484.958775
Outstanding requests per worker:
269 254 315 240 288 253 285 283 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  122105.5,      610528,     549768,      60760,     413954,     135814,  72.035387, 223.000000, 271.600000, 346.000000,  96.054795,   0.022000, 523.244023, 576.246426
Outstanding requests per worker:
1989 1979 2140 2331 2072 2064 2086 2056 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  122068.3,      610342,     549341,      61001,     433788,     115553, 181.045342, 458.600000, 526.400000, 668.300000, 203.626312,   0.023000, 1069.393992, 617.032146
Outstanding requests per worker:
3781 3743 3781 4131 4075 3934 3937 4052 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121354.7,      606774,     545943,      60831,     442797,     103146, 313.331507, 789.700000, 882.400000, 1060.000000, 346.465612,   0.024000, 1562.283039, 641.074097
Outstanding requests per worker:
6138 6054 5956 6514 6450 6242 5998 6340 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121045.9,      605230,     544815,      60415,     449924,      94891, 447.228552, 1114.700000, 1224.000000, 1464.200000, 490.002399,   0.023000, 1881.754041, 657.471074
Outstanding requests per worker:
8729 8615 8609 8863 9015 8551 8441 8675 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  129724.3,      648622,     583839,      64783,     488996,      94843, 629.304407, 1451.000000, 1589.100000, 1858.100000, 622.613780,   0.024000, 2234.811068, 669.921319
Outstanding requests per worker:
5801 5770 5713 5687 6198 5514 5411 5834 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  127851.3,      639257,     575258,      63999,     487132,      88126, 197.325839, 480.000000, 565.000000, 780.000000, 210.934309,   0.024000, 1613.451958, 680.328152
Outstanding requests per worker:
3810 3959 3995 4139 3749 4105 4031 3929 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'7\r'
+ echo 'memcached pid is: 7'
memcached pid is: 7
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.4  0.0  18032  2856 pts/0    Ss+  11:57   0:00 bash docker-ent
memcache     6  0.4  0.0  96552  6512 pts/0    S+   11:57   0:00 /usr/lib/linux-
memcache     7  134  0.0 285056 145024 pts/0   Sl+  11:57   1:03 memcached -t 2 
memcache    17 19.0  0.0  34424  2788 pts/1    Rs+  11:58   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       15615978897      instructions:u            #    0.62  insn per cycle         
       91389334996      instructions:k            #    0.60  insn per cycle         
      151264272005      cycles:k                                                    
       25369440330      cycles:u                                                    

      46.917029101 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 126000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 126000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 126000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 126000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 126000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 126000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 126000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 126000 cpus 8
meanInterarrival 63
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 1225639680
starting receive base loop
num_worker_connections 64
Creating worker on tid 636106496
starting receive base loop
num_worker_connections 64
Creating worker on tid 40138496
starting receive base loop
num_worker_connections 64
Creating worker on tid 3739137792
starting receive base loop
num_worker_connections 64
Creating worker on tid 3143169792
starting receive base loop
num_worker_connections 64
Creating worker on tid 2547201792
starting receive base loop
num_worker_connections 64
Creating worker on tid 1947920128
starting receive base loop
Created 512 connections total
Creating worker on tid 1355265792
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575375881.374306,       0.0,      364403,     328256,      36147,     219372,     108884,  30.854389, 112.700000, 148.100000, 348.700000,  84.232639,   0.000000, 1182.608962, 484.482538
Outstanding requests per worker:
1133 1210 1268 1151 1093 1223 1293 2838 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  122139.9,      610700,     549761,      60939,     414238,     135523, 178.336818, 479.900000, 566.600000, 829.600000, 223.118035,   0.024000, 1677.091956, 577.474595
Outstanding requests per worker:
4052 4109 4373 4534 4231 4462 4143 5581 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121765.1,      608826,     547886,      60940,     433073,     114813, 362.120970, 926.900000, 1042.600000, 1310.400000, 411.818604,   0.024000, 2184.297085, 618.361597
Outstanding requests per worker:
7450 7415 7257 7808 7690 7673 7505 8834 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121616.9,      608085,     547182,      60903,     444114,     103068, 566.022872, 1401.300000, 1544.200000, 1864.100000, 625.247234,   0.023000, 2546.072960, 641.446365
Outstanding requests per worker:
10511 11268 10432 10965 11143 11182 11032 11974 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  120541.3,      602707,     542070,      60637,     447843,      94227, 780.295119, 1902.700000, 2053.300000, 2437.100000, 856.195603,   0.023000, 3365.550995, 657.682497
Outstanding requests per worker:
14384 15129 14408 14895 15347 15146 15073 16376 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  120724.7,      603624,     543280,      60344,     455077,      88203, 1015.288820, 2408.900000, 2585.800000, 3015.400000, 1099.326121,   0.024000, 3862.006903, 670.751993
Outstanding requests per worker:
18313 19207 18072 18547 19214 19154 19317 20280 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  120496.1,      602481,     541791,      60690,     458744,      83047, 1253.296783, 2953.600000, 3158.800000, 3596.300000, 1349.892055,   0.024000, 4403.865814, 680.123418
Outstanding requests per worker:
22217 23283 22028 22891 23471 23176 23253 24261 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'7\r'
+ echo 'memcached pid is: 7'
memcached pid is: 7
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18032  2864 pts/0    Ss+  11:58   0:00 bash docker-ent
memcache     6  0.5  0.0  96552  6468 pts/0    S+   11:58   0:00 /usr/lib/linux-
memcache     7  138  0.0 284032 137064 pts/0   Sl+  11:58   1:03 memcached -t 2 
memcache    16  0.0  0.0  34424  2908 pts/1    Rs+  11:58   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       15361572817      instructions:u            #    0.60  insn per cycle         
       89942899431      instructions:k            #    0.59  insn per cycle         
      152839158182      cycles:k                                                    
       25596521369      cycles:u                                                    

      46.855660596 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 128000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 128000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 128000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 128000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 128000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 128000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 128000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 128000 cpus 8
meanInterarrival 62
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 1650034432
starting receive base loop
num_worker_connections 64
Creating worker on tid 1054783232
starting receive base loop
num_worker_connections 64
Creating worker on tid 458815232
starting receive base loop
num_worker_connections 64
Creating worker on tid 4157814528
starting receive base loop
num_worker_connections 64
Creating worker on tid 3561846528
starting receive base loop
num_worker_connections 64
Creating worker on tid 2965878528
starting receive base loop
num_worker_connections 64
Creating worker on tid 2369910528
starting receive base loop
Created 512 connections total
Creating worker on tid 1776957184
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575375930.374355,       0.0,      365981,     329505,      36476,     220189,     109316,  35.134186, 144.300000, 183.200000, 264.800000,  68.960611,   0.000000, 654.680014, 484.998738
Outstanding requests per worker:
1676 1592 1646 1505 1516 1701 1647 1947 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  123466.1,      617331,     555877,      61454,     418299,     137578, 198.480081, 543.900000, 633.500000, 792.700000, 235.614948,   0.024000, 1147.637010, 576.092373
Outstanding requests per worker:
5252 5180 4850 4848 5026 5449 5113 5403 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  122297.5,      611488,     550193,      61295,     435073,     115120, 477.688970, 1070.000000, 1194.400000, 1398.400000, 419.199798,   0.025000, 1768.015981, 618.724787
Outstanding requests per worker:
9507 9565 9071 9237 9248 9659 9096 9465 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  122925.5,      614628,     553087,      61541,     448883,     104204, 673.333390, 1641.600000, 1778.800000, 2018.900000, 733.019278,   0.023000, 2469.578028, 641.742091
Outstanding requests per worker:
13354 12952 13011 13256 13037 13500 12821 13261 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  135268.1,      676341,     608656,      67685,     504090,     104566, 870.599362, 1907.100000, 2047.600000, 2318.900000, 808.758409,   0.024000, 2898.967981, 660.335337
Outstanding requests per worker:
9652 9045 9316 9247 9071 9452 8886 9619 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  134175.3,      670877,     603874,      67003,     507383,      96491, 335.297262, 751.700000, 868.000000, 1160.800000, 315.430757,   0.024000, 1983.212948, 673.171642
Outstanding requests per worker:
5970 6216 6051 5917 6506 6293 5794 5880 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  122540.1,      612701,     551513,      61188,     468776,      82737, 473.814175, 1199.000000, 1303.200000, 1468.100000, 524.500265,   0.024000, 1835.417986, 683.372698
Outstanding requests per worker:
10166 10367 10274 9816 10448 10031 10183 9842 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18032  2764 pts/0    Ss+  11:58   0:00 bash docker-ent
memcache     7  0.5  0.0  96552  6320 pts/0    S+   11:58   0:00 /usr/lib/linux-
memcache     8  139  0.0 288128 148760 pts/0   Sl+  11:58   1:04 memcached -t 2 
memcache    18  0.0  0.0  34424  2864 pts/1    Rs+  11:59   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       15846621487      instructions:u            #    0.61  insn per cycle         
       92155530417      instructions:k            #    0.60  insn per cycle         
      154471480128      cycles:k                                                    
       26040426301      cycles:u                                                    

      46.817367248 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 130000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 130000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 130000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,instructions:k,cycles:k,cycles:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,instructions:k,cycles:k,cycles:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 130000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 130000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 130000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 130000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 130000 cpus 8
meanInterarrival 61
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 1275156224
starting receive base loop
num_worker_connections 64
Creating worker on tid 684177152
starting receive base loop
num_worker_connections 64
Creating worker on tid 88209152
starting receive base loop
num_worker_connections 64
Creating worker on tid 3790223104
starting receive base loop
num_worker_connections 64
Creating worker on tid 3194255104
starting receive base loop
num_worker_connections 64
Creating worker on tid 2598287104
starting receive base loop
num_worker_connections 64
Creating worker on tid 2002319104
starting receive base loop
Created 512 connections total
Creating worker on tid 1406351104
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575375979.374404,       0.0,      370652,     333640,      37012,     223186,     110454,  31.107306,  89.200000, 133.100000, 613.500000, 116.152806,   0.000000, 1754.277945, 484.288485
Outstanding requests per worker:
1229 1271 1228 1177 1195 1185 1198 5725 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  125033.3,      625167,     562851,      62316,     424078,     138773, 213.677827, 564.800000, 683.800000, 1514.000000, 298.902749,   0.023000, 2286.057949, 577.307346
Outstanding requests per worker:
5203 5249 5070 5124 4963 5184 5047 9000 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  124294.9,      621475,     559552,      61923,     442220,     117332, 440.837197, 1115.500000, 1257.800000, 1924.100000, 516.317928,   0.023000, 2903.218985, 618.069288
Outstanding requests per worker:
9583 9737 9262 9380 9267 9453 9322 13151 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  124118.3,      620592,     558480,      62112,     454183,     104297, 696.815822, 1675.900000, 1838.200000, 2513.500000, 776.715095,   0.024000, 3610.299110, 643.278234
Outstanding requests per worker:
13889 13974 13603 13921 13836 13539 13691 17889 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  123825.5,      619128,     557024,      62104,     461386,      95638, 948.014232, 2249.700000, 2442.400000, 3062.000000, 1042.687737,   0.023000, 4154.675007, 660.297739
Outstanding requests per worker:
18178 18472 18333 18470 18716 18311 18080 22434 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  134020.9,      670105,     602629,      67476,     505706,      96923, 1294.427716, 2751.800000, 2952.500000, 3512.200000, 1232.610494,   0.024000, 4476.818085, 672.325618
Outstanding requests per worker:
16314 16617 16399 16785 17229 16230 16432 20689 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  130870.3,      654352,     588916,      65436,     499910,      89006, 1064.132163, 2461.300000, 2672.000000, 3216.400000, 1113.483572,   0.024000, 4002.589226, 682.457252
Outstanding requests per worker:
16341 16925 16550 17034 17498 16574 16615 20585 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'7\r'
+ echo 'memcached pid is: 7'
memcached pid is: 7
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18032  2844 pts/0    Ss+  11:59   0:00 bash docker-ent
memcache     6  0.4  0.0  96552  6520 pts/0    S+   11:59   0:00 /usr/lib/linux-
memcache     7  138  0.0 289152 147924 pts/0   Sl+  11:59   1:03 memcached -t 2 
memcache    16  0.0  0.0  34424  2872 pts/1    Rs+  12:00   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       16083797996      instructions:u            #    0.63  insn per cycle         
       93373979616      instructions:k            #    0.61  insn per cycle         
      153487952529      cycles:k                                                    
       25513317733      cycles:u                                                    

      46.804659604 seconds time elapsed

