+ for keys in '$KEYS'
+ for conns in '$CONNS'
+ for threads in '$THREADS'
+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 104000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 104000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 104000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,LLC-loads:u,LLC-load-misses:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,LLC-loads:u,LLC-load-misses:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,LLC-loads:u,LLC-load-misses:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,LLC-loads:u,LLC-load-misses:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 104000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 104000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 104000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 104000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 104000 cpus 4
meanInterarrival 38
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 1875212032
starting receive base loop
num_worker_connections 128
Creating worker on tid 767391488
starting receive base loop
num_worker_connections 128
Creating worker on tid 3956569856
starting receive base loop
Created 512 connections total
Creating worker on tid 2847766272
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575371970.370395,       0.0,      243127,     218776,      24351,     142109,      76667,   2.940684,   8.500000,  13.300000,  23.600000,   4.989363,   0.000000,  41.740000, 464.470330
Outstanding requests per worker:
55 67 46 64 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  105262.9,      526315,     473684,      52631,     348628,     125056,   2.314660,   6.900000,   8.000000,  10.800000,   2.906315,   0.032000,  17.344000, 558.471582
Outstanding requests per worker:
69 69 66 76 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  105271.9,      526360,     473853,      52507,     368305,     105548,   2.411075,   7.200000,   8.500000,  11.100000,   3.036402,   0.032000,  15.893999, 604.150247
Outstanding requests per worker:
60 72 54 78 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  105287.5,      526438,     473538,      52900,     379098,      94440,   2.441516,   7.400000,   8.600000,  10.500000,   3.024896,   0.033000,  14.564000, 629.421396
Outstanding requests per worker:
50 46 48 43 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  105254.9,      526275,     473484,      52791,     386397,      87087,   2.581605,   7.600000,   9.000000,  12.700000,   3.319103,   0.033000,  20.499000, 647.398102
Outstanding requests per worker:
77 61 59 57 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  105280.9,      526405,     473690,      52715,     392920,      80770,   2.505183,   7.700000,   8.900000,  10.600000,   3.118416,   0.033000,  13.258000, 661.786580
Outstanding requests per worker:
49 56 51 49 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  105249.5,      526248,     473483,      52765,     397444,      76039,   2.530299,   7.900000,   9.000000,  10.600000,   3.145883,   0.032000,  13.036000, 671.801663
Outstanding requests per worker:
78 82 79 62 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18032  2764 pts/0    Ss+  10:52   0:00 bash docker-ent
memcache     7  0.5  0.0  96652  6324 pts/0    S+   10:53   0:00 /usr/lib/linux-
memcache     8  130  0.0 272768 118612 pts/0   Sl+  10:53   0:58 memcached -t 2 
memcache    17  0.0  0.0  34424  2864 pts/1    Rs+  10:53   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       13116823646      instructions:u                                              
         156719597      LLC-loads                                                   
           3006140      LLC-load-misses           #    1.92% of all LL-cache hits   

      45.845240521 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 106000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 106000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 106000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,LLC-loads:u,LLC-load-misses:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,LLC-loads:u,LLC-load-misses:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,LLC-loads:u,LLC-load-misses:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,LLC-loads:u,LLC-load-misses:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 106000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 106000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 106000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 106000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 106000 cpus 4
meanInterarrival 37
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 1598883584
starting receive base loop
num_worker_connections 128
Creating worker on tid 490944256
starting receive base loop
num_worker_connections 128
Creating worker on tid 3680122624
starting receive base loop
Created 512 connections total
Creating worker on tid 2572187392
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575372018.370443,       0.0,      247669,     223007,      24662,     144848,      78159,   4.289131,  13.500000,  19.000000,  32.300000,   7.264208,   0.000000,  72.530001, 462.916160
Outstanding requests per worker:
72 85 75 85 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108106.1,      540531,     486681,      53850,     358355,     128326,   3.487932,  10.800000,  13.000000,  16.500000,   4.562446,   0.032000,  29.817000, 558.936221
Outstanding requests per worker:
84 100 110 83 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108103.3,      540517,     486296,      54221,     378971,     107325,   3.721017,  11.500000,  14.000000,  17.400000,   4.839227,   0.033000,  29.732000, 606.005645
Outstanding requests per worker:
105 100 113 119 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108130.1,      540651,     486070,      54581,     390206,      95864,   3.490830,  10.900000,  13.200000,  16.000000,   4.491865,   0.032000,  21.164000, 631.502434
Outstanding requests per worker:
80 100 112 79 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108104.5,      540523,     486346,      54177,     397916,      88430,   3.921709,  12.200000,  14.800000,  18.700000,   5.171897,   0.032000,  33.247001, 649.181755
Outstanding requests per worker:
95 106 104 112 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108096.5,      540483,     486088,      54395,     403712,      82376,   3.677854,  11.400000,  14.100000,  17.100000,   4.766049,   0.032000,  21.993000, 661.404211
Outstanding requests per worker:
134 130 119 138 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108139.9,      540700,     486849,      53851,     408702,      78147,   3.814395,  11.700000,  14.600000,  17.900000,   4.956473,   0.032000,  24.429001, 672.519541
Outstanding requests per worker:
90 83 115 107 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'7\r'
+ echo 'memcached pid is: 7'
memcached pid is: 7
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18032  2792 pts/0    Ss+  10:53   0:00 bash docker-ent
memcache     6  0.4  0.0  96652  6320 pts/0    S+   10:53   0:00 /usr/lib/linux-
memcache     7  131  0.0 273792 120032 pts/0   Sl+  10:53   0:59 memcached -t 2 
memcache    17  0.0  0.0  34424  2856 pts/1    Rs+  10:54   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       13426327505      instructions:u                                              
         159675148      LLC-loads                                                   
           2869705      LLC-load-misses           #    1.80% of all LL-cache hits   

      45.851484314 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 108000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 108000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 108000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,LLC-loads:u,LLC-load-misses:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,LLC-loads:u,LLC-load-misses:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,LLC-loads:u,LLC-load-misses:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,LLC-loads:u,LLC-load-misses:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 108000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 108000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 108000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 108000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 108000 cpus 4
meanInterarrival 37
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 2492794624
starting receive base loop
num_worker_connections 128
Creating worker on tid 1387394816
starting receive base loop
num_worker_connections 128
Creating worker on tid 281605888
starting receive base loop
Created 512 connections total
Creating worker on tid 3467769600
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575372065.370490,       0.0,      248953,     224105,      24848,     146061,      78044,   3.553561,  10.900000,  15.700000,  26.600000,   5.866463,   0.000000,  51.098000, 465.522585
Outstanding requests per worker:
90 100 76 92 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108133.1,      540666,     486407,      54259,     358992,     127415,   2.922691,   9.000000,  10.500000,  13.900000,   3.744791,   0.032000,  19.854000, 560.803545
Outstanding requests per worker:
76 69 54 76 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108096.3,      540482,     486472,      54010,     378550,     107922,   3.056186,   9.300000,  11.100000,  14.600000,   3.931780,   0.032000,  22.531999, 605.222000
Outstanding requests per worker:
93 84 88 97 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108123.7,      540619,     486625,      53994,     390603,      96022,   3.043924,   9.600000,  11.300000,  13.300000,   3.860370,   0.032000,  16.380999, 631.851693
Outstanding requests per worker:
76 89 75 87 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108102.9,      540515,     486281,      54234,     398071,      88210,   3.294178,  10.200000,  12.200000,  15.600000,   4.293255,   0.032000,  28.767001, 649.161082
Outstanding requests per worker:
86 111 101 83 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108132.5,      540663,     486395,      54268,     404117,      82278,   3.156935,   9.900000,  11.800000,  13.900000,   4.024604,   0.032000,  17.233999, 662.807963
Outstanding requests per worker:
81 67 78 72 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108113.9,      540570,     486036,      54534,     408355,      77681,   3.280662,  10.300000,  12.400000,  14.600000,   4.193004,   0.032000,  17.294001, 673.346985
Outstanding requests per worker:
78 70 76 70 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18032  2884 pts/0    Ss+  10:54   0:00 bash docker-ent
memcache     7  0.4  0.0  96652  6388 pts/0    S+   10:54   0:00 /usr/lib/linux-
memcache     8  128  0.0 272768 118948 pts/0   Sl+  10:54   0:59 memcached -t 2 
memcache    17  0.0  0.0  34424  2912 pts/1    Rs+  10:55   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       13427312409      instructions:u                                              
         146408108      LLC-loads                                                   
           2842479      LLC-load-misses           #    1.94% of all LL-cache hits   

      45.934005898 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 110000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 110000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 110000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,LLC-loads:u,LLC-load-misses:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,LLC-loads:u,LLC-load-misses:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,LLC-loads:u,LLC-load-misses:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,LLC-loads:u,LLC-load-misses:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 110000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 110000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 110000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 110000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 110000 cpus 4
meanInterarrival 36
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 2604869376
starting receive base loop
num_worker_connections 128
Creating worker on tid 1497577216
starting receive base loop
num_worker_connections 128
Creating worker on tid 391788288
starting receive base loop
Created 512 connections total
Creating worker on tid 3578820352
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575372113.370538,       0.0,      255313,     229752,      25561,     149726,      80026,   6.330206,  20.000000,  31.200000,  49.700000,  11.241619,   0.000000, 125.075996, 466.633022
Outstanding requests per worker:
108 107 121 118 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  111112.3,      555562,     500004,      55558,     369272,     130732,   4.355398,  13.100000,  16.800000,  21.500000,   5.760558,   0.032000,  34.260999, 560.659603
Outstanding requests per worker:
117 129 114 135 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  111128.7,      555644,     500137,      55507,     390488,     109649,   4.209816,  12.700000,  16.300000,  20.400000,   5.560957,   0.032000,  32.666001, 607.343742
Outstanding requests per worker:
111 107 108 108 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  111116.5,      555583,     499944,      55639,     402615,      97329,   4.429989,  13.400000,  17.000000,  21.800000,   5.883665,   0.033000,  31.892002, 634.275989
Outstanding requests per worker:
123 90 121 113 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  111097.5,      555488,     499716,      55772,     410349,      89367,   4.465212,  13.100000,  17.600000,  21.600000,   5.858578,   0.033000,  27.952000, 652.398981
Outstanding requests per worker:
134 130 133 145 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  111124.5,      555623,     500147,      55476,     416006,      84141,   4.912637,  14.700000,  19.000000,  24.900000,   6.600687,   0.032000,  42.998999, 663.689181
Outstanding requests per worker:
116 129 148 127 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  111124.1,      555621,     500265,      55356,     421144,      79121,   4.572932,  13.500000,  17.900000,  22.300000,   6.021508,   0.032000,  28.382000, 674.584276
Outstanding requests per worker:
134 114 138 97 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'7\r'
+ echo 'memcached pid is: 7'
memcached pid is: 7
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18032  2864 pts/0    Ss+  10:55   0:00 bash docker-ent
memcache     6  0.5  0.0  96652  6308 pts/0    S+   10:55   0:00 /usr/lib/linux-
memcache     7  129  0.0 275840 121980 pts/0   Sl+  10:55   0:59 memcached -t 2 
memcache    16  0.0  0.0  34424  2856 pts/1    Rs+  10:56   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       13855823180      instructions:u                                              
         162473108      LLC-loads                                                   
           3074546      LLC-load-misses           #    1.89% of all LL-cache hits   

      45.847192732 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 112000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 112000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 112000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,LLC-loads:u,LLC-load-misses:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,LLC-loads:u,LLC-load-misses:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,LLC-loads:u,LLC-load-misses:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,LLC-loads:u,LLC-load-misses:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 112000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 112000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 112000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 112000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 112000 cpus 4
meanInterarrival 35
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 3273090816
starting receive base loop
num_worker_connections 128
Creating worker on tid 2168665856
starting receive base loop
num_worker_connections 128
Creating worker on tid 1062876928
starting receive base loop
Created 512 connections total
Creating worker on tid 4249040640
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575372161.370586,       0.0,      263980,     237465,      26515,     154358,      83107,   8.956027,  29.100000,  42.100000,  77.600000,  16.209194,   0.000000, 174.391001, 465.638313
Outstanding requests per worker:
159 174 148 167 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114310.9,      571555,     514416,      57139,     381342,     133074,   5.489430,  16.000000,  21.200000,  28.600000,   7.339999,   0.033000,  41.506998, 564.641823
Outstanding requests per worker:
144 147 139 137 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114287.9,      571440,     514495,      56945,     403010,     111485,   5.863078,  16.800000,  23.000000,  29.900000,   7.922530,   0.033000,  87.367997, 610.568686
Outstanding requests per worker:
141 161 152 129 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114283.7,      571419,     514044,      57375,     414799,      99245,   5.640446,  16.200000,  22.000000,  28.900000,   7.518664,   0.033000,  37.797999, 636.129641
Outstanding requests per worker:
169 159 159 152 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114286.1,      571431,     514498,      56933,     422973,      91525,   6.110409,  17.700000,  23.600000,  31.700000,   8.254426,   0.033000,  53.888999, 652.863514
Outstanding requests per worker:
173 151 190 147 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114295.7,      571479,     514339,      57140,     428739,      85600,   5.954342,  17.000000,  22.900000,  31.000000,   7.938203,   0.033000,  36.632001, 666.244024
Outstanding requests per worker:
151 152 170 184 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114273.1,      571366,     513723,      57643,     432791,      80932,   5.876636,  16.800000,  22.600000,  30.800000,   7.842848,   0.033000,  37.900001, 675.551097
Outstanding requests per worker:
184 190 173 206 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'7\r'
+ echo 'memcached pid is: 7'
memcached pid is: 7
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18032  2860 pts/0    Ss+  10:56   0:00 bash docker-ent
memcache     6  0.3  0.0  96652  6400 pts/0    S+   10:56   0:00 /usr/lib/linux-
memcache     7  129  0.0 278912 125292 pts/0   Sl+  10:56   0:59 memcached -t 2 
memcache    16 18.0  0.0  34424  2820 pts/1    Rs+  10:56   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       14117170357      instructions:u                                              
         147623908      LLC-loads                                                   
           3186169      LLC-load-misses           #    2.16% of all LL-cache hits   

      45.925955274 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 114000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 114000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 114000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,LLC-loads:u,LLC-load-misses:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,LLC-loads:u,LLC-load-misses:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,LLC-loads:u,LLC-load-misses:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,LLC-loads:u,LLC-load-misses:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 114000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 114000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 114000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 114000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 114000 cpus 4
meanInterarrival 35
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 147654400
starting receive base loop
num_worker_connections 128
Creating worker on tid 3341563648
starting receive base loop
num_worker_connections 128
Creating worker on tid 2235774720
starting receive base loop
Created 512 connections total
Creating worker on tid 1129985792
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575372209.370634,       0.0,      263279,     236844,      26435,     154908,      81936,   6.964054,  22.900000,  31.300000,  50.800000,  11.797919,   0.000000, 126.182005, 468.640362
Outstanding requests per worker:
185 155 137 161 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114301.9,      571510,     514448,      57062,     380286,     134162,   5.491625,  15.900000,  21.200000,  28.300000,   7.333817,   0.034000,  40.449001, 561.999137
Outstanding requests per worker:
151 155 157 141 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114292.1,      571461,     514245,      57216,     402127,     112118,   5.751994,  16.500000,  22.500000,  29.300000,   7.727939,   0.046000,  73.164999, 608.072989
Outstanding requests per worker:
159 162 156 127 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114287.7,      571439,     514035,      57404,     413694,     100341,   5.655354,  16.200000,  21.800000,  29.100000,   7.507011,   0.033000,  35.195000, 633.902369
Outstanding requests per worker:
170 143 169 161 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114271.1,      571356,     514173,      57183,     422700,      91473,   6.078667,  17.600000,  23.600000,  31.600000,   8.220525,   0.033000,  73.495999, 652.604343
Outstanding requests per worker:
208 183 186 169 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114321.7,      571609,     514215,      57394,     428350,      85865,   5.871316,  16.800000,  22.600000,  30.500000,   7.810111,   0.033000,  36.550000, 664.838801
Outstanding requests per worker:
181 144 140 149 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114258.7,      571294,     513537,      57757,     432725,      80812,   6.010864,  17.200000,  23.000000,  31.100000,   7.993060,   0.033000,  39.519001, 675.776427
Outstanding requests per worker:
217 193 200 168 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18032  2860 pts/0    Ss+  10:56   0:00 bash docker-ent
memcache     7  0.4  0.0  96652  6256 pts/0    S+   10:56   0:00 /usr/lib/linux-
memcache     8  133  0.0 279936 126148 pts/0   Sl+  10:56   1:00 memcached -t 2 
memcache    17  0.0  0.0  34424  2828 pts/1    Rs+  10:57   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       14207119322      instructions:u                                              
         162253590      LLC-loads                                                   
           3219995      LLC-load-misses           #    1.98% of all LL-cache hits   

      45.795473135 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 116000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 116000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 116000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,LLC-loads:u,LLC-load-misses:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,LLC-loads:u,LLC-load-misses:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,LLC-loads:u,LLC-load-misses:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,LLC-loads:u,LLC-load-misses:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 116000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 116000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 116000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 116000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 116000 cpus 4
meanInterarrival 34
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 2039162624
starting receive base loop
num_worker_connections 128
Creating worker on tid 936670976
starting receive base loop
num_worker_connections 128
Creating worker on tid 4122834688
starting receive base loop
Created 512 connections total
Creating worker on tid 3017045760
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575372257.370682,       0.0,      270526,     243528,      26998,     159848,      83680,   8.945422,  28.700000,  40.400000,  76.700000,  15.938623,   0.000000, 186.640993, 470.821877
Outstanding requests per worker:
165 157 172 181 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117656.3,      588282,     529964,      58318,     393699,     136265,   6.290675,  18.000000,  23.900000,  32.900000,   8.437666,   0.032000,  55.856001, 565.790631
Outstanding requests per worker:
176 169 157 178 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117620.9,      588105,     529290,      58815,     414676,     114614,   6.780418,  19.400000,  26.100000,  35.600000,   9.171508,   0.032000,  84.086001, 610.814395
Outstanding requests per worker:
216 198 229 195 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117655.5,      588278,     529044,      59234,     427083,     101961,   6.562599,  18.800000,  24.200000,  35.000000,   8.759753,   0.044000,  50.340001, 636.907325
Outstanding requests per worker:
246 211 199 187 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117672.1,      588361,     529314,      59047,     435147,      94167,   7.048063,  20.200000,  26.900000,  37.200000,   9.583695,   0.044000,  88.656001, 653.598560
Outstanding requests per worker:
192 209 172 174 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117638.5,      588193,     529261,      58932,     441292,      87969,   6.737479,  19.300000,  24.600000,  36.200000,   9.014297,   0.044000,  54.393001, 665.719095
Outstanding requests per worker:
205 220 198 213 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117642.7,      588214,     529190,      59024,     446302,      82888,   6.781745,  19.500000,  25.000000,  36.200000,   9.108152,   0.043000,  50.230999, 676.619930
Outstanding requests per worker:
225 202 240 222 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'7\r'
+ echo 'memcached pid is: 7'
memcached pid is: 7
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18032  2740 pts/0    Ss+  10:57   0:00 bash docker-ent
memcache     6  0.5  0.0  96652  6328 pts/0    S+   10:57   0:00 /usr/lib/linux-
memcache     7  133  0.0 280960 127444 pts/0   Sl+  10:57   1:00 memcached -t 2 
memcache    16  0.0  0.0  34424  2816 pts/1    Rs+  10:58   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       14546123762      instructions:u                                              
         151257403      LLC-loads                                                   
           3432633      LLC-load-misses           #    2.27% of all LL-cache hits   

      45.783117057 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 118000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 118000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 118000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,LLC-loads:u,LLC-load-misses:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,LLC-loads:u,LLC-load-misses:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,LLC-loads:u,LLC-load-misses:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,LLC-loads:u,LLC-load-misses:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 118000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 118000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 118000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 118000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 118000 cpus 4
meanInterarrival 33
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 4157511424
starting receive base loop
num_worker_connections 128
Creating worker on tid 3045476096
starting receive base loop
num_worker_connections 128
Creating worker on tid 1943303936
starting receive base loop
Created 512 connections total
Creating worker on tid 834500352
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575372305.370730,       0.0,      278545,     250518,      28027,     164018,      86500,  16.701295,  55.500000,  81.500000, 115.000000,  27.676072,   0.000000, 184.401006, 469.270052
Outstanding requests per worker:
277 200 264 262 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121263.5,      606318,     545307,      61011,     404373,     140934,   8.253847,  23.900000,  29.700000,  45.400000,  11.177058,   0.044000,  97.125001, 564.405583
Outstanding requests per worker:
228 200 190 181 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121147.7,      605739,     545324,      60415,     427690,     117634,   8.869213,  25.900000,  30.800000,  49.400000,  11.951637,   0.044000,  96.325003, 611.787215
Outstanding requests per worker:
350 263 277 264 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121096.3,      605482,     545000,      60482,     440723,     104277,  13.824951,  25.200000,  32.700000,  40.200000,   8.986113,   0.107000,  78.295998, 638.201560
Outstanding requests per worker:
483 428 469 404 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121219.9,      606100,     545441,      60659,     449902,      95539,  15.762980,  29.400000,  36.100000,  48.300000,  10.541979,   0.162000, 113.303997, 656.357472
Outstanding requests per worker:
416 459 487 426 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121232.5,      606163,     545781,      60382,     455870,      89911,  14.376401,  25.900000,  33.900000,  41.700000,   9.277720,   0.157000,  74.253999, 667.930886
Outstanding requests per worker:
464 449 436 425 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121198.9,      605995,     545345,      60650,     461063,      84282,  15.588608,  27.200000,  36.400000,  46.100000,  10.045987,   0.105000,  80.343999, 679.320357
Outstanding requests per worker:
470 517 450 443 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18032  2860 pts/0    Ss+  10:58   0:00 bash docker-ent
memcache     7  0.4  0.0  96652  6284 pts/0    S+   10:58   0:00 /usr/lib/linux-
memcache     8  140  0.0 283008 131804 pts/0   Sl+  10:58   1:03 memcached -t 2 
memcache    17  0.0  0.0  34424  2772 pts/1    Rs+  10:59   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       14518665177      instructions:u                                              
         165924233      LLC-loads                                                   
           4143967      LLC-load-misses           #    2.50% of all LL-cache hits   

      45.767437345 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 120000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 120000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 120000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,LLC-loads:u,LLC-load-misses:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,LLC-loads:u,LLC-load-misses:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,LLC-loads:u,LLC-load-misses:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,LLC-loads:u,LLC-load-misses:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 120000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 120000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 120000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 120000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 120000 cpus 4
meanInterarrival 33
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 3850274560
starting receive base loop
num_worker_connections 128
Creating worker on tid 2748610304
starting receive base loop
num_worker_connections 128
Creating worker on tid 1639806720
starting receive base loop
Created 512 connections total
Creating worker on tid 534017792
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575372352.370777,       0.0,      272927,     245514,      27413,     161241,      84273,  33.605308, 115.600000, 134.300000, 173.500000,  49.260480,   0.000000, 258.421987, 470.529359
Outstanding requests per worker:
1292 1452 1510 1309 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  120827.1,      604136,     543915,      60221,     404262,     139653,  55.470941, 146.300000, 172.500000, 208.600000,  63.984288,   0.044000, 325.105995, 566.754101
Outstanding requests per worker:
1807 1925 1863 1943 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121052.3,      605262,     545050,      60212,     427099,     117951,  63.514684, 166.800000, 189.400000, 233.000000,  71.596044,   0.045000, 373.861998, 611.418013
Outstanding requests per worker:
2234 2042 2023 2076 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121125.5,      605628,     544636,      60992,     440333,     104303,  70.622622, 182.400000, 201.800000, 250.400000,  78.312595,   0.044000, 355.242997, 638.265678
Outstanding requests per worker:
2235 2189 2211 2219 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  120602.9,      603015,     542513,      60502,     446706,      95807,  80.244962, 206.600000, 237.500000, 295.600000,  90.654146,   0.045000, 515.842021, 654.651225
Outstanding requests per worker:
3017 3049 2843 3022 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  120913.3,      604567,     543879,      60688,     454571,      89308, 103.321742, 264.100000, 294.300000, 358.100000, 113.862829,   0.045000, 546.826005, 668.668250
Outstanding requests per worker:
3353 3331 3265 3526 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  120688.9,      603445,     543431,      60014,     459073,      84358, 120.519438, 303.900000, 349.200000, 429.500000, 133.094708,   0.045000, 677.375019, 678.658439
Outstanding requests per worker:
3888 4112 4048 4073 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'9\r'
+ echo 'memcached pid is: 9'
memcached pid is: 9
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.4  0.0  18032  2884 pts/0    Ss+  10:59   0:00 bash docker-ent
memcache     8  0.3  0.0  96652  6316 pts/0    S+   10:59   0:00 /usr/lib/linux-
memcache     9  132  0.0 281984 133280 pts/0   Sl+  10:59   1:00 memcached -t 2 
memcache    19  0.0  0.0  34424  2832 pts/1    Rs+  11:00   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       14990593651      instructions:u                                              
         168206196      LLC-loads                                                   
           8400464      LLC-load-misses           #    4.99% of all LL-cache hits   

      45.777268511 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 122000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 122000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 122000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,LLC-loads:u,LLC-load-misses:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,LLC-loads:u,LLC-load-misses:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,LLC-loads:u,LLC-load-misses:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,LLC-loads:u,LLC-load-misses:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 122000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 122000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 122000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 122000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 122000 cpus 4
meanInterarrival 32
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 85882624
starting receive base loop
num_worker_connections 128
Creating worker on tid 3274454784
starting receive base loop
num_worker_connections 128
Creating worker on tid 2168665856
starting receive base loop
Created 512 connections total
Creating worker on tid 1062876928
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575372400.370825,       0.0,      280009,     251902,      28107,     165429,      86473,  35.279794,  82.400000, 112.700000, 708.600000, 121.257762,   0.000000, 1627.714038, 471.181182
Outstanding requests per worker:
1140 1394 1247 4776 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  123125.1,      615626,     554217,      61409,     412465,     141752, 108.164170, 261.500000, 324.000000, 998.100000, 169.785076,   0.043000, 1525.166035, 567.546051
Outstanding requests per worker:
4086 4165 3856 5871 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  123477.7,      617389,     555698,      61691,     437400,     118298, 168.618957, 416.400000, 483.000000, 826.200000, 202.015618,   0.045000, 1582.749963, 613.945166
Outstanding requests per worker:
5770 6046 6350 7457 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  123380.7,      616904,     555207,      61697,     450147,     105060, 232.859272, 583.600000, 684.900000, 912.900000, 267.711998,   0.045000, 1727.429032, 640.671261
Outstanding requests per worker:
7630 8204 8275 9649 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  122758.3,      613792,     552063,      61729,     455528,      96535, 304.102150, 785.800000, 893.500000, 1150.600000, 345.360818,   0.045000, 1878.188014, 656.210811
Outstanding requests per worker:
10324 11231 10791 12651 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121867.7,      609339,     548167,      61172,     458715,      89452, 409.478214, 1050.900000, 1189.100000, 1511.900000, 463.209053,   0.045000, 2378.998995, 669.348481
Outstanding requests per worker:
14463 15352 14642 16252 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121571.1,      607856,     547157,      60699,     462566,      84591, 537.572526, 1355.200000, 1505.500000, 1851.300000, 599.391208,   0.045000, 2629.470110, 677.939654
Outstanding requests per worker:
18907 19793 18988 20201 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18032  2852 pts/0    Ss+  11:00   0:00 bash docker-ent
memcache     7  0.5  0.0  96652  6352 pts/0    S+   11:00   0:00 /usr/lib/linux-
memcache     8  133  0.0 283008 135916 pts/0   Sl+  11:00   1:01 memcached -t 2 
memcache    18 18.0  0.0  34424  2828 pts/1    Rs+  11:00   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       15139108448      instructions:u                                              
         160094747      LLC-loads                                                   
          11716241      LLC-load-misses           # [33m   7.32%[m of all LL-cache hits   

      45.891656141 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 124000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 124000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 124000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,LLC-loads:u,LLC-load-misses:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,LLC-loads:u,LLC-load-misses:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,LLC-loads:u,LLC-load-misses:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,LLC-loads:u,LLC-load-misses:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 124000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 124000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 124000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 124000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 124000 cpus 4
meanInterarrival 32
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 4168906496
starting receive base loop
num_worker_connections 128
Creating worker on tid 3065116416
starting receive base loop
num_worker_connections 128
Creating worker on tid 1959327488
starting receive base loop
Created 512 connections total
Creating worker on tid 850523904
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575372448.370873,       0.0,      279908,     251759,      28149,     165155,      86604,  36.253694, 126.800000, 150.000000, 190.400000,  54.625763,   0.000000, 331.030011, 470.331031
Outstanding requests per worker:
1854 1694 2000 1996 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  123785.7,      618929,     556994,      61935,     414093,     142901,  86.439406, 226.000000, 262.300000, 327.200000,  98.560640,   0.045000, 484.773993, 567.054523
Outstanding requests per worker:
3277 3588 3359 3442 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  123646.5,      618233,     556245,      61988,     436902,     119343, 133.574198, 336.500000, 379.900000, 481.600000, 148.045880,   0.046000, 787.914991, 613.600004
Outstanding requests per worker:
5269 5214 4974 5011 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  123738.7,      618694,     557017,      61677,     450484,     106533, 186.224749, 466.800000, 539.500000, 669.900000, 206.178845,   0.046000, 1020.964980, 638.291241
Outstanding requests per worker:
6966 6865 6429 6564 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  122816.3,      614082,     552802,      61280,     455860,      96942, 252.548359, 646.600000, 730.900000, 893.000000, 281.075965,   0.045000, 1255.552053, 656.498272
Outstanding requests per worker:
9597 9498 9210 9470 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  122731.7,      613659,     552389,      61270,     462534,      89855, 338.144310, 865.800000, 985.300000, 1181.400000, 376.664434,   0.046000, 1502.681017, 670.174583
Outstanding requests per worker:
12469 12570 11770 12357 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  122053.5,      610268,     549136,      61132,     464881,      84255, 436.286318, 1117.100000, 1245.600000, 1454.200000, 482.171512,   0.045000, 1743.872046, 679.548498
Outstanding requests per worker:
15852 16155 16023 15903 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'7\r'
+ echo 'memcached pid is: 7'
memcached pid is: 7
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18032  2880 pts/0    Ss+  11:00   0:00 bash docker-ent
memcache     6  0.4  0.0  96652  6400 pts/0    S+   11:00   0:00 /usr/lib/linux-
memcache     7  136  0.0 283008 135568 pts/0   Sl+  11:00   1:01 memcached -t 2 
memcache    16  0.0  0.0  34424  2788 pts/1    Rs+  11:01   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       15221930037      instructions:u                                              
         162465871      LLC-loads                                                   
          11637331      LLC-load-misses           # [33m   7.16%[m of all LL-cache hits   

      45.857542457 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 126000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 126000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 126000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,LLC-loads:u,LLC-load-misses:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,LLC-loads:u,LLC-load-misses:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,LLC-loads:u,LLC-load-misses:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,LLC-loads:u,LLC-load-misses:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 126000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 126000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 126000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 126000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 126000 cpus 4
meanInterarrival 31
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 150415104
starting receive base loop
num_worker_connections 128
Creating worker on tid 3341563648
starting receive base loop
num_worker_connections 128
Creating worker on tid 2235774720
starting receive base loop
Created 512 connections total
Creating worker on tid 1126971136
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575372496.370921,       0.0,      286148,     257546,      28602,     169418,      88128,  46.383508, 159.000000, 185.700000, 230.800000,  68.561313,   0.000000, 378.228992, 472.400693
Outstanding requests per worker:
2771 2650 2928 3019 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  125701.7,      628509,     565934,      62575,     420736,     145198, 149.772862, 393.300000, 452.300000, 567.700000, 172.103658,   0.045000, 814.243972, 566.797754
Outstanding requests per worker:
6790 7175 6962 7148 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  124771.9,      623860,     561740,      62120,     441657,     120083, 283.187501, 729.600000, 823.700000, 997.400000, 318.510789,   0.044000, 1488.695979, 614.481338
Outstanding requests per worker:
12240 12458 12414 12299 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  123970.7,      619854,     557646,      62208,     451700,     105946, 459.781920, 1160.600000, 1289.500000, 1498.100000, 508.231279,   0.045000, 2003.573895, 640.084765
Outstanding requests per worker:
18724 19094 18981 17970 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  123062.3,      615312,     554101,      61211,     457174,      96927, 660.339257, 1633.200000, 1779.500000, 2024.200000, 723.233394,   0.045000, 2572.346926, 656.638781
Outstanding requests per worker:
26255 26241 26596 25562 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  122944.9,      614725,     553204,      61521,     463067,      90137, 881.368632, 2134.400000, 2289.800000, 2503.500000, 953.944317,   0.045000, 3042.047024, 670.131552
Outstanding requests per worker:
33951 33706 34405 33076 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  122807.1,      614036,     552745,      61291,     468065,      84680, 1104.780095, 2638.700000, 2819.700000, 3087.200000, 1192.512892,   0.046000, 3517.302990, 680.012950
Outstanding requests per worker:
41618 41480 42628 40574 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'7\r'
+ echo 'memcached pid is: 7'
memcached pid is: 7
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18032  2856 pts/0    Ss+  11:01   0:00 bash docker-ent
memcache     6  0.5  0.0  96652  6288 pts/0    S+   11:01   0:00 /usr/lib/linux-
memcache     7  137  0.0 283008 135532 pts/0   Sl+  11:01   1:01 memcached -t 2 
memcache    16  0.0  0.0  34424  2864 pts/1    Rs+  11:02   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       15280852300      instructions:u                                              
         154846171      LLC-loads                                                   
          12268580      LLC-load-misses           # [33m   7.92%[m of all LL-cache hits   

      45.827474773 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 128000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 128000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 128000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,LLC-loads:u,LLC-load-misses:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,LLC-loads:u,LLC-load-misses:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,LLC-loads:u,LLC-load-misses:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,LLC-loads:u,LLC-load-misses:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 128000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 128000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 128000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 128000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 128000 cpus 4
meanInterarrival 31
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 980748032
starting receive base loop
num_worker_connections 128
Creating worker on tid 4171691776
starting receive base loop
num_worker_connections 128
Creating worker on tid 3065116416
starting receive base loop
Created 512 connections total
Creating worker on tid 1959327488
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575372543.370968,       0.0,      284811,     256390,      28421,     168347,      88043,  46.967085, 161.500000, 188.400000, 238.200000,  69.727844,   0.000000, 351.211995, 470.889914
Outstanding requests per worker:
2983 2812 2642 2655 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  125470.7,      627354,     564612,      62742,     420420,     144192, 148.816401, 395.400000, 455.800000, 567.500000, 171.928084,   0.044000, 812.205970, 568.178576
Outstanding requests per worker:
7047 7559 7020 7339 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  124724.1,      623621,     561390,      62231,     442314,     119076, 290.300371, 746.800000, 842.600000, 1008.400000, 325.063551,   0.045000, 1359.549999, 615.678861
Outstanding requests per worker:
12433 12936 12499 12676 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  124035.9,      620180,     557982,      62198,     452809,     105173, 465.107679, 1162.400000, 1281.600000, 1489.700000, 511.631561,   0.045000, 1915.200949, 641.693847
Outstanding requests per worker:
18357 19528 18592 19107 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  123285.7,      616429,     554474,      61955,     458362,      96112, 663.172259, 1626.300000, 1776.900000, 2014.200000, 724.895905,   0.044000, 2383.910894, 658.265060
Outstanding requests per worker:
26018 26527 25569 26242 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  123109.1,      615546,     553997,      61549,     464208,      89789, 877.315682, 2114.900000, 2262.500000, 2520.400000, 948.346578,   0.045000, 3053.010941, 671.250030
Outstanding requests per worker:
33516 34103 32881 33534 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  122602.7,      613014,     551746,      61268,     467027,      84719, 1102.403930, 2603.400000, 2761.400000, 3050.600000, 1183.353739,   0.045000, 3595.453024, 680.235904
Outstanding requests per worker:
41432 42056 40554 42186 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'7\r'
+ echo 'memcached pid is: 7'
memcached pid is: 7
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18032  2856 pts/0    Ss+  11:02   0:00 bash docker-ent
memcache     6  0.5  0.0  96652  6308 pts/0    S+   11:02   0:00 /usr/lib/linux-
memcache     7  137  0.0 284032 136680 pts/0   Sl+  11:02   1:01 memcached -t 2 
memcache    16  0.0  0.0  34424  2852 pts/1    Rs+  11:03   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       15364884417      instructions:u                                              
         162895778      LLC-loads                                                   
          12405230      LLC-load-misses           # [33m   7.62%[m of all LL-cache hits   

      45.808731767 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 130000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 130000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 130000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,LLC-loads:u,LLC-load-misses:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,LLC-loads:u,LLC-load-misses:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,LLC-loads:u,LLC-load-misses:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,LLC-loads:u,LLC-load-misses:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 130000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 130000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 130000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 130000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 130000 cpus 4
meanInterarrival 30
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 220587776
starting receive base loop
num_worker_connections 128
Creating worker on tid 3411687168
starting receive base loop
num_worker_connections 128
Creating worker on tid 2302883584
starting receive base loop
Created 512 connections total
Creating worker on tid 1197094656
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575372591.371016,       0.0,      287103,     258256,      28847,     170296,      87960,  52.262561, 146.800000, 187.900000, 738.600000, 136.679671,   0.000000, 1873.047948, 474.467602
Outstanding requests per worker:
3004 3116 3076 8480 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  126760.5,      633803,     570305,      63498,     425096,     145209, 242.341269, 635.200000, 758.500000, 1677.400000, 342.023728,   0.045000, 2543.176889, 568.833337
Outstanding requests per worker:
11203 11491 11625 16273 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  126054.3,      630272,     567355,      62917,     446267,     121088, 478.796215, 1198.200000, 1354.400000, 2225.600000, 565.772423,   0.046000, 3101.316929, 614.332513
Outstanding requests per worker:
20183 20710 20543 25584 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  125516.1,      627581,     564431,      63150,     457779,     106652, 747.608166, 1802.500000, 1981.600000, 2824.600000, 838.815699,   0.045000, 3911.878109, 641.769157
Outstanding requests per worker:
30414 30079 30585 35076 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  124845.3,      624227,     561638,      62589,     464208,      97430, 1028.198787, 2445.700000, 2668.800000, 3422.800000, 1136.798700,   0.045000, 4503.345013, 658.281042
Outstanding requests per worker:
41299 40706 41028 45601 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  124701.7,      623509,     561239,      62270,     469921,      91318, 1326.833493, 3110.300000, 3321.500000, 4076.800000, 1453.568223,   0.045000, 5032.420158, 670.174282
Outstanding requests per worker:
52431 51355 51859 56200 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  124653.7,      623269,     561090,      62179,     474749,      86341, 1627.008716, 3784.300000, 4025.900000, 4726.600000, 1774.527508,   0.045000, 5782.753944, 680.273179
Outstanding requests per worker:
63182 62511 62598 66984 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.4  0.0  18032  2764 pts/0    Ss+  11:03   0:00 bash docker-ent
memcache     7  0.3  0.0  96652  6372 pts/0    S+   11:03   0:00 /usr/lib/linux-
memcache     8  135  0.0 284032 137580 pts/0   Sl+  11:03   1:02 memcached -t 2 
memcache    17  0.0  0.0  34424  2872 pts/1    Rs+  11:04   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       15481389155      instructions:u                                              
         153265651      LLC-loads                                                   
          12667057      LLC-load-misses           # [33m   8.26%[m of all LL-cache hits   

      45.977713933 seconds time elapsed

+ for threads in '$THREADS'
+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 104000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 104000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 104000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,LLC-loads:u,LLC-load-misses:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,LLC-loads:u,LLC-load-misses:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,LLC-loads:u,LLC-load-misses:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,LLC-loads:u,LLC-load-misses:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 104000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 104000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 104000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 104000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 104000 cpus 8
meanInterarrival 76
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 1446598400
starting receive base loop
num_worker_connections 64
Creating worker on tid 847316736
starting receive base loop
num_worker_connections 64
Creating worker on tid 257488640
starting receive base loop
num_worker_connections 64
Creating worker on tid 3956487936
starting receive base loop
num_worker_connections 64
Creating worker on tid 3360519936
starting receive base loop
num_worker_connections 64
Creating worker on tid 2764551936
starting receive base loop
num_worker_connections 64
Creating worker on tid 2168583936
starting receive base loop
Created 512 connections total
Creating worker on tid 1575630592
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575372640.371065,       0.0,      310110,     279088,      31022,     184677,      94411,   2.141857,   8.100000,  10.500000,  15.200000,   3.918186,   0.000000,  62.484998, 476.912884
Outstanding requests per worker:
42 50 22 46 45 39 21 39 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  105282.1,      526411,     473938,      52473,     352403,     121535,   2.727212,   8.400000,  10.100000,  13.100000,   3.593965,   0.023000,  19.479999, 566.661829
Outstanding requests per worker:
31 35 30 26 40 31 29 28 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  105243.7,      526219,     473652,      52567,     370430,     103222,   3.193309,   9.900000,  12.000000,  16.000000,   4.293136,   0.023000,  25.720000, 608.987252
Outstanding requests per worker:
51 41 42 52 51 58 49 50 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  105264.1,      526321,     473929,      52392,     380369,      93560,   3.089558,   9.800000,  11.800000,  14.300000,   4.054821,   0.022000,  18.967999, 632.682628
Outstanding requests per worker:
51 50 45 45 62 59 60 45 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  105277.5,      526388,     473628,      52760,     387864,      85764,   3.391288,  10.600000,  12.800000,  17.300000,   4.595104,   0.023000,  29.681999, 649.663755
Outstanding requests per worker:
52 42 50 42 45 51 45 47 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  105274.3,      526372,     473542,      52830,     393203,      80339,   3.232609,  10.300000,  12.400000,  14.900000,   4.245684,   0.023000,  18.038001, 662.317923
Outstanding requests per worker:
38 56 47 33 51 53 44 41 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  105286.1,      526431,     473688,      52743,     397942,      75746,   3.246140,  10.300000,  12.500000,  15.000000,   4.278437,   0.023000,  20.617999, 672.213579
Outstanding requests per worker:
37 34 43 28 31 29 38 37 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.4  0.0  18032  2860 pts/0    Ss+  11:04   0:00 bash docker-ent
memcache     7  0.4  0.0  96652  6276 pts/0    S+   11:04   0:00 /usr/lib/linux-
memcache     8  127  0.0 272768 118580 pts/0   Sl+  11:04   1:00 memcached -t 2 
memcache    18 18.0  0.0  34424  2868 pts/1    Rs+  11:04   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       13297450275      instructions:u                                              
         153709033      LLC-loads                                                   
           3077098      LLC-load-misses           #    2.00% of all LL-cache hits   

      46.786411804 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 106000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 106000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 106000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,LLC-loads:u,LLC-load-misses:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,LLC-loads:u,LLC-load-misses:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,LLC-loads:u,LLC-load-misses:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,LLC-loads:u,LLC-load-misses:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 106000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 106000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 106000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 106000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 106000 cpus 8
meanInterarrival 75
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 2367899392
starting receive base loop
num_worker_connections 64
Creating worker on tid 1768617728
starting receive base loop
num_worker_connections 64
Creating worker on tid 1177974528
starting receive base loop
num_worker_connections 64
Creating worker on tid 585021184
starting receive base loop
num_worker_connections 64
Creating worker on tid 4284020480
starting receive base loop
num_worker_connections 64
Creating worker on tid 3688052480
starting receive base loop
num_worker_connections 64
Creating worker on tid 3092084480
starting receive base loop
Created 512 connections total
Creating worker on tid 2496116480
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575372689.371114,       0.0,      312853,     281517,      31336,     185554,      95963,   3.174833,  11.800000,  16.200000,  23.600000,   5.752669,   0.000000,  48.953999, 474.115453
Outstanding requests per worker:
54 62 52 49 47 55 61 61 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  106677.5,      533388,     479972,      53416,     356721,     123251,   4.188218,  13.000000,  16.400000,  20.900000,   5.667313,   0.023000,  30.768000, 566.285629
Outstanding requests per worker:
53 63 52 49 61 53 40 61 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  106670.5,      533353,     480106,      53247,     375206,     104900,   4.491651,  13.400000,  18.000000,  22.400000,   6.032037,   0.023000,  27.634000, 608.648538
Outstanding requests per worker:
51 65 45 52 59 67 56 64 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  106665.3,      533327,     479881,      53446,     385702,      94179,   4.832521,  14.500000,  19.200000,  24.500000,   6.579027,   0.023000,  41.134998, 633.299328
Outstanding requests per worker:
59 69 55 61 53 57 58 77 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  106662.9,      533315,     480028,      53287,     393353,      86675,   4.720946,  14.000000,  19.000000,  23.600000,   6.373999,   0.023000,  31.601999, 649.804370
Outstanding requests per worker:
57 60 61 82 72 63 71 69 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  106671.9,      533360,     479582,      53778,     398341,      81241,   4.739764,  14.100000,  19.000000,  24.100000,   6.400602,   0.023000,  28.958000, 663.197407
Outstanding requests per worker:
74 80 66 102 44 73 65 51 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  106690.3,      533452,     479965,      53487,     403115,      76850,   5.545068,  16.700000,  22.000000,  28.800000,   7.681654,   0.022000,  50.260998, 672.872309
Outstanding requests per worker:
52 58 60 74 55 57 53 59 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'9\r'
+ echo 'memcached pid is: 9'
memcached pid is: 9
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.4  0.0  18032  2788 pts/0    Ss+  11:04   0:00 bash docker-ent
memcache     8  0.5  0.0  96652  6384 pts/0    S+   11:04   0:00 /usr/lib/linux-
memcache     9  130  0.0 273792 120052 pts/0   Sl+  11:04   0:59 memcached -t 2 
memcache    19  0.0  0.0  34424  2876 pts/1    Rs+  11:05   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       13515094560      instructions:u                                              
         153998869      LLC-loads                                                   
           3114693      LLC-load-misses           #    2.02% of all LL-cache hits   

      46.832880679 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 108000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 108000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 108000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,LLC-loads:u,LLC-load-misses:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,LLC-loads:u,LLC-load-misses:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,LLC-loads:u,LLC-load-misses:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,LLC-loads:u,LLC-load-misses:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 108000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 108000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 108000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 108000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 108000 cpus 8
meanInterarrival 74
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 147797760
starting receive base loop
num_worker_connections 64
Creating worker on tid 3854317312
starting receive base loop
num_worker_connections 64
Creating worker on tid 3261363968
starting receive base loop
num_worker_connections 64
Creating worker on tid 2665395968
starting receive base loop
num_worker_connections 64
Creating worker on tid 2069427968
starting receive base loop
num_worker_connections 64
Creating worker on tid 1473459968
starting receive base loop
num_worker_connections 64
Creating worker on tid 877491968
starting receive base loop
Created 512 connections total
Creating worker on tid 281523968
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575372738.371163,       0.0,      318896,     286913,      31983,     189944,      96969,   2.877585,  10.600000,  14.700000,  22.100000,   5.377146,   0.000000, 102.891997, 477.114784
Outstanding requests per worker:
49 46 63 43 49 47 52 49 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108109.7,      540549,     486690,      53859,     362464,     124226,   4.043094,  12.500000,  15.500000,  20.600000,   5.449081,   0.023000,  30.036001, 567.731671
Outstanding requests per worker:
57 42 51 61 64 60 51 49 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108108.5,      540543,     486484,      54059,     381146,     105338,   4.315583,  13.100000,  17.100000,  21.400000,   5.800860,   0.024000,  33.728998, 610.622450
Outstanding requests per worker:
60 59 58 58 52 74 56 60 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108089.7,      540449,     486315,      54134,     391508,      94807,   4.382561,  13.400000,  17.600000,  21.900000,   6.061953,   0.022000,  41.237999, 634.670319
Outstanding requests per worker:
64 65 74 105 69 55 83 76 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108129.3,      540647,     486666,      53981,     399739,      86927,   4.942959,  14.500000,  19.900000,  25.100000,   6.670354,   0.023000,  30.960999, 652.581684
Outstanding requests per worker:
71 59 73 57 62 57 70 69 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108114.5,      540573,     486586,      53987,     404687,      81899,   4.771665,  14.100000,  19.100000,  24.200000,   6.438893,   0.023000,  29.990001, 664.258579
Outstanding requests per worker:
62 58 72 63 46 82 66 73 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108094.5,      540473,     486268,      54205,     408857,      77411,   5.026025,  14.800000,  20.300000,  26.100000,   6.831455,   0.023000,  32.573000, 674.786864
Outstanding requests per worker:
81 81 95 72 69 82 71 71 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18032  2884 pts/0    Ss+  11:05   0:00 bash docker-ent
memcache     7  0.4  0.0  96652  6384 pts/0    S+   11:05   0:00 /usr/lib/linux-
memcache     8  129  0.0 275840 122964 pts/0   Sl+  11:05   0:59 memcached -t 2 
memcache    17  0.0  0.0  34424  2792 pts/1    Rs+  11:06   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       13648217633      instructions:u                                              
         161038543      LLC-loads                                                   
           3341772      LLC-load-misses           #    2.08% of all LL-cache hits   

      46.817791272 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 110000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 110000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 110000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,LLC-loads:u,LLC-load-misses:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,LLC-loads:u,LLC-load-misses:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,LLC-loads:u,LLC-load-misses:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,LLC-loads:u,LLC-load-misses:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 110000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 110000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 110000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 110000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 110000 cpus 8
meanInterarrival 72
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 1437546240
starting receive base loop
num_worker_connections 64
Creating worker on tid 838264576
starting receive base loop
num_worker_connections 64
Creating worker on tid 249476864
starting receive base loop
num_worker_connections 64
Creating worker on tid 3948476160
starting receive base loop
num_worker_connections 64
Creating worker on tid 3352508160
starting receive base loop
num_worker_connections 64
Creating worker on tid 2756540160
starting receive base loop
num_worker_connections 64
Creating worker on tid 2160572160
starting receive base loop
Created 512 connections total
Creating worker on tid 1564604160
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575372787.371212,       0.0,      327867,     295099,      32768,     195524,      99575,   8.761278,  22.500000,  27.200000,  41.700000,  10.445787,   0.000000, 227.206007, 478.576196
Outstanding requests per worker:
185 172 199 205 176 180 168 173 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  111147.1,      555736,     500535,      55201,     372885,     127650,  11.446497,  22.500000,  27.200000,  32.000000,   7.605047,   0.050000,  46.879001, 569.271262
Outstanding requests per worker:
161 171 197 175 153 169 172 164 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  111141.1,      555706,     500152,      55554,     391281,     108871,  12.217300,  24.400000,  28.700000,  34.300000,   8.303031,   0.060000,  80.407001, 609.910785
Outstanding requests per worker:
156 182 176 168 153 130 178 163 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  111116.1,      555581,     499558,      56023,     402648,      96910,  11.952265,  23.400000,  28.900000,  33.300000,   7.909548,   0.065000,  54.033000, 635.336131
Outstanding requests per worker:
163 168 173 173 162 146 182 152 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  111104.3,      555522,     500097,      55425,     411213,      88884,  13.405705,  26.600000,  31.500000,  39.800000,   9.218441,   0.063000,  89.899004, 652.811906
Outstanding requests per worker:
179 152 168 160 196 190 184 163 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  111119.5,      555598,     500262,      55336,     417145,      83117,  12.489332,  24.200000,  30.300000,  34.900000,   8.262854,   0.063000,  47.182001, 665.656126
Outstanding requests per worker:
187 204 189 185 178 148 168 158 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  111120.1,      555601,     500134,      55467,     421028,      79106,  12.677355,  24.300000,  30.700000,  35.900000,   8.409241,   0.058000,  42.443998, 675.150148
Outstanding requests per worker:
155 186 185 203 187 202 133 159 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'7\r'
+ echo 'memcached pid is: 7'
memcached pid is: 7
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18032  2784 pts/0    Ss+  11:06   0:00 bash docker-ent
memcache     6  0.3  0.0  96652  6340 pts/0    S+   11:06   0:00 /usr/lib/linux-
memcache     7  143  0.0 276864 124360 pts/0   Sl+  11:06   1:06 memcached -t 2 
memcache    16  0.0  0.0  34424  2896 pts/1    Rs+  11:07   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       13367911047      instructions:u                                              
         161786159      LLC-loads                                                   
           3569486      LLC-load-misses           #    2.21% of all LL-cache hits   

      46.903628661 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 112000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 112000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 112000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,LLC-loads:u,LLC-load-misses:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,LLC-loads:u,LLC-load-misses:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,LLC-loads:u,LLC-load-misses:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,LLC-loads:u,LLC-load-misses:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 112000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 112000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 112000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 112000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 112000 cpus 8
meanInterarrival 71
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 2100131584
starting receive base loop
num_worker_connections 64
Creating worker on tid 1508521728
starting receive base loop
num_worker_connections 64
Creating worker on tid 912553728
starting receive base loop
num_worker_connections 64
Creating worker on tid 316585728
starting receive base loop
num_worker_connections 64
Creating worker on tid 4015585024
starting receive base loop
num_worker_connections 64
Creating worker on tid 3419617024
starting receive base loop
num_worker_connections 64
Creating worker on tid 2823649024
starting receive base loop
Created 512 connections total
Creating worker on tid 2227681024
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575372835.371260,       0.0,      333981,     300359,      33622,     199729,     100630,   4.224295,  15.800000,  20.600000,  32.900000,   7.921867,   0.000000, 187.576994, 480.438762
Outstanding requests per worker:
84 102 117 87 101 123 84 94 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  112701.7,      563509,     507004,      56505,     379374,     127630,   6.256629,  18.200000,  24.100000,  33.500000,   8.561900,   0.023000,  52.230000, 571.822974
Outstanding requests per worker:
69 121 81 94 81 87 78 94 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  112669.5,      563348,     507181,      56167,     398401,     108780,   6.701643,  19.500000,  26.200000,  35.800000,   9.272039,   0.022000,  86.044997, 612.557783
Outstanding requests per worker:
98 97 100 122 83 109 87 88 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  112678.1,      563391,     507010,      56381,     409004,      98006,   6.490363,  18.900000,  24.500000,  35.100000,   8.848021,   0.023000,  55.415001, 635.958212
Outstanding requests per worker:
87 109 77 116 102 99 90 118 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  112686.9,      563435,     506902,      56533,     416616,      90286,   6.733440,  19.700000,  25.100000,  37.100000,   9.204880,   0.023000,  54.719001, 653.260084
Outstanding requests per worker:
94 92 102 121 104 98 70 89 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  112695.7,      563479,     507142,      56337,     422742,      84400,   6.555368,  19.400000,  24.600000,  36.700000,   9.074898,   0.023000,  51.639002, 666.394566
Outstanding requests per worker:
94 101 67 105 64 88 87 104 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  112652.9,      563265,     507161,      56104,     427450,      79711,   7.834559,  22.900000,  30.100000,  42.600000,  10.845008,   0.023000,  85.359000, 676.113814
Outstanding requests per worker:
122 100 111 103 125 104 99 93 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.4  0.0  18032  2732 pts/0    Ss+  11:07   0:00 bash docker-ent
memcache     7  0.5  0.0  96652  6368 pts/0    S+   11:07   0:00 /usr/lib/linux-
memcache     8  130  0.0 279936 126416 pts/0   Sl+  11:07   1:01 memcached -t 2 
memcache    17  0.0  0.0  34424  2816 pts/1    Rs+  11:08   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       14219892151      instructions:u                                              
         160110900      LLC-loads                                                   
           3500521      LLC-load-misses           #    2.19% of all LL-cache hits   

      46.833254767 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 114000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 114000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 114000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,LLC-loads:u,LLC-load-misses:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,LLC-loads:u,LLC-load-misses:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,LLC-loads:u,LLC-load-misses:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,LLC-loads:u,LLC-load-misses:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 114000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 114000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 114000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 114000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 114000 cpus 8
meanInterarrival 70
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 4107933440
starting receive base loop
num_worker_connections 64
Creating worker on tid 3518772992
starting receive base loop
num_worker_connections 64
Creating worker on tid 2925819648
starting receive base loop
num_worker_connections 64
Creating worker on tid 2329851648
starting receive base loop
num_worker_connections 64
Creating worker on tid 1730569984
starting receive base loop
num_worker_connections 64
Creating worker on tid 1137915648
starting receive base loop
num_worker_connections 64
Creating worker on tid 541947648
starting receive base loop
Created 512 connections total
Creating worker on tid 4240946944
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575372884.371309,       0.0,      335676,     301749,      33927,     200269,     101480,   4.856488,  18.400000,  23.800000,  38.000000,   9.074040,   0.000000, 114.285000, 479.145293
Outstanding requests per worker:
90 122 78 84 101 83 85 105 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114208.7,      571044,     514373,      56671,     383998,     130375,   6.941749,  20.200000,  26.500000,  37.500000,   9.531362,   0.023000,  75.001001, 570.574538
Outstanding requests per worker:
167 129 172 144 141 139 151 135 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114374.9,      571875,     514871,      57004,     404807,     110064,   7.368306,  21.600000,  27.800000,  40.400000,  10.176064,   0.023000,  92.850000, 613.378227
Outstanding requests per worker:
94 72 77 110 106 102 124 95 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114241.3,      571207,     513877,      57330,     414900,      98977,   8.208056,  24.000000,  30.400000,  45.600000,  11.316347,   0.023000,  97.009003, 637.094723
Outstanding requests per worker:
146 94 142 120 155 113 133 133 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114291.7,      571459,     514400,      57059,     423850,      90550,   8.570009,  25.700000,  30.000000,  49.600000,  11.828117,   0.023000,  89.377999, 655.924248
Outstanding requests per worker:
143 138 125 110 119 143 134 128 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114292.9,      571465,     514224,      57241,     428937,      85287,   9.102915,  26.900000,  31.100000,  51.900000,  12.422788,   0.023000,  92.848003, 666.583526
Outstanding requests per worker:
120 138 113 166 143 124 134 109 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114298.1,      571491,     514468,      57023,     434007,      80461,   9.025719,  26.700000,  31.000000,  51.600000,  12.345269,   0.022000,  88.661000, 677.329476
Outstanding requests per worker:
135 108 134 133 140 132 131 103 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18032  2764 pts/0    Ss+  11:08   0:00 bash docker-ent
memcache     7  0.4  0.0  96652  6360 pts/0    S+   11:08   0:00 /usr/lib/linux-
memcache     8  130  0.0 279936 127524 pts/0   Sl+  11:08   1:01 memcached -t 2 
memcache    17 17.0  0.0  34424  2872 pts/1    Rs+  11:08   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       14437822173      instructions:u                                              
         158347233      LLC-loads                                                   
           3796092      LLC-load-misses           #    2.40% of all LL-cache hits   

      46.836368291 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 116000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 116000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 116000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,LLC-loads:u,LLC-load-misses:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,LLC-loads:u,LLC-load-misses:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,LLC-loads:u,LLC-load-misses:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,LLC-loads:u,LLC-load-misses:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 116000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 116000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 116000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 116000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 116000 cpus 8
meanInterarrival 68
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 3266397952
starting receive base loop
num_worker_connections 64
Creating worker on tid 2673407744
starting receive base loop
num_worker_connections 64
Creating worker on tid 2077439744
starting receive base loop
num_worker_connections 64
Creating worker on tid 1481471744
starting receive base loop
num_worker_connections 64
Creating worker on tid 885503744
starting receive base loop
num_worker_connections 64
Creating worker on tid 289535744
starting receive base loop
num_worker_connections 64
Creating worker on tid 3991549696
starting receive base loop
Created 512 connections total
Creating worker on tid 3396531968
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575372933.371358,       0.0,      346983,     312467,      34516,     207936,     104531,   6.003116,  23.300000,  30.400000,  50.100000,  11.373045,   0.000000, 161.302999, 481.868735
Outstanding requests per worker:
142 169 116 189 139 149 182 147 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117673.5,      588368,     529541,      58827,     397149,     132392,   9.450699,  28.100000,  32.300000,  54.200000,  12.921793,   0.023000,  97.211003, 573.677506
Outstanding requests per worker:
149 171 150 169 137 128 115 126 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117651.9,      588260,     529450,      58810,     417172,     112278,  10.212935,  30.100000,  34.800000,  58.600000,  14.005123,   0.023000, 117.415003, 616.004508
Outstanding requests per worker:
152 149 137 135 156 157 134 147 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117647.7,      588239,     529047,      59192,     428476,     100571,   9.944217,  29.500000,  33.600000,  57.600000,  13.595788,   0.023000, 100.578003, 640.173094
Outstanding requests per worker:
136 130 141 142 192 161 146 139 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117642.5,      588213,     529683,      58530,     437532,      92151,  11.382015,  32.800000,  42.600000,  66.300000,  16.115519,   0.023000, 140.468001, 657.023252
Outstanding requests per worker:
158 159 123 185 149 163 147 156 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117654.9,      588275,     529559,      58716,     442955,      86604,  10.115714,  30.300000,  34.600000,  59.300000,  13.950893,   0.023000, 107.242003, 668.812516
Outstanding requests per worker:
194 134 147 161 125 186 155 138 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117671.9,      588360,     529678,      58682,     448029,      81649,  10.421524,  31.100000,  35.600000,  61.000000,  14.337274,   0.022000, 109.085001, 679.183432
Outstanding requests per worker:
141 120 167 164 121 138 136 158 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'7\r'
+ echo 'memcached pid is: 7'
memcached pid is: 7
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.4  0.0  18032  2760 pts/0    Ss+  11:09   0:00 bash docker-ent
memcache     6  0.5  0.0  96652  6244 pts/0    S+   11:09   0:00 /usr/lib/linux-
memcache     7  134  0.0 281984 130536 pts/0   Sl+  11:09   1:01 memcached -t 2 
memcache    16  0.0  0.0  34424  2812 pts/1    Rs+  11:09   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       14740673321      instructions:u                                              
         175531377      LLC-loads                                                   
           3943297      LLC-load-misses           #    2.25% of all LL-cache hits   

      46.852530292 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 118000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 118000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 118000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,LLC-loads:u,LLC-load-misses:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,LLC-loads:u,LLC-load-misses:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,LLC-loads:u,LLC-load-misses:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,LLC-loads:u,LLC-load-misses:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 118000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 118000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 118000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 118000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 118000 cpus 8
meanInterarrival 67
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 2005407488
starting receive base loop
num_worker_connections 64
Creating worker on tid 1414137600
starting receive base loop
num_worker_connections 64
Creating worker on tid 818394880
starting receive base loop
num_worker_connections 64
Creating worker on tid 222426880
starting receive base loop
num_worker_connections 64
Creating worker on tid 3924440832
starting receive base loop
num_worker_connections 64
Creating worker on tid 3328472832
starting receive base loop
num_worker_connections 64
Creating worker on tid 2732504832
starting receive base loop
Created 512 connections total
Creating worker on tid 2136536832
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575372982.371407,       0.0,      351071,     316115,      34956,     210873,     105242,   6.324540,  23.800000,  30.200000,  52.200000,  13.783536,   0.000000, 412.479013, 482.372662
Outstanding requests per worker:
151 144 151 156 154 155 127 124 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  119417.3,      597087,     537780,      59307,     402731,     135049,  10.035544,  29.800000,  34.300000,  58.000000,  13.787718,   0.023000, 111.702003, 572.806538
Outstanding requests per worker:
179 119 110 149 149 121 157 156 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  119398.9,      596995,     537446,      59549,     423359,     114087,  10.761325,  31.600000,  37.300000,  62.100000,  14.879371,   0.023000, 128.595993, 615.308634
Outstanding requests per worker:
188 137 153 132 166 143 135 158 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  119161.5,      595808,     536246,      59562,     434174,     102072,  11.361974,  32.500000,  42.600000,  65.800000,  16.338795,   0.023000, 161.442995, 639.621304
Outstanding requests per worker:
321 338 299 305 310 291 279 308 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  118229.5,      591148,     531845,      59303,     438856,      92989,  40.733515, 121.000000, 142.900000, 193.400000,  53.247186,   0.024000, 307.283998, 656.273510
Outstanding requests per worker:
1052 998 1038 1156 960 1103 1047 999 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  118292.7,      591464,     532063,      59401,     445150,      86913,  94.646292, 243.800000, 277.300000, 333.400000, 105.745141,   0.023000, 542.936981, 669.389097
Outstanding requests per worker:
1694 1701 1741 1897 1638 1705 1802 1774 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  118346.1,      591731,     532414,      59317,     450050,      82364, 135.821427, 341.600000, 384.600000, 475.000000, 149.614012,   0.023000, 755.131006, 679.126471
Outstanding requests per worker:
2327 2339 2397 2516 2581 2406 2494 2207 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'9\r'
+ echo 'memcached pid is: 9'
memcached pid is: 9
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18032  2768 pts/0    Ss+  11:09   0:00 bash docker-ent
memcache     8  0.4  0.0  96652  6368 pts/0    S+   11:09   0:00 /usr/lib/linux-
memcache     9  135  0.0 283008 135736 pts/0   Sl+  11:09   1:02 memcached -t 2 
memcache    19  0.0  0.0  34424  2860 pts/1    Rs+  11:10   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       15009473329      instructions:u                                              
         166210624      LLC-loads                                                   
           6595033      LLC-load-misses           #    3.97% of all LL-cache hits   

      46.802096142 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 120000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 120000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 120000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,LLC-loads:u,LLC-load-misses:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,LLC-loads:u,LLC-load-misses:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,LLC-loads:u,LLC-load-misses:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,LLC-loads:u,LLC-load-misses:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 120000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 120000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 120000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 120000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 120000 cpus 8
meanInterarrival 66
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 2223240960
starting receive base loop
num_worker_connections 64
Creating worker on tid 1631713024
starting receive base loop
num_worker_connections 64
Creating worker on tid 1032431360
starting receive base loop
num_worker_connections 64
Creating worker on tid 442791680
starting receive base loop
num_worker_connections 64
Creating worker on tid 4141790976
starting receive base loop
num_worker_connections 64
Creating worker on tid 3545822976
starting receive base loop
num_worker_connections 64
Creating worker on tid 2949854976
starting receive base loop
Created 512 connections total
Creating worker on tid 2353886976
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575373030.371455,       0.0,      350873,     316028,      34845,     211662,     104366,  18.153164,  72.400000, 101.700000, 139.700000,  36.476577,   0.000000, 509.252012, 485.072734
Outstanding requests per worker:
634 663 723 618 740 645 677 612 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  119168.7,      595844,     536393,      59451,     401859,     134534,  84.907123, 226.600000, 267.000000, 335.500000,  99.493187,   0.023000, 609.076023, 572.863813
Outstanding requests per worker:
1939 2015 1942 1800 1922 1917 2080 1964 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  119471.9,      597360,     537858,      59502,     423755,     114103, 162.000027, 405.200000, 462.000000, 565.800000, 178.750555,   0.023000, 843.599975, 615.157172
Outstanding requests per worker:
2949 3240 3046 2907 3147 2958 2891 3197 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  118744.3,      593722,     534367,      59355,     432556,     101811, 241.296539, 614.400000, 703.500000, 857.700000, 268.637680,   0.023000, 1175.294995, 639.159183
Outstanding requests per worker:
4274 4766 4650 4646 4544 4396 4598 4833 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  118329.9,      591650,     532311,      59339,     439029,      93282, 353.584672, 899.700000, 1007.500000, 1214.200000, 391.648149,   0.023000, 1591.878057, 656.181653
Outstanding requests per worker:
6112 6750 6445 6621 6328 6124 6315 6459 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  118089.5,      590448,     531330,      59118,     444370,      86960, 473.113557, 1182.600000, 1318.500000, 1571.300000, 520.392274,   0.024000, 2024.660110, 668.749372
Outstanding requests per worker:
8142 8690 8165 8565 8394 8131 8247 8490 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  132170.7,      660854,     594957,      65897,     503224,      91733, 440.506752, 1253.400000, 1426.200000, 1698.800000, 523.137291,   0.023000, 2294.387102, 679.314850
Outstanding requests per worker:
1392 1639 1453 1505 1552 1521 1574 1435 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18032  2860 pts/0    Ss+  11:10   0:00 bash docker-ent
memcache     7  0.4  0.0  96652  6316 pts/0    S+   11:10   0:00 /usr/lib/linux-
memcache     8  132  0.0 283008 140736 pts/0   Sl+  11:10   1:02 memcached -t 2 
memcache    17  0.0  0.0  34424  2908 pts/1    Rs+  11:11   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       15220189749      instructions:u                                              
         168160480      LLC-loads                                                   
          11948876      LLC-load-misses           # [33m   7.11%[m of all LL-cache hits   

      46.813639412 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 122000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 122000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 122000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,LLC-loads:u,LLC-load-misses:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,LLC-loads:u,LLC-load-misses:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,LLC-loads:u,LLC-load-misses:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,LLC-loads:u,LLC-load-misses:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 122000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 122000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 122000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 122000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 122000 cpus 8
meanInterarrival 65
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 3147532032
starting receive base loop
num_worker_connections 64
Creating worker on tid 2555213568
starting receive base loop
num_worker_connections 64
Creating worker on tid 1959245568
starting receive base loop
num_worker_connections 64
Creating worker on tid 1363277568
starting receive base loop
num_worker_connections 64
Creating worker on tid 770324224
starting receive base loop
num_worker_connections 64
Creating worker on tid 174356224
starting receive base loop
num_worker_connections 64
Creating worker on tid 3873355520
starting receive base loop
Created 512 connections total
Creating worker on tid 3277387520
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575373079.371504,       0.0,      356232,     320557,      35675,     213545,     107012,  20.518735,  83.200000, 112.200000, 165.300000,  42.044928,   0.000000, 582.490981, 481.785246
Outstanding requests per worker:
646 752 774 749 784 753 782 792 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  123311.5,      616558,     554775,      61783,     416801,     137974,  97.808131, 266.300000, 309.800000, 392.000000, 113.636682,   0.024000, 561.269999, 575.050356
Outstanding requests per worker:
549 575 660 547 709 681 537 658 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121338.3,      606692,     545936,      60756,     430915,     115021,  48.971286, 170.900000, 210.600000, 284.700000,  74.489775,   0.023000, 484.456986, 617.576996
Outstanding requests per worker:
1749 1821 1631 1687 1796 1514 1715 1745 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  120260.9,      601305,     540739,      60566,     438532,     102207, 163.651876, 422.400000, 480.600000, 594.600000, 184.591364,   0.024000, 935.410023, 640.935277
Outstanding requests per worker:
3684 3429 3408 3484 3560 3306 3260 3646 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  125274.7,      626374,     563728,      62646,     465937,      97791, 266.492266, 682.500000, 764.700000, 911.300000, 293.780376,   0.024000, 1301.844001, 657.939614
Outstanding requests per worker:
2128 2060 2088 1947 2200 2198 1970 2231 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  120133.7,      600669,     540709,      59960,     453985,      86724, 189.109433, 493.400000, 581.800000, 764.500000, 219.424228,   0.024000, 1073.132038, 672.232406
Outstanding requests per worker:
3986 3981 4134 3683 3869 4136 3836 3968 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  119846.5,      599233,     539372,      59861,     456860,      82512, 312.235097, 796.900000, 927.400000, 1131.600000, 350.940797,   0.023000, 1490.090966, 680.775155
Outstanding requests per worker:
5990 6150 6044 6088 5823 5980 5731 5969 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18032  2864 pts/0    Ss+  11:11   0:00 bash docker-ent
memcache     7  0.4  0.0  96652  6368 pts/0    S+   11:11   0:00 /usr/lib/linux-
memcache     8  133  0.0 284032 143428 pts/0   Sl+  11:11   1:02 memcached -t 2 
memcache    17 18.0  0.0  34424  2872 pts/1    Rs+  11:12   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       15314714798      instructions:u                                              
         169745907      LLC-loads                                                   
          10956705      LLC-load-misses           # [33m   6.45%[m of all LL-cache hits   

      46.860688772 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 124000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 124000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 124000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,LLC-loads:u,LLC-load-misses:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,LLC-loads:u,LLC-load-misses:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,LLC-loads:u,LLC-load-misses:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,LLC-loads:u,LLC-load-misses:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 124000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 124000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 124000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 124000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 124000 cpus 8
meanInterarrival 64
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 4045219584
starting receive base loop
num_worker_connections 64
Creating worker on tid 3451664128
starting receive base loop
num_worker_connections 64
Creating worker on tid 2858710784
starting receive base loop
num_worker_connections 64
Creating worker on tid 2262742784
starting receive base loop
num_worker_connections 64
Creating worker on tid 1666774784
starting receive base loop
num_worker_connections 64
Creating worker on tid 1070806784
starting receive base loop
num_worker_connections 64
Creating worker on tid 474838784
starting receive base loop
Created 512 connections total
Creating worker on tid 4173838080
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575373128.371553,       0.0,      369258,     332371,      36887,     222926,     109445,  17.014444,  70.200000, 102.300000, 139.600000,  34.004902,   0.000000, 219.347000, 486.726547
Outstanding requests per worker:
65 55 48 61 62 49 70 66 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121832.5,      609163,     548323,      60840,     412233,     136090,  70.795763, 221.600000, 271.100000, 347.400000,  96.523087,   0.022000, 578.061998, 575.802108
Outstanding requests per worker:
1978 2001 2118 2066 2038 1995 2056 2112 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121729.1,      608646,     548070,      60576,     432949,     115121, 189.383538, 487.900000, 562.000000, 701.500000, 214.255376,   0.024000, 1001.768947, 617.361791
Outstanding requests per worker:
4093 3723 4376 3913 3983 4167 4344 4162 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  120982.9,      604915,     544648,      60267,     441849,     102799, 324.934358, 825.400000, 921.900000, 1103.400000, 361.906360,   0.023000, 1540.413022, 641.142274
Outstanding requests per worker:
6560 6327 7002 6494 6512 6580 6831 6570 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  120572.3,      602862,     542371,      60491,     447715,      94656, 491.426335, 1215.500000, 1326.800000, 1595.300000, 537.471444,   0.023000, 1932.211995, 656.772646
Outstanding requests per worker:
9147 9512 9811 9403 9032 9403 9606 9130 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  124040.1,      620201,     558594,      61607,     468165,      90429, 623.581195, 1482.800000, 1619.800000, 1839.600000, 656.238024,   0.023000, 2216.211081, 671.158210
Outstanding requests per worker:
9895 10007 10575 10235 9342 9955 10195 9685 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  120244.3,      601222,     541311,      59911,     458525,      82786, 706.888355, 1743.400000, 1905.800000, 2197.500000, 772.511731,   0.024000, 2637.738943, 680.642159
Outstanding requests per worker:
12888 13037 13495 13002 12415 13109 13258 12490 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18032  2860 pts/0    Ss+  11:12   0:00 bash docker-ent
memcache     7  0.5  0.0  96652  6368 pts/0    S+   11:12   0:00 /usr/lib/linux-
memcache     8  136  0.0 284032 137972 pts/0   Sl+  11:12   1:02 memcached -t 2 
memcache    17  0.0  0.0  34424  2920 pts/1    Rs+  11:13   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       15342392674      instructions:u                                              
         169703066      LLC-loads                                                   
          11906018      LLC-load-misses           # [33m   7.02%[m of all LL-cache hits   

      46.943998556 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 126000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 126000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 126000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,LLC-loads:u,LLC-load-misses:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,LLC-loads:u,LLC-load-misses:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,LLC-loads:u,LLC-load-misses:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,LLC-loads:u,LLC-load-misses:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 126000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 126000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 126000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 126000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 126000 cpus 8
meanInterarrival 63
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 4063958784
starting receive base loop
num_worker_connections 64
Creating worker on tid 3470702336
starting receive base loop
num_worker_connections 64
Creating worker on tid 2874734336
starting receive base loop
num_worker_connections 64
Creating worker on tid 2278766336
starting receive base loop
num_worker_connections 64
Creating worker on tid 1682798336
starting receive base loop
num_worker_connections 64
Creating worker on tid 1086830336
starting receive base loop
num_worker_connections 64
Creating worker on tid 490862336
starting receive base loop
Created 512 connections total
Creating worker on tid 4192876288
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575373177.371602,       0.0,      361781,     325604,      36177,     217276,     108328,  28.223997, 115.400000, 147.400000, 212.900000,  59.487908,   0.000000, 724.050999, 483.611384
Outstanding requests per worker:
1277 1162 1146 1206 1157 1124 1231 1605 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  122715.7,      613579,     552203,      61376,     414838,     137365, 156.284606, 424.500000, 488.500000, 625.400000, 184.786289,   0.023000, 977.514982, 575.048826
Outstanding requests per worker:
3747 3866 3823 4110 3877 3611 4081 4192 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  124526.1,      622631,     560094,      62537,     442276,     117818, 333.521491, 827.100000, 930.700000, 1114.400000, 361.182861,   0.023000, 1435.624003, 617.636434
Outstanding requests per worker:
5367 5623 5163 5688 5229 5044 5766 5775 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  131107.3,      655537,     589914,      65623,     479257,     110657, 146.564465, 404.900000, 542.200000, 794.100000, 188.842901,   0.023000, 1247.568011, 642.695111
Outstanding requests per worker:
2828 2848 2878 2992 2743 2937 2905 2954 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  122088.7,      610444,     549489,      60955,     454554,      94935, 265.905706, 698.100000, 782.100000, 917.700000, 300.272106,   0.023000, 1262.593031, 658.849293
Outstanding requests per worker:
5953 5906 5848 5924 6042 5954 5936 6029 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  123855.1,      619276,     557365,      61911,     467330,      90035, 387.190459, 961.500000, 1058.800000, 1249.400000, 422.556916,   0.023000, 1785.630941, 671.380454
Outstanding requests per worker:
7672 8297 7744 7796 7595 8046 7893 8246 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  135501.3,      677507,     609793,      67714,     517003,      92790, 407.252621, 1142.600000, 1261.800000, 1473.800000, 458.102689,   0.023000, 2041.157961, 681.690256
Outstanding requests per worker:
2616 2564 2604 2629 2602 2523 2609 2590 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'7\r'
+ echo 'memcached pid is: 7'
memcached pid is: 7
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18032  2768 pts/0    Ss+  11:13   0:00 bash docker-ent
memcache     6  0.4  0.0  96652  6384 pts/0    S+   11:13   0:00 /usr/lib/linux-
memcache     7  137  0.0 288128 148792 pts/0   Sl+  11:13   1:03 memcached -t 2 
memcache    16  0.0  0.0  34424  2820 pts/1    Rs+  11:13   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       15881010862      instructions:u                                              
         180284846      LLC-loads                                                   
          13210962      LLC-load-misses           # [33m   7.33%[m of all LL-cache hits   

      46.756554083 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 128000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 128000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 128000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,LLC-loads:u,LLC-load-misses:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,LLC-loads:u,LLC-load-misses:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,LLC-loads:u,LLC-load-misses:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,LLC-loads:u,LLC-load-misses:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 128000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 128000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 128000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 128000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 128000 cpus 8
meanInterarrival 62
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 2748770048
starting receive base loop
num_worker_connections 64
Creating worker on tid 2152560384
starting receive base loop
num_worker_connections 64
Creating worker on tid 1556592384
starting receive base loop
num_worker_connections 64
Creating worker on tid 960624384
starting receive base loop
num_worker_connections 64
Creating worker on tid 367671040
starting receive base loop
num_worker_connections 64
Creating worker on tid 4066670336
starting receive base loop
num_worker_connections 64
Creating worker on tid 3470702336
starting receive base loop
Created 512 connections total
Creating worker on tid 2874734336
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575373226.371651,       0.0,      366405,     330014,      36391,     220951,     109063,  33.523027, 137.300000, 176.000000, 254.500000,  65.589847,   0.000000, 636.415005, 484.551734
Outstanding requests per worker:
1576 1552 1570 1448 1504 1526 1568 1729 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  126457.3,      632287,     568959,      63328,     428878,     140081, 102.350221, 310.200000, 371.000000, 467.900000, 132.323168,   0.023000, 698.651016, 577.683993
Outstanding requests per worker:
3015 3311 3175 3115 3196 3228 3170 3193 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  129510.7,      647554,     582849,      64705,     461374,     121475, 144.951824, 412.800000, 487.100000, 622.900000, 174.501628,   0.023000, 864.821970, 619.461727
Outstanding requests per worker:
2757 2892 2958 2744 2876 3053 2856 2943 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  123292.5,      616463,     555149,      61314,     451202,     103947, 273.407771, 719.600000, 813.700000, 969.500000, 311.604809,   0.024000, 1335.755944, 642.853501
Outstanding requests per worker:
6305 6272 6532 6464 6509 6608 6744 6380 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  122630.1,      613151,     552221,      60930,     457341,      94880, 488.363682, 1207.500000, 1317.000000, 1515.100000, 537.038008,   0.024000, 1929.841995, 659.525768
Outstanding requests per worker:
10108 10223 10661 10179 10908 10673 10555 10554 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121948.5,      609743,     548570,      61173,     460029,      88541, 739.341463, 1793.900000, 1935.900000, 2167.300000, 807.570585,   0.023000, 2567.585945, 671.612079
Outstanding requests per worker:
14581 14678 14880 14225 15503 15317 15101 15047 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  122015.1,      610076,     548634,      61442,     465052,      83582, 1000.748756, 2368.500000, 2513.300000, 2796.300000, 1080.536534,   0.024000, 3182.796001, 681.783340
Outstanding requests per worker:
19077 19076 19090 18493 19724 19910 19372 19717 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'7\r'
+ echo 'memcached pid is: 7'
memcached pid is: 7
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.4  0.0  18032  2852 pts/0    Ss+  11:13   0:00 bash docker-ent
memcache     6  0.4  0.0  96652  6392 pts/0    S+   11:13   0:00 /usr/lib/linux-
memcache     7  137  0.0 285056 145112 pts/0   Sl+  11:13   1:03 memcached -t 2 
memcache    16  0.0  0.0  34424  2912 pts/1    Rs+  11:14   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       15639477979      instructions:u                                              
         177472890      LLC-loads                                                   
          12049470      LLC-load-misses           # [33m   6.79%[m of all LL-cache hits   

      46.934629563 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 130000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 130000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 130000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,LLC-loads:u,LLC-load-misses:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,LLC-loads:u,LLC-load-misses:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,LLC-loads:u,LLC-load-misses:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,LLC-loads:u,LLC-load-misses:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 130000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 130000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 130000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 130000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 130000 cpus 8
meanInterarrival 61
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 2038621952
starting receive base loop
num_worker_connections 64
Creating worker on tid 1447352064
starting receive base loop
num_worker_connections 64
Creating worker on tid 853456640
starting receive base loop
num_worker_connections 64
Creating worker on tid 257488640
starting receive base loop
num_worker_connections 64
Creating worker on tid 3953174272
starting receive base loop
num_worker_connections 64
Creating worker on tid 3360519936
starting receive base loop
num_worker_connections 64
Creating worker on tid 2764551936
starting receive base loop
Created 512 connections total
Creating worker on tid 2168583936
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575373274.371699,       0.0,      373020,     335492,      37528,     224625,     110867,  27.622680, 122.500000, 160.400000, 215.600000,  54.766783,   0.000000, 391.815007, 486.336390
Outstanding requests per worker:
1623 1467 1472 1518 1551 1462 1492 1622 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  124593.5,      622968,     560923,      62045,     421322,     139601, 207.833840, 581.700000, 671.300000, 811.700000, 248.703694,   0.023000, 1031.525016, 575.394364
Outstanding requests per worker:
5929 5464 5381 5607 5541 5765 5593 5765 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  123201.5,      616008,     554392,      61616,     438032,     116360, 460.319628, 1175.000000, 1288.900000, 1468.200000, 516.032786,   0.024000, 1884.418964, 618.068450
Outstanding requests per worker:
11215 10115 10560 10644 10573 10543 10491 10699 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  123431.1,      617156,     555557,      61599,     450905,     104652, 737.091152, 1788.600000, 1927.700000, 2157.000000, 805.708045,   0.023000, 2594.383001, 641.717493
Outstanding requests per worker:
15967 15109 15324 15404 15761 15400 15178 15317 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  122288.3,      611442,     550180,      61262,     454883,      95297, 1026.967413, 2477.500000, 2626.600000, 2894.200000, 1125.550867,   0.024000, 3418.967009, 658.045703
Outstanding requests per worker:
21379 20557 20784 21297 21225 21036 20558 20966 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  122247.1,      611236,     550276,      60960,     461467,      88809, 1344.103272, 3175.000000, 3351.300000, 3641.000000, 1464.807903,   0.024000, 4322.923183, 671.149474
Outstanding requests per worker:
26685 25989 26301 26674 27026 26479 26275 26927 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  149124.3,      745622,     671163,      74459,     568621,     102542, 1585.283484, 3192.600000, 3423.900000, 3750.400000, 1208.930973,   0.024000, 4503.521919, 681.683077
Outstanding requests per worker:
15446 14994 15055 15572 15723 15174 15004 15549 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18032  2768 pts/0    Ss+  11:14   0:00 bash docker-ent
memcache     7  0.5  0.0  96652  6340 pts/0    S+   11:14   0:00 /usr/lib/linux-
memcache     8  136  0.0 288128 148348 pts/0   Sl+  11:14   1:03 memcached -t 2 
memcache    17  0.0  0.0  34424  2852 pts/1    Rs+  11:15   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       15931842292      instructions:u                                              
         169158824      LLC-loads                                                   
          14664249      LLC-load-misses           # [33m   8.67%[m of all LL-cache hits   

      46.860520160 seconds time elapsed

