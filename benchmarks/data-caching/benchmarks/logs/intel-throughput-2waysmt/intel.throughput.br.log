+ for keys in '$KEYS'
+ for conns in '$CONNS'
+ for threads in '$THREADS'
+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 104000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 104000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 104000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,branch-misses:u,branch-instructions:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,branch-misses:u,branch-instructions:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,branch-misses:u,branch-instructions:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,branch-misses:u,branch-instructions:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 104000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 104000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 104000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 104000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 104000 cpus 4
meanInterarrival 38
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 2342143744
starting receive base loop
num_worker_connections 128
Creating worker on tid 1237153536
starting receive base loop
num_worker_connections 128
Creating worker on tid 131364608
starting receive base loop
Created 512 connections total
Creating worker on tid 3317528320
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575373322.371747,       0.0,      242134,     217932,      24202,     141224,      76708,   3.294860,   9.900000,  14.700000,  26.300000,   5.484530,   0.000000,  51.771998, 462.712461
Outstanding requests per worker:
57 44 52 54 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  105267.9,      526340,     473602,      52738,     348738,     124864,   2.578675,   7.700000,   9.100000,  12.000000,   3.272419,   0.033000,  19.644000, 557.633004
Outstanding requests per worker:
70 42 55 58 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  105254.9,      526275,     473867,      52408,     368610,     105257,   2.605813,   7.900000,   9.400000,  11.400000,   3.267253,   0.032000,  17.197000, 604.349560
Outstanding requests per worker:
83 66 58 83 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  105270.9,      526355,     473792,      52563,     378984,      94808,   2.729352,   8.400000,   9.600000,  12.100000,   3.461341,   0.032000,  20.245001, 629.405490
Outstanding requests per worker:
70 67 75 82 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  105272.5,      526363,     473732,      52631,     386880,      86852,   2.624980,   8.200000,   9.400000,  11.000000,   3.275497,   0.032000,  14.225000, 648.368352
Outstanding requests per worker:
74 68 65 63 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  105277.3,      526387,     473753,      52634,     392816,      80937,   3.036418,   9.200000,  10.900000,  14.600000,   3.970553,   0.032000,  25.960000, 660.461367
Outstanding requests per worker:
62 60 63 56 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  105263.5,      526318,     474005,      52313,     397757,      76248,   2.725321,   8.500000,   9.800000,  11.800000,   3.423087,   0.032000,  14.878000, 671.827601
Outstanding requests per worker:
70 52 68 78 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'7\r'
+ echo 'memcached pid is: 7'
memcached pid is: 7
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.4  0.0  18028  2856 pts/0    Ss+  11:15   0:00 bash docker-ent
memcache     6  0.4  0.0  96552  6500 pts/0    S+   11:15   0:00 /usr/lib/linux-
memcache     7  127  0.0 271744 117832 pts/0   Sl+  11:15   0:58 memcached -t 2 
memcache    16  0.0  0.0  34424  2896 pts/1    Rs+  11:16   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       13081595413      instructions:u                                              
         112446467      branch-misses:u           # [33m   6.13%[m of all branches        
        1835592150      branch-instructions:u                                       

      45.779509139 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 106000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 106000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 106000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,branch-misses:u,branch-instructions:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,branch-misses:u,branch-instructions:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,branch-misses:u,branch-instructions:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,branch-misses:u,branch-instructions:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 106000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 106000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 106000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 106000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 106000 cpus 4
meanInterarrival 37
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 2246170368
starting receive base loop
num_worker_connections 128
Creating worker on tid 1137997568
starting receive base loop
num_worker_connections 128
Creating worker on tid 29193984
starting receive base loop
Created 512 connections total
Creating worker on tid 3216226048
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575373370.371795,       0.0,      249476,     224586,      24890,     145774,      78812,   3.779369,  11.800000,  16.700000,  29.100000,   6.422486,   0.000000,  56.444000, 462.430819
Outstanding requests per worker:
81 82 84 82 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108119.3,      540597,     486493,      54104,     357621,     128872,   3.120447,   9.500000,  11.400000,  14.700000,   4.030479,   0.033000,  34.867000, 557.814201
Outstanding requests per worker:
91 75 75 75 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108096.3,      540482,     486231,      54251,     378508,     107723,   3.228854,  10.200000,  11.900000,  14.300000,   4.147883,   0.033000,  25.658000, 605.597634
Outstanding requests per worker:
93 100 111 101 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108122.1,      540611,     486624,      53987,     390587,      96037,   3.248483,  10.100000,  12.200000,  14.700000,   4.158929,   0.032000,  19.148000, 631.846619
Outstanding requests per worker:
94 85 101 95 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108114.5,      540573,     486798,      53775,     398283,      88515,   3.578447,  11.100000,  13.500000,  16.700000,   4.658826,   0.032000,  28.534001, 649.652936
Outstanding requests per worker:
85 101 80 103 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108109.9,      540550,     486527,      54023,     403901,      82626,   3.429689,  10.600000,  12.900000,  15.600000,   4.401758,   0.033000,  19.584000, 662.015565
Outstanding requests per worker:
107 71 109 114 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108115.9,      540580,     486419,      54161,     408734,      77685,   3.503345,  10.900000,  13.300000,  15.800000,   4.497934,   0.032000,  20.204000, 672.947549
Outstanding requests per worker:
94 89 115 90 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18028  2864 pts/0    Ss+  11:16   0:00 bash docker-ent
memcache     7  0.4  0.0  96552  6384 pts/0    S+   11:16   0:00 /usr/lib/linux-
memcache     8  130  0.0 273792 120588 pts/0   Sl+  11:16   0:58 memcached -t 2 
memcache    17  0.0  0.0  34424  2824 pts/1    Rs+  11:17   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       13464452785      instructions:u                                              
         115170028      branch-misses:u           # [33m   6.14%[m of all branches        
        1874938496      branch-instructions:u                                       

      45.837946985 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 108000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 108000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 108000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,branch-misses:u,branch-instructions:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,branch-misses:u,branch-instructions:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,branch-misses:u,branch-instructions:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,branch-misses:u,branch-instructions:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 108000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 108000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 108000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 108000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 108000 cpus 4
meanInterarrival 37
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 2323044096
starting receive base loop
num_worker_connections 128
Creating worker on tid 1219020544
starting receive base loop
num_worker_connections 128
Creating worker on tid 112326400
starting receive base loop
Created 512 connections total
Creating worker on tid 3301504768
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575373418.371843,       0.0,      247668,     222809,      24859,     144834,      77975,   4.572775,  14.700000,  21.600000,  36.900000,   7.802645,   0.000000,  78.643002, 464.231499
Outstanding requests per worker:
89 90 94 87 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108127.5,      540638,     486475,      54163,     358900,     127575,   3.260602,  10.100000,  11.900000,  15.000000,   4.222399,   0.032000,  24.930000, 560.820971
Outstanding requests per worker:
80 71 79 76 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108109.1,      540546,     486763,      53783,     379010,     107753,   3.180395,   9.800000,  11.700000,  15.000000,   4.122809,   0.033000,  26.009999, 605.139742
Outstanding requests per worker:
71 80 90 84 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108116.7,      540584,     486113,      54471,     389440,      96673,   3.274772,  10.300000,  12.300000,  14.500000,   4.177721,   0.032000,  18.595999, 630.210714
Outstanding requests per worker:
93 86 79 68 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108111.9,      540560,     486847,      53713,     397626,      89221,   3.530311,  10.900000,  13.200000,  16.600000,   4.620468,   0.033000,  29.944999, 648.021461
Outstanding requests per worker:
87 81 90 74 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108104.7,      540524,     486202,      54322,     403305,      82897,   3.417595,  10.800000,  13.000000,  15.000000,   4.366289,   0.033000,  18.891999, 661.333160
Outstanding requests per worker:
100 84 124 83 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108120.3,      540602,     486657,      53945,     408811,      77846,   3.390437,  10.600000,  12.800000,  15.400000,   4.352800,   0.033000,  18.736999, 672.323172
Outstanding requests per worker:
81 103 82 92 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18028  2880 pts/0    Ss+  11:17   0:00 bash docker-ent
memcache     7  0.4  0.0  96552  6488 pts/0    S+   11:17   0:00 /usr/lib/linux-
memcache     8  131  0.0 273792 119860 pts/0   Sl+  11:17   0:59 memcached -t 2 
memcache    18  0.0  0.0  34424  2852 pts/1    Rs+  11:17   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       13373758547      instructions:u                                              
         115012536      branch-misses:u           # [33m   6.16%[m of all branches        
        1867017565      branch-instructions:u                                       

      45.786629964 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 110000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 110000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 110000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,branch-misses:u,branch-instructions:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,branch-misses:u,branch-instructions:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,branch-misses:u,branch-instructions:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,branch-misses:u,branch-instructions:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 110000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 110000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 110000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 110000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 110000 cpus 4
meanInterarrival 36
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 485070592
starting receive base loop
num_worker_connections 128
Creating worker on tid 3677107968
starting receive base loop
num_worker_connections 128
Creating worker on tid 2571319040
starting receive base loop
Created 512 connections total
Creating worker on tid 1459283712
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575373466.371891,       0.0,      255088,     229465,      25623,     149712,      79753,   5.824569,  18.500000,  26.400000,  43.100000,   9.872125,   0.000000, 115.033999, 466.311869
Outstanding requests per worker:
131 116 126 125 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  111139.5,      555698,     500122,      55576,     369984,     130138,   4.360679,  13.100000,  16.900000,  21.700000,   5.758063,   0.033000,  30.944999, 561.653325
Outstanding requests per worker:
101 106 93 98 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  111097.9,      555490,     500100,      55390,     390408,     109692,   4.528420,  13.600000,  17.500000,  22.300000,   6.010240,   0.033000,  38.649999, 607.434819
Outstanding requests per worker:
124 112 138 123 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  111121.7,      555609,     500230,      55379,     402065,      98165,   4.365051,  12.900000,  17.300000,  21.300000,   5.750403,   0.033000,  26.727000, 632.930140
Outstanding requests per worker:
135 123 108 120 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  111096.5,      555483,     499893,      55590,     409942,      89951,   4.906757,  14.600000,  19.100000,  24.600000,   6.563890,   0.033000,  41.189998, 650.418908
Outstanding requests per worker:
128 160 139 158 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  111139.9,      555700,     499835,      55865,     415511,      84324,   4.748379,  13.900000,  18.700000,  23.500000,   6.257359,   0.033000,  29.324001, 663.632071
Outstanding requests per worker:
112 111 133 128 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  111100.5,      555503,     499719,      55784,     420198,      79521,   4.785300,  13.900000,  18.900000,  23.400000,   6.297535,   0.034000,  29.401001, 673.567001
Outstanding requests per worker:
121 158 141 144 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18028  2788 pts/0    Ss+  11:17   0:00 bash docker-ent
memcache     7  0.4  0.0  96552  6420 pts/0    S+   11:17   0:00 /usr/lib/linux-
memcache     8  132  0.0 275840 123164 pts/0   Sl+  11:17   0:59 memcached -t 2 
memcache    18  0.0  0.0  34424  2860 pts/1    Rs+  11:18   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       13787071878      instructions:u                                              
         117268745      branch-misses:u           # [33m   6.14%[m of all branches        
        1909731150      branch-instructions:u                                       

      45.828854874 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 112000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 112000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 112000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,branch-misses:u,branch-instructions:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,branch-misses:u,branch-instructions:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,branch-misses:u,branch-instructions:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,branch-misses:u,branch-instructions:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 112000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 112000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 112000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 112000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 112000 cpus 4
meanInterarrival 35
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 2357221120
starting receive base loop
num_worker_connections 128
Creating worker on tid 1253177088
starting receive base loop
num_worker_connections 128
Creating worker on tid 147388160
starting receive base loop
Created 512 connections total
Creating worker on tid 3330320128
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575373513.371938,       0.0,      262700,     236509,      26191,     154541,      81968,   6.384702,  21.100000,  28.400000,  45.900000,  10.852529,   0.000000, 133.257002, 468.222731
Outstanding requests per worker:
160 122 155 157 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114305.1,      571526,     514639,      56887,     380982,     133657,   5.207442,  15.200000,  20.300000,  26.400000,   6.946824,   0.032000,  41.455999, 562.842260
Outstanding requests per worker:
144 114 133 152 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114282.3,      571412,     514283,      57129,     402098,     112185,   5.262132,  15.400000,  20.500000,  26.600000,   7.075680,   0.032000,  46.914000, 609.627262
Outstanding requests per worker:
136 138 164 151 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114284.5,      571423,     514001,      57422,     414379,      99622,   5.216748,  15.000000,  20.500000,  26.400000,   6.905896,   0.032000,  33.796001, 635.582746
Outstanding requests per worker:
158 170 156 154 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114204.5,      571023,     513956,      57067,     422211,      91745,   9.359965,  18.400000,  21.000000,  26.000000,   6.153878,   0.078000,  45.131002, 653.058077
Outstanding requests per worker:
278 298 235 268 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114302.1,      571511,     514336,      57175,     428358,      85978,   8.980606,  17.800000,  20.100000,  23.600000,   5.655275,   0.122000,  31.757001, 665.343363
Outstanding requests per worker:
288 252 271 264 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114288.9,      571445,     514076,      57369,     433286,      80790,   8.964628,  17.800000,  20.300000,  23.200000,   5.635237,   0.121000,  28.600000, 676.225667
Outstanding requests per worker:
261 304 252 282 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'7\r'
+ echo 'memcached pid is: 7'
memcached pid is: 7
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.4  0.0  18028  2860 pts/0    Ss+  11:18   0:00 bash docker-ent
memcache     6  0.3  0.0  96552  6448 pts/0    S+   11:18   0:00 /usr/lib/linux-
memcache     7  134  0.0 278912 126140 pts/0   Sl+  11:18   1:02 memcached -t 2 
memcache    17  0.0  0.0  34424  2796 pts/1    Rs+  11:19   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       13883096520      instructions:u                                              
         116308766      branch-misses:u           # [33m   6.31%[m of all branches        
        1843125633      branch-instructions:u                                       

      45.865831538 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 114000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 114000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 114000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,branch-misses:u,branch-instructions:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,branch-misses:u,branch-instructions:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,branch-misses:u,branch-instructions:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,branch-misses:u,branch-instructions:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 114000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 114000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 114000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 114000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 114000 cpus 4
meanInterarrival 35
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 2711836416
starting receive base loop
num_worker_connections 128
Creating worker on tid 1607759616
starting receive base loop
num_worker_connections 128
Creating worker on tid 498956032
starting receive base loop
Created 512 connections total
Creating worker on tid 3688134400
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575373561.371986,       0.0,      261370,     235157,      26213,     153385,      81772,   6.754385,  22.300000,  29.600000,  46.300000,  11.071122,   0.000000, 131.898999, 466.332493
Outstanding requests per worker:
159 154 174 156 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114294.7,      571474,     514401,      57073,     380050,     134351,   5.658202,  16.400000,  21.900000,  29.400000,   7.579047,   0.033000,  45.391001, 561.712141
Outstanding requests per worker:
163 160 147 178 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114294.7,      571474,     514557,      56917,     402330,     112227,   5.659925,  16.300000,  22.200000,  28.900000,   7.597447,   0.033000,  51.426001, 609.099245
Outstanding requests per worker:
168 163 168 138 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114299.1,      571496,     514164,      57332,     414031,     100133,   5.789399,  16.500000,  22.400000,  29.900000,   7.691128,   0.033000,  35.913002, 634.932531
Outstanding requests per worker:
176 127 162 147 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114279.1,      571396,     514467,      56929,     422739,      91728,   6.273027,  18.000000,  24.600000,  32.000000,   8.526485,   0.032000,  67.952000, 653.215862
Outstanding requests per worker:
179 150 177 166 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114287.5,      571438,     514209,      57229,     427779,      86430,   5.927386,  17.000000,  22.800000,  30.900000,   7.901025,   0.033000,  36.933001, 664.121056
Outstanding requests per worker:
167 173 174 194 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114300.5,      571503,     514212,      57291,     433321,      80891,   6.129313,  17.500000,  23.500000,  32.000000,   8.168839,   0.032000,  38.058002, 675.860375
Outstanding requests per worker:
181 145 133 203 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'7\r'
+ echo 'memcached pid is: 7'
memcached pid is: 7
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18028  2856 pts/0    Ss+  11:19   0:00 bash docker-ent
memcache     6  0.5  0.0  96552  6456 pts/0    S+   11:19   0:00 /usr/lib/linux-
memcache     7  132  0.0 276864 123156 pts/0   Sl+  11:19   0:59 memcached -t 2 
memcache    16  0.0  0.0  34424  2784 pts/1    Rs+  11:20   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       14130098874      instructions:u                                              
         118793332      branch-misses:u           # [33m   6.09%[m of all branches        
        1950984368      branch-instructions:u                                       

      45.781260050 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 116000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 116000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ bc
++ echo '24 + 4'
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 116000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,branch-misses:u,branch-instructions:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,branch-misses:u,branch-instructions:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,branch-misses:u,branch-instructions:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,branch-misses:u,branch-instructions:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 116000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 116000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 116000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 116000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 116000 cpus 4
meanInterarrival 34
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 1027311360
starting receive base loop
num_worker_connections 128
Creating worker on tid 4213978880
starting receive base loop
num_worker_connections 128
Creating worker on tid 3108189952
starting receive base loop
Created 512 connections total
Creating worker on tid 1999386368
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575373609.372034,       0.0,      268979,     242018,      26961,     157615,      84403,  17.633122,  38.400000,  52.200000, 102.900000,  27.768110,   0.000000, 652.252972, 466.152799
Outstanding requests per worker:
326 309 305 264 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117769.7,      588849,     530087,      58762,     393146,     136941,   6.343681,  18.200000,  24.100000,  33.200000,   8.532605,   0.044000,  55.751000, 564.528149
Outstanding requests per worker:
147 154 156 192 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117612.5,      588063,     529453,      58610,     414685,     114768,   6.673204,  19.100000,  25.900000,  34.600000,   9.069194,   0.045000,  89.094996, 609.826691
Outstanding requests per worker:
181 227 210 235 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117675.5,      588378,     529350,      59028,     426773,     102577,   6.257052,  17.900000,  23.500000,  33.100000,   8.353802,   0.032000,  50.946999, 636.519146
Outstanding requests per worker:
213 186 176 182 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117656.9,      588285,     529699,      58586,     435803,      93896,   7.024449,  20.300000,  26.800000,  37.600000,   9.554099,   0.033000,  86.067997, 653.744360
Outstanding requests per worker:
201 173 190 172 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117643.3,      588217,     529151,      59066,     441810,      87341,   6.661284,  19.100000,  24.600000,  35.500000,   8.903176,   0.044000,  62.624000, 667.393906
Outstanding requests per worker:
206 221 199 175 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117679.1,      588396,     529593,      58803,     446909,      82684,   6.704476,  19.200000,  24.700000,  35.800000,   8.978346,   0.045000,  66.095002, 677.584838
Outstanding requests per worker:
198 167 147 160 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'7\r'
+ echo 'memcached pid is: 7'
memcached pid is: 7
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18028  2804 pts/0    Ss+  11:20   0:00 bash docker-ent
memcache     6  0.4  0.0  96552  6484 pts/0    S+   11:20   0:00 /usr/lib/linux-
memcache     7  135  0.0 280960 128936 pts/0   Sl+  11:20   1:00 memcached -t 2 
memcache    16  0.0  0.0  34424  2864 pts/1    Rs+  11:21   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       14468872652      instructions:u                                              
         122676134      branch-misses:u           # [33m   6.18%[m of all branches        
        1983652085      branch-instructions:u                                       

      45.815331288 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 118000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 118000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 118000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,branch-misses:u,branch-instructions:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,branch-misses:u,branch-instructions:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,branch-misses:u,branch-instructions:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,branch-misses:u,branch-instructions:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 118000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 118000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 118000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 118000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 118000 cpus 4
meanInterarrival 33
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 1777248000
starting receive base loop
num_worker_connections 128
Creating worker on tid 668235520
starting receive base loop
num_worker_connections 128
Creating worker on tid 3854399232
starting receive base loop
Created 512 connections total
Creating worker on tid 2742363904
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575373657.372082,       0.0,      273930,     246515,      27415,     161640,      84875,  26.849484,  96.900000, 116.100000, 148.400000,  41.028437,   0.000000, 241.898000, 470.684867
Outstanding requests per worker:
1298 1223 1262 1102 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  120562.7,      602814,     542998,      59816,     402551,     140447,  56.868617, 151.600000, 177.500000, 215.900000,  65.982458,   0.046000, 363.337994, 564.502111
Outstanding requests per worker:
1972 2164 2106 1941 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121015.5,      605078,     544450,      60628,     427903,     116547,  67.404333, 177.900000, 200.000000, 252.800000,  76.442166,   0.044000, 437.072992, 613.371189
Outstanding requests per worker:
2256 2286 2246 2411 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  120966.5,      604833,     544695,      60138,     440231,     104464,  82.320664, 206.400000, 234.300000, 282.000000,  90.432187,   0.044000, 393.168002, 638.116608
Outstanding requests per worker:
2676 2685 2489 2626 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  120450.7,      602254,     541943,      60311,     446469,      95474, 101.298192, 258.300000, 289.700000, 354.700000, 111.756291,   0.046000, 515.349984, 655.481890
Outstanding requests per worker:
3647 3617 3484 3569 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  120649.7,      603249,     542785,      60464,     454063,      88722, 126.425784, 315.700000, 356.100000, 429.900000, 137.778677,   0.045000, 619.203985, 668.931087
Outstanding requests per worker:
4299 4237 4327 4313 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  120834.1,      604171,     543774,      60397,     459409,      84365, 150.089197, 374.500000, 422.400000, 508.600000, 163.519978,   0.045000, 718.563974, 678.357742
Outstanding requests per worker:
4691 4761 4859 4787 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'7\r'
+ echo 'memcached pid is: 7'
memcached pid is: 7
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18028  2856 pts/0    Ss+  11:21   0:00 bash docker-ent
memcache     6  0.4  0.0  96552  6428 pts/0    S+   11:21   0:00 /usr/lib/linux-
memcache     7  135  0.0 280960 132828 pts/0   Sl+  11:21   1:00 memcached -t 2 
memcache    16  0.0  0.0  34424  2876 pts/1    Rs+  11:21   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       14925633941      instructions:u                                              
         126245339      branch-misses:u           # [33m   6.15%[m of all branches        
        2053511350      branch-instructions:u                                       

      45.827201511 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 120000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 120000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 120000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,branch-misses:u,branch-instructions:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,branch-misses:u,branch-instructions:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,branch-misses:u,branch-instructions:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,branch-misses:u,branch-instructions:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 120000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 120000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 120000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 120000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 120000 cpus 4
meanInterarrival 33
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 1526859520
starting receive base loop
num_worker_connections 128
Creating worker on tid 423835392
starting receive base loop
num_worker_connections 128
Creating worker on tid 3613013760
starting receive base loop
Created 512 connections total
Creating worker on tid 2504210176
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575373704.372129,       0.0,      273725,     246658,      27067,     161507,      85151,  27.267786,  97.700000, 117.300000, 150.100000,  41.427241,   0.000000, 247.232005, 468.729845
Outstanding requests per worker:
1167 1201 1150 989 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  120636.3,      603182,     542975,      60207,     403559,     139416,  51.175640, 135.000000, 161.400000, 200.300000,  60.084152,   0.045000, 341.659993, 566.199602
Outstanding requests per worker:
1811 2097 1786 1742 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  120805.5,      604028,     543613,      60415,     427242,     116371,  69.214533, 181.500000, 204.300000, 260.100000,  78.297867,   0.045000, 447.932005, 613.212697
Outstanding requests per worker:
2393 2457 2315 2334 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  120967.1,      604836,     544026,      60810,     439754,     104272,  82.981496, 209.600000, 241.200000, 292.300000,  92.152021,   0.045000, 427.395999, 638.524837
Outstanding requests per worker:
2704 2760 2570 2737 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  120307.5,      601538,     541241,      60297,     446382,      94859, 108.432078, 278.100000, 314.300000, 381.000000, 120.180236,   0.044000, 538.663983, 656.335056
Outstanding requests per worker:
3772 3832 3841 3878 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  120880.3,      604402,     543637,      60765,     454704,      88933, 133.401452, 332.700000, 370.800000, 447.400000, 144.884594,   0.044000, 637.185991, 668.622027
Outstanding requests per worker:
4329 4356 4264 4073 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  120801.3,      604007,     543540,      60467,     459427,      84113, 148.568606, 368.500000, 415.500000, 505.500000, 161.419567,   0.045000, 735.184014, 679.235493
Outstanding requests per worker:
4801 4740 4790 4778 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18028  2844 pts/0    Ss+  11:21   0:00 bash docker-ent
memcache     7  0.5  0.0  96552  6464 pts/0    S+   11:21   0:00 /usr/lib/linux-
memcache     8  132  0.0 281984 134108 pts/0   Sl+  11:21   1:01 memcached -t 2 
memcache    17  0.0  0.0  34424  2908 pts/1    Rs+  11:22   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       15073577658      instructions:u                                              
         125940321      branch-misses:u           # [33m   6.12%[m of all branches        
        2058076075      branch-instructions:u                                       

      45.735610970 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 122000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 122000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 122000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,branch-misses:u,branch-instructions:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,branch-misses:u,branch-instructions:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,branch-misses:u,branch-instructions:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,branch-misses:u,branch-instructions:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 122000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 122000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 122000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 122000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 122000 cpus 4
meanInterarrival 32
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 648464128
starting receive base loop
num_worker_connections 128
Creating worker on tid 3838375680
starting receive base loop
num_worker_connections 128
Creating worker on tid 2729572096
starting receive base loop
Created 512 connections total
Creating worker on tid 1623783168
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575373752.372177,       0.0,      279552,     251400,      28152,     165380,      86020,  33.244726, 117.300000, 137.000000, 178.400000,  50.062960,   0.000000, 264.856994, 471.637550
Outstanding requests per worker:
1864 1743 1663 1819 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  123734.7,      618674,     556955,      61719,     413966,     142989,  84.587789, 221.100000, 257.600000, 314.700000,  96.331479,   0.043000, 510.870993, 566.749640
Outstanding requests per worker:
3373 3251 3408 3435 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  123946.5,      619733,     557668,      62065,     438562,     119106, 123.949119, 311.500000, 351.600000, 430.900000, 136.389257,   0.044000, 650.772989, 613.914991
Outstanding requests per worker:
4508 4699 4838 4719 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  123983.1,      619916,     558029,      61887,     452309,     105720, 168.263564, 419.500000, 469.700000, 582.000000, 183.725440,   0.044000, 816.426992, 640.433248
Outstanding requests per worker:
5758 6095 6064 5980 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  122950.1,      614751,     553235,      61516,     456979,      96256, 224.590744, 572.800000, 654.000000, 802.000000, 249.808829,   0.045000, 1160.776019, 657.434481
Outstanding requests per worker:
8556 8635 8372 8611 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  123094.7,      615474,     553975,      61499,     463909,      90066, 304.624172, 775.500000, 887.500000, 1069.700000, 338.616508,   0.044000, 1402.634978, 670.459362
Outstanding requests per worker:
10928 10757 10689 11368 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  122390.9,      611955,     550801,      61154,     466086,      84715, 391.931647, 993.600000, 1119.000000, 1367.000000, 435.456446,   0.044000, 1732.717991, 679.685237
Outstanding requests per worker:
14171 14099 14189 14359 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.4  0.0  18028  2772 pts/0    Ss+  11:22   0:00 bash docker-ent
memcache     7  0.4  0.0  96552  6452 pts/0    S+   11:22   0:00 /usr/lib/linux-
memcache     8  133  0.0 283008 135412 pts/0   Sl+  11:22   1:01 memcached -t 2 
memcache    18 19.0  0.0  34424  2916 pts/1    Rs+  11:23   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       15298667767      instructions:u                                              
         126639222      branch-misses:u           # [33m   6.05%[m of all branches        
        2092348891      branch-instructions:u                                       

      45.801201568 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 124000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 124000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 124000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,branch-misses:u,branch-instructions:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,branch-misses:u,branch-instructions:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,branch-misses:u,branch-instructions:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,branch-misses:u,branch-instructions:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 124000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 124000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 124000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 124000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 124000 cpus 4
meanInterarrival 32
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 3745298176
starting receive base loop
num_worker_connections 128
Creating worker on tid 2638427904
starting receive base loop
num_worker_connections 128
Creating worker on tid 1532638976
starting receive base loop
Created 512 connections total
Creating worker on tid 423835392
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575373800.372225,       0.0,      279915,     252160,      27755,     165611,      86549,  34.802927, 122.300000, 143.000000, 181.600000,  52.039685,   0.000000, 264.108986, 471.243560
Outstanding requests per worker:
1888 1750 1777 1709 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  123387.1,      616936,     555374,      61562,     412263,     143111,  89.088621, 235.700000, 274.100000, 349.800000, 102.836897,   0.045000, 524.556994, 564.845245
Outstanding requests per worker:
3819 4078 3574 3767 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  123594.3,      617972,     555758,      62214,     436441,     119317, 144.893772, 366.500000, 419.900000, 532.400000, 161.572727,   0.045000, 810.545981, 612.770573
Outstanding requests per worker:
5689 5729 5477 5409 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  123483.5,      617418,     555679,      61739,     449895,     105784, 204.256145, 515.200000, 586.300000, 719.800000, 225.592190,   0.045000, 996.334016, 639.031772
Outstanding requests per worker:
7463 7622 7242 7607 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  122442.9,      612215,     550817,      61398,     454895,      95922, 280.351419, 711.600000, 810.900000, 994.200000, 312.126887,   0.046000, 1426.098943, 657.351496
Outstanding requests per worker:
10804 10584 10663 10708 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121988.5,      609943,     548997,      60946,     459420,      89577, 387.877931, 987.800000, 1092.500000, 1305.200000, 429.023314,   0.045000, 1730.530024, 669.681920
Outstanding requests per worker:
14329 14148 14628 14760 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121752.3,      608762,     548237,      60525,     463581,      84656, 510.257135, 1269.300000, 1397.800000, 1681.300000, 558.765032,   0.045000, 2280.801058, 678.830714
Outstanding requests per worker:
18777 18155 18815 18401 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'7\r'
+ echo 'memcached pid is: 7'
memcached pid is: 7
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18028  2740 pts/0    Ss+  11:23   0:00 bash docker-ent
memcache     6  0.5  0.0  96552  6344 pts/0    S+   11:23   0:00 /usr/lib/linux-
memcache     7  136  0.0 283008 135632 pts/0   Sl+  11:23   1:01 memcached -t 2 
memcache    17  0.0  0.0  34424  2820 pts/1    Rs+  11:24   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       15235631030      instructions:u                                              
         126645833      branch-misses:u           # [33m   6.08%[m of all branches        
        2084097760      branch-instructions:u                                       

      45.849701797 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 126000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 126000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 126000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,branch-misses:u,branch-instructions:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,branch-misses:u,branch-instructions:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,branch-misses:u,branch-instructions:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,branch-misses:u,branch-instructions:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 126000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 126000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 126000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 126000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 126000 cpus 4
meanInterarrival 31
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 1133606656
starting receive base loop
num_worker_connections 128
Creating worker on tid 29193984
starting receive base loop
num_worker_connections 128
Creating worker on tid 3218372352
starting receive base loop
Created 512 connections total
Creating worker on tid 2109568768
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575373848.372273,       0.0,      285575,     256901,      28674,     168152,      88749,  48.939487, 167.300000, 194.900000, 250.800000,  72.565950,   0.000000, 443.778992, 468.928490
Outstanding requests per worker:
2842 2739 3052 3205 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  125695.1,      628476,     566120,      62356,     421931,     144189, 153.805638, 407.600000, 462.200000, 569.000000, 175.933022,   0.043000, 794.099987, 569.508463
Outstanding requests per worker:
7051 7131 7351 7045 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  124579.9,      622900,     560898,      62002,     440961,     119937, 295.121076, 753.600000, 846.300000, 1029.600000, 330.030346,   0.045000, 1411.936998, 613.748808
Outstanding requests per worker:
12608 12741 13026 12492 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  123520.1,      617601,     555797,      61804,     450570,     105227, 471.800925, 1187.200000, 1306.000000, 1512.300000, 522.402364,   0.045000, 1852.771044, 640.602698
Outstanding requests per worker:
19188 19563 20178 19552 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  123404.9,      617025,     555143,      61882,     458311,      96832, 680.191705, 1660.600000, 1785.400000, 2017.600000, 739.030403,   0.045000, 2436.372995, 657.530919
Outstanding requests per worker:
25910 26581 27464 26689 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  122853.5,      614268,     552908,      61360,     463129,      89779, 896.420339, 2154.100000, 2305.900000, 2560.700000, 970.083816,   0.045000, 3144.746065, 670.731413
Outstanding requests per worker:
33599 34585 35303 34096 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  122515.3,      612577,     551265,      61312,     466401,      84864, 1127.970594, 2672.200000, 2840.800000, 3120.700000, 1213.580799,   0.045000, 3488.480091, 681.084640
Outstanding requests per worker:
41615 42949 43617 42022 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18028  2760 pts/0    Ss+  11:24   0:00 bash docker-ent
memcache     7  0.5  0.0  96552  6456 pts/0    S+   11:24   0:00 /usr/lib/linux-
memcache     8  137  0.0 285056 137632 pts/0   Sl+  11:24   1:01 memcached -t 2 
memcache    17  0.0  0.0  34424  2796 pts/1    Rs+  11:25   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       15390390770      instructions:u                                              
         128396959      branch-misses:u           # [33m   6.11%[m of all branches        
        2100414384      branch-instructions:u                                       

      45.948289400 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 128000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 128000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 128000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,branch-misses:u,branch-instructions:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,branch-misses:u,branch-instructions:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,branch-misses:u,branch-instructions:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,branch-misses:u,branch-instructions:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 128000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 128000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 128000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 128000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 128000 cpus 4
meanInterarrival 31
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 3422525184
starting receive base loop
num_worker_connections 128
Creating worker on tid 2318907136
starting receive base loop
num_worker_connections 128
Creating worker on tid 1213118208
starting receive base loop
Created 512 connections total
Creating worker on tid 104314624
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575373896.372321,       0.0,      285556,     257125,      28431,     169053,      88072,  57.365445, 190.300000, 217.400000, 272.500000,  82.162568,   0.000000, 387.102008, 472.280879
Outstanding requests per worker:
3256 3138 3194 3410 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  125543.3,      627717,     565088,      62629,     420546,     144542, 164.135635, 431.400000, 496.900000, 619.600000, 187.847188,   0.046000, 874.471009, 568.231583
Outstanding requests per worker:
7212 7629 7731 7925 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  124588.5,      622943,     560886,      62057,     441378,     119508, 305.043321, 784.000000, 878.100000, 1044.200000, 340.588339,   0.045000, 1434.491992, 614.817774
Outstanding requests per worker:
12944 13365 13058 13389 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  124066.1,      620331,     558294,      62037,     452004,     106290, 481.178807, 1206.900000, 1323.500000, 1526.100000, 528.599843,   0.046000, 2151.283026, 639.855739
Outstanding requests per worker:
19324 19561 19316 19436 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  122929.7,      614649,     553142,      61507,     456809,      96333, 683.621497, 1672.200000, 1806.900000, 2028.200000, 744.724786,   0.046000, 2475.089073, 657.243697
Outstanding requests per worker:
27126 27128 26916 27014 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  122850.7,      614254,     552770,      61484,     462924,      89846, 908.938399, 2185.500000, 2330.600000, 2570.000000, 980.643683,   0.046000, 3052.098989, 670.190739
Outstanding requests per worker:
35013 34409 34900 34826 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  122381.5,      611908,     550832,      61076,     466099,      84733, 1140.327607, 2681.300000, 2843.400000, 3131.000000, 1223.273220,   0.046000, 3767.014980, 680.107132
Outstanding requests per worker:
42949 42430 43844 43215 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'7\r'
+ echo 'memcached pid is: 7'
memcached pid is: 7
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.4  0.0  18028  2764 pts/0    Ss+  11:25   0:00 bash docker-ent
memcache     6  0.3  0.0  96552  6484 pts/0    S+   11:25   0:00 /usr/lib/linux-
memcache     7  137  0.0 283008 135456 pts/0   Sl+  11:25   1:01 memcached -t 2 
memcache    17  0.0  0.0  34424  2840 pts/1    Rs+  11:25   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       15369857781      instructions:u                                              
         127594943      branch-misses:u           # [33m   6.08%[m of all branches        
        2099795764      branch-instructions:u                                       

      45.962659202 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 4 threads, 130000 rps'
==> Bench: 65536 keys, 512 conns, 4 threads, 130000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 4'
++ bc
+ client_cores_spec=24-28
+ CLIENT_CORES_SPEC=24-28
+ CLIENT_ARGS='-r 130000 -k 65536 -c 512 -f 512 -w 4'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-28
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,branch-misses:u,branch-instructions:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,branch-misses:u,branch-instructions:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,branch-misses:u,branch-instructions:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,branch-misses:u,branch-instructions:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 130000 -k 65536 -c 512 -f 512 -w 4'
Starting client with -r 130000 -k 65536 -c 512 -f 512 -w 4
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-28 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 130000 -k 65536 -c 512 -f 512 -w 4
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 130000 -k 65536 -c 512 -f 512 -w 4
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 4
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 130000 cpus 4
meanInterarrival 30
num_worker_connections 128
num_worker_connections 128
Creating worker on tid 4051216128
starting receive base loop
num_worker_connections 128
Creating worker on tid 2949936896
starting receive base loop
num_worker_connections 128
Creating worker on tid 1841133312
starting receive base loop
Created 512 connections total
Creating worker on tid 733198080
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575373943.372368,       0.0,      288039,     259297,      28742,     171277,      88020,  68.914487, 222.000000, 270.000000, 371.100000, 107.124554,   0.000000, 849.906027, 474.747432
Outstanding requests per worker:
4289 4102 4234 4905 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  127287.9,      636440,     573262,      63178,     427631,     145631, 229.243334, 626.300000, 729.200000, 901.200000, 272.382640,   0.044000, 1578.140974, 568.914662
Outstanding requests per worker:
11905 11710 11703 12501 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  126175.9,      630880,     567639,      63241,     447274,     120365, 457.641676, 1173.800000, 1300.800000, 1562.600000, 516.585571,   0.045000, 2022.490978, 614.913286
Outstanding requests per worker:
21224 20482 20505 21430 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  125868.1,      629341,     566716,      62625,     459620,     107096, 717.944146, 1772.500000, 1914.600000, 2164.600000, 791.811624,   0.045000, 2866.746902, 641.154769
Outstanding requests per worker:
30563 30070 29586 30798 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  125081.9,      625410,     562695,      62715,     464890,      97805, 989.014064, 2387.500000, 2564.200000, 2864.500000, 1085.245038,   0.045000, 3564.483881, 657.788033
Outstanding requests per worker:
40915 40333 39761 41299 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  124765.1,      623826,     561237,      62589,     469947,      91290, 1283.461204, 3055.900000, 3241.700000, 3551.100000, 1396.085858,   0.046000, 4307.434082, 669.876229
Outstanding requests per worker:
51686 50759 50569 52186 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  124500.1,      622501,     560386,      62115,     474690,      85696, 1581.647494, 3722.400000, 3899.200000, 4208.700000, 1716.448766,   0.045000, 5211.558819, 680.303582
Outstanding requests per worker:
62654 62236 61565 62946 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'7\r'
+ echo 'memcached pid is: 7'
memcached pid is: 7
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18028  2892 pts/0    Ss+  11:25   0:00 bash docker-ent
memcache     6  0.5  0.0  96552  6500 pts/0    S+   11:25   0:00 /usr/lib/linux-
memcache     7  135  0.0 285056 137992 pts/0   Sl+  11:25   1:02 memcached -t 2 
memcache    17  0.0  0.0  34424  2880 pts/1    Rs+  11:26   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       15506128926      instructions:u                                              
         129087394      branch-misses:u           # [33m   6.07%[m of all branches        
        2126773196      branch-instructions:u                                       

      45.845590076 seconds time elapsed

+ for threads in '$THREADS'
+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 104000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 104000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 104000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,branch-misses:u,branch-instructions:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,branch-misses:u,branch-instructions:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,branch-misses:u,branch-instructions:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,branch-misses:u,branch-instructions:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 104000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 104000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 104000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 104000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 104000 cpus 8
meanInterarrival 76
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 2114451200
starting receive base loop
num_worker_connections 64
Creating worker on tid 1524545280
starting receive base loop
num_worker_connections 64
Creating worker on tid 925263616
starting receive base loop
num_worker_connections 64
Creating worker on tid 332609280
starting receive base loop
num_worker_connections 64
Creating worker on tid 4031608576
starting receive base loop
num_worker_connections 64
Creating worker on tid 3435640576
starting receive base loop
num_worker_connections 64
Creating worker on tid 2839672576
starting receive base loop
Created 512 connections total
Creating worker on tid 2246719232
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575373992.372417,       0.0,      310769,     279600,      31169,     184845,      94755,   2.632724,   9.900000,  13.400000,  19.100000,   4.816056,   0.000000,  62.139001, 476.124335
Outstanding requests per worker:
48 53 34 37 34 33 39 47 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  105264.3,      526322,     473731,      52591,     352177,     121554,   3.342440,  10.500000,  12.700000,  16.400000,   4.459420,   0.023000,  24.727000, 566.293430
Outstanding requests per worker:
49 48 36 43 48 45 46 44 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  105265.5,      526328,     473999,      52329,     370670,     103329,   3.486650,  11.000000,  13.500000,  16.500000,   4.607506,   0.023000,  20.400999, 609.926962
Outstanding requests per worker:
58 45 38 58 50 43 50 52 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  105266.9,      526335,     473476,      52859,     380360,      93116,   3.859000,  12.100000,  14.900000,  19.000000,   5.205859,   0.023000,  37.347000, 632.992663
Outstanding requests per worker:
54 53 54 62 43 52 34 47 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  105270.5,      526353,     473537,      52816,     387690,      85847,   3.884535,  12.200000,  15.000000,  19.300000,   5.268213,   0.023000,  34.752999, 650.137848
Outstanding requests per worker:
42 52 41 45 60 50 38 63 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  105274.7,      526374,     473505,      52869,     393161,      80344,   3.737789,  11.700000,  14.700000,  17.800000,   4.969799,   0.023000,  22.291999, 661.790613
Outstanding requests per worker:
46 40 37 45 55 51 58 40 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  105271.3,      526357,     473614,      52743,     397478,      76136,   3.865528,  12.000000,  15.300000,  18.500000,   5.151804,   0.023000,  23.766000, 671.821897
Outstanding requests per worker:
50 51 48 38 46 41 43 47 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'7\r'
+ echo 'memcached pid is: 7'
memcached pid is: 7
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18028  2880 pts/0    Ss+  11:26   0:00 bash docker-ent
memcache     6  0.4  0.0  96552  6380 pts/0    S+   11:26   0:00 /usr/lib/linux-
memcache     7  127  0.0 272768 118928 pts/0   Sl+  11:26   1:00 memcached -t 2 
memcache    16 18.0  0.0  34424  2860 pts/1    Rs+  11:27   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       13296088139      instructions:u                                              
         113561511      branch-misses:u           # [33m   6.14%[m of all branches        
        1849585460      branch-instructions:u                                       

      46.739502460 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 106000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 106000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 106000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,branch-misses:u,branch-instructions:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,branch-misses:u,branch-instructions:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,branch-misses:u,branch-instructions:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,branch-misses:u,branch-instructions:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 106000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 106000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 106000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 106000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 106000 cpus 8
meanInterarrival 75
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 2555995904
starting receive base loop
num_worker_connections 64
Creating worker on tid 1964726016
starting receive base loop
num_worker_connections 64
Creating worker on tid 1371289344
starting receive base loop
num_worker_connections 64
Creating worker on tid 778336000
starting receive base loop
num_worker_connections 64
Creating worker on tid 182368000
starting receive base loop
num_worker_connections 64
Creating worker on tid 3881367296
starting receive base loop
num_worker_connections 64
Creating worker on tid 3285399296
starting receive base loop
Created 512 connections total
Creating worker on tid 2689431296
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575374041.372466,       0.0,      314284,     283015,      31269,     187001,      96014,   2.981623,  11.100000,  14.900000,  23.900000,   5.497528,   0.000000,  73.315002, 475.882536
Outstanding requests per worker:
57 40 62 58 44 48 46 50 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  106669.7,      533349,     480124,      53225,     357209,     122915,   3.991680,  12.400000,  15.500000,  19.800000,   5.405122,   0.023000,  33.617999, 567.030965
Outstanding requests per worker:
56 48 58 48 50 66 56 56 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  106684.3,      533422,     480142,      53280,     374851,     105291,   4.224859,  13.100000,  16.700000,  20.400000,   5.715553,   0.023000,  35.831001, 608.496772
Outstanding requests per worker:
41 52 56 55 56 41 45 48 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  106675.1,      533376,     479911,      53465,     385507,      94404,   4.242991,  12.900000,  16.900000,  20.900000,   5.693168,   0.023000,  27.069001, 632.942412
Outstanding requests per worker:
50 53 47 45 46 45 53 45 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  106658.9,      533295,     480305,      52990,     393389,      86916,   4.631817,  14.100000,  18.200000,  23.900000,   6.335351,   0.024000,  39.799001, 650.298981
Outstanding requests per worker:
62 54 61 51 52 66 50 54 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  106668.7,      533344,     479734,      53610,     398826,      80908,   4.417370,  13.300000,  17.700000,  22.000000,   5.948530,   0.024000,  28.301001, 663.456232
Outstanding requests per worker:
38 56 68 73 49 69 65 71 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  106671.7,      533359,     480036,      53323,     403585,      76451,   4.573592,  13.700000,  18.300000,  22.900000,   6.157634,   0.023000,  28.268000, 673.885334
Outstanding requests per worker:
52 81 65 62 56 59 53 64 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'7\r'
+ echo 'memcached pid is: 7'
memcached pid is: 7
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.4  0.0  18028  2840 pts/0    Ss+  11:27   0:00 bash docker-ent
memcache     6  0.4  0.0  96552  6404 pts/0    S+   11:27   0:00 /usr/lib/linux-
memcache     7  130  0.0 273792 119892 pts/0   Sl+  11:27   0:59 memcached -t 2 
memcache    17  0.0  0.0  34424  2908 pts/1    Rs+  11:28   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       13505669857      instructions:u                                              
         114439542      branch-misses:u           # [33m   6.09%[m of all branches        
        1880437643      branch-instructions:u                                       

      46.843413984 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 108000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 108000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 108000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,branch-misses:u,branch-instructions:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,branch-misses:u,branch-instructions:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,branch-misses:u,branch-instructions:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,branch-misses:u,branch-instructions:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 108000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 108000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 108000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 108000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 108000 cpus 8
meanInterarrival 74
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 2667300608
starting receive base loop
num_worker_connections 64
Creating worker on tid 2076030720
starting receive base loop
num_worker_connections 64
Creating worker on tid 1476749056
starting receive base loop
num_worker_connections 64
Creating worker on tid 885503744
starting receive base loop
num_worker_connections 64
Creating worker on tid 289535744
starting receive base loop
num_worker_connections 64
Creating worker on tid 3991549696
starting receive base loop
num_worker_connections 64
Creating worker on tid 3395581696
starting receive base loop
Created 512 connections total
Creating worker on tid 2799613696
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575374090.372515,       0.0,      316894,     285305,      31589,     189049,      96256,   3.058810,  11.200000,  15.600000,  22.700000,   6.090554,   0.000000, 189.467996, 477.608563
Outstanding requests per worker:
67 82 77 71 71 63 79 90 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108129.3,      540647,     486621,      54026,     362388,     124233,   4.444907,  13.600000,  17.500000,  22.300000,   6.039947,   0.023000,  35.689998, 567.874448
Outstanding requests per worker:
61 56 65 69 82 69 67 73 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108130.1,      540651,     486556,      54095,     380396,     106160,   4.483110,  13.400000,  17.900000,  22.300000,   6.018013,   0.022000,  27.767001, 609.910982
Outstanding requests per worker:
57 63 43 66 58 71 64 57 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108111.1,      540556,     486544,      54012,     391909,      94635,   4.893256,  14.700000,  19.200000,  25.500000,   6.690184,   0.024000,  43.832000, 635.121265
Outstanding requests per worker:
48 80 73 59 57 52 63 62 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108081.9,      540410,     486161,      54249,     398742,      87419,   5.132929,  15.400000,  20.400000,  26.400000,   7.062101,   0.023000,  49.594000, 651.508998
Outstanding requests per worker:
93 70 113 64 85 82 81 66 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108146.9,      540735,     486502,      54233,     404889,      81613,   4.860396,  14.400000,  19.600000,  24.700000,   6.571654,   0.023000,  31.801000, 664.735417
Outstanding requests per worker:
62 56 65 74 62 55 56 75 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  108101.7,      540509,     486073,      54436,     408838,      77235,   5.039715,  14.800000,  20.100000,  25.800000,   6.808127,   0.022000,  32.063000, 674.012381
Outstanding requests per worker:
71 69 78 74 63 60 77 76 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18028  2784 pts/0    Ss+  11:28   0:00 bash docker-ent
memcache     7  0.4  0.0  96552  6404 pts/0    S+   11:28   0:00 /usr/lib/linux-
memcache     8  130  0.0 275840 121656 pts/0   Sl+  11:28   0:59 memcached -t 2 
memcache    17  0.0  0.0  34424  2816 pts/1    Rs+  11:29   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       13672527807      instructions:u                                              
         115670132      branch-misses:u           # [33m   6.11%[m of all branches        
        1894484385      branch-instructions:u                                       

      46.781035965 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 110000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 110000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 110000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,branch-misses:u,branch-instructions:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,branch-misses:u,branch-instructions:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,branch-misses:u,branch-instructions:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,branch-misses:u,branch-instructions:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 110000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 110000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 110000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 110000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 110000 cpus 8
meanInterarrival 72
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 4098471680
starting receive base loop
num_worker_connections 64
Creating worker on tid 3502749440
starting receive base loop
num_worker_connections 64
Creating worker on tid 2906781440
starting receive base loop
num_worker_connections 64
Creating worker on tid 2313828096
starting receive base loop
num_worker_connections 64
Creating worker on tid 1717860096
starting receive base loop
num_worker_connections 64
Creating worker on tid 1121892096
starting receive base loop
num_worker_connections 64
Creating worker on tid 525924096
starting receive base loop
Created 512 connections total
Creating worker on tid 4229920512
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575374138.372563,       0.0,      328603,     295510,      33093,     196388,      99122,   4.706209,  17.300000,  23.800000,  34.800000,   8.778606,   0.000000, 169.715002, 479.794975
Outstanding requests per worker:
95 69 84 87 82 101 124 81 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  111178.7,      555894,     500661,      55233,     373433,     127228,   5.952219,  18.000000,  23.700000,  33.800000,   8.459490,   0.023000,  62.919997, 569.694258
Outstanding requests per worker:
44 43 44 68 71 60 49 56 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  111059.9,      555300,     499784,      55516,     391208,     108576,   6.153166,  18.600000,  23.600000,  35.500000,   8.656985,   0.023000,  56.287002, 610.406007
Outstanding requests per worker:
114 70 100 92 73 93 100 85 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  111127.1,      555636,     500028,      55608,     403028,      97000,   6.522655,  18.900000,  24.800000,  35.300000,   8.893719,   0.024000,  58.070000, 635.840621
Outstanding requests per worker:
91 79 85 99 99 70 74 82 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  111103.7,      555519,     499910,      55609,     411160,      88750,   7.467025,  21.900000,  28.800000,  40.500000,  10.360761,   0.024000,  98.839000, 653.831858
Outstanding requests per worker:
85 90 85 118 94 102 79 94 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  111115.3,      555577,     499806,      55771,     416205,      83601,   7.219475,  21.000000,  26.200000,  39.600000,   9.835079,   0.023000,  56.412999, 665.698005
Outstanding requests per worker:
104 100 106 84 92 87 85 116 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  111106.9,      555535,     499461,      56074,     421308,      78153,   7.386919,  21.600000,  26.700000,  40.900000,  10.082597,   0.023000,  71.552001, 676.351227
Outstanding requests per worker:
90 114 109 103 98 82 115 112 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18028  2864 pts/0    Ss+  11:29   0:00 bash docker-ent
memcache     7  0.4  0.0  96552  6432 pts/0    S+   11:29   0:00 /usr/lib/linux-
memcache     8  130  0.0 276864 124020 pts/0   Sl+  11:29   1:01 memcached -t 2 
memcache    17  0.0  0.0  34424  2872 pts/1    Rs+  11:29   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       13979527977      instructions:u                                              
         121144517      branch-misses:u           # [33m   6.29%[m of all branches        
        1926014913      branch-instructions:u                                       

      46.850451991 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 112000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 112000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 112000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,branch-misses:u,branch-instructions:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,branch-misses:u,branch-instructions:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,branch-misses:u,branch-instructions:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,branch-misses:u,branch-instructions:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 112000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 112000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 112000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 112000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 112000 cpus 8
meanInterarrival 71
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 1403414272
starting receive base loop
num_worker_connections 64
Creating worker on tid 810383104
starting receive base loop
num_worker_connections 64
Creating worker on tid 214415104
starting receive base loop
num_worker_connections 64
Creating worker on tid 3913414400
starting receive base loop
num_worker_connections 64
Creating worker on tid 3320461056
starting receive base loop
num_worker_connections 64
Creating worker on tid 2724493056
starting receive base loop
num_worker_connections 64
Creating worker on tid 2128525056
starting receive base loop
Created 512 connections total
Creating worker on tid 1532557056
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575374187.372612,       0.0,      333506,     300032,      33474,     199432,     100600,   4.596173,  16.300000,  22.800000,  34.500000,   9.866551,   0.000000, 293.103993, 480.333224
Outstanding requests per worker:
92 105 91 80 84 105 103 95 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  112704.1,      563521,     507172,      56349,     378899,     128273,   5.992311,  17.500000,  23.100000,  32.100000,   8.195268,   0.023000,  46.323001, 571.103677
Outstanding requests per worker:
64 88 90 82 96 94 66 83 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  112674.9,      563375,     506815,      56560,     398019,     108796,   6.267463,  18.300000,  24.300000,  33.700000,   8.604092,   0.023000,  52.524999, 613.301134
Outstanding requests per worker:
97 91 85 87 98 111 73 79 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  112652.5,      563263,     506785,      56478,     409421,      97364,   6.658430,  19.300000,  26.400000,  34.900000,   9.244781,   0.023000,  86.453997, 637.687775
Outstanding requests per worker:
112 97 133 126 93 93 101 115 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  112697.5,      563488,     506947,      56541,     417203,      89744,   6.707225,  19.500000,  25.000000,  36.600000,   9.139068,   0.023000,  59.537001, 654.674138
Outstanding requests per worker:
109 103 87 100 108 92 115 79 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  112690.3,      563452,     507041,      56411,     422691,      84350,   6.633105,  19.300000,  24.900000,  36.100000,   9.048951,   0.023000,  44.371001, 666.562601
Outstanding requests per worker:
81 100 123 95 92 98 99 80 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  112681.5,      563408,     506816,      56592,     427247,      79569,   6.760966,  19.700000,  25.200000,  37.100000,   9.238794,   0.022000,  46.905000, 676.734089
Outstanding requests per worker:
88 105 101 100 95 104 95 87 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'7\r'
+ echo 'memcached pid is: 7'
memcached pid is: 7
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.4  0.0  18028  2864 pts/0    Ss+  11:29   0:00 bash docker-ent
memcache     6  0.3  0.0  96552  6420 pts/0    S+   11:29   0:00 /usr/lib/linux-
memcache     7  129  0.0 278912 125252 pts/0   Sl+  11:29   1:01 memcached -t 2 
memcache    16 18.0  0.0  34424  2884 pts/1    Rs+  11:30   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       14296055095      instructions:u                                              
         118944962      branch-misses:u           # [33m   6.01%[m of all branches        
        1979028951      branch-instructions:u                                       

      47.013896729 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 114000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 114000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 114000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,branch-misses:u,branch-instructions:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,branch-misses:u,branch-instructions:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,branch-misses:u,branch-instructions:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,branch-misses:u,branch-instructions:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 114000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 114000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 114000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 114000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 114000 cpus 8
meanInterarrival 70
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 3265926912
starting receive base loop
num_worker_connections 64
Creating worker on tid 2673407744
starting receive base loop
num_worker_connections 64
Creating worker on tid 2077439744
starting receive base loop
num_worker_connections 64
Creating worker on tid 1481471744
starting receive base loop
num_worker_connections 64
Creating worker on tid 885503744
starting receive base loop
num_worker_connections 64
Creating worker on tid 289535744
starting receive base loop
num_worker_connections 64
Creating worker on tid 3985221376
starting receive base loop
Created 512 connections total
Creating worker on tid 3395581696
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575374236.372661,       0.0,      339163,     305156,      34007,     202048,     103108,   5.226829,  20.100000,  26.300000,  41.900000,   9.715040,   0.000000,  92.661001, 478.217512
Outstanding requests per worker:
100 112 126 125 141 130 130 121 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114302.9,      571515,     514605,      56910,     384990,     129615,   7.499798,  21.900000,  27.600000,  41.200000,  10.293691,   0.023000,  88.500001, 571.637236
Outstanding requests per worker:
100 126 116 139 121 101 138 106 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114299.5,      571498,     514019,      57479,     404467,     109552,   8.193398,  24.200000,  29.900000,  46.100000,  11.289858,   0.023000,  95.192999, 613.923845
Outstanding requests per worker:
103 133 107 124 99 126 115 121 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114200.5,      571003,     514256,      56747,     415196,      99060,   8.523303,  25.000000,  30.000000,  47.900000,  11.664033,   0.023000,  83.623998, 637.041129
Outstanding requests per worker:
170 187 161 150 177 204 172 161 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114386.1,      571931,     514661,      57270,     423941,      90720,   9.103483,  26.800000,  32.000000,  51.500000,  12.505167,   0.023000, 111.042000, 654.995638
Outstanding requests per worker:
124 109 104 120 106 120 118 109 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114258.1,      571291,     513909,      57382,     428956,      84953,   8.916287,  26.400000,  30.400000,  50.700000,  12.166007,   0.023000,  90.357997, 667.281567
Outstanding requests per worker:
131 119 155 157 135 105 158 134 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  114301.3,      571507,     514166,      57341,     433718,      80448,   9.106517,  27.000000,  31.100000,  52.000000,  12.440477,   0.023000,  90.544999, 677.233038
Outstanding requests per worker:
113 153 123 113 118 133 163 133 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18028  2788 pts/0    Ss+  11:30   0:00 bash docker-ent
memcache     7  0.4  0.0  96552  6384 pts/0    S+   11:30   0:00 /usr/lib/linux-
memcache     8  130  0.0 279936 126452 pts/0   Sl+  11:30   1:01 memcached -t 2 
memcache    17 18.0  0.0  34424  2912 pts/1    Rs+  11:31   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       14434239619      instructions:u                                              
         121001551      branch-misses:u           # [33m   6.07%[m of all branches        
        1992888362      branch-instructions:u                                       

      46.862692112 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 116000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 116000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 116000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,branch-misses:u,branch-instructions:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,branch-misses:u,branch-instructions:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,branch-misses:u,branch-instructions:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,branch-misses:u,branch-instructions:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 116000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 116000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 116000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 116000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 116000 cpus 8
meanInterarrival 68
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 1618298624
starting receive base loop
num_worker_connections 64
Creating worker on tid 1027028736
starting receive base loop
num_worker_connections 64
Creating worker on tid 431765248
starting receive base loop
num_worker_connections 64
Creating worker on tid 4133779200
starting receive base loop
num_worker_connections 64
Creating worker on tid 3537811200
starting receive base loop
num_worker_connections 64
Creating worker on tid 2941843200
starting receive base loop
num_worker_connections 64
Creating worker on tid 2345875200
starting receive base loop
Created 512 connections total
Creating worker on tid 1754605312
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575374285.372710,       0.0,      346969,     312371,      34598,     207766,     104605,   6.625193,  25.000000,  32.300000,  52.100000,  13.172849,   0.000000, 319.382995, 480.994887
Outstanding requests per worker:
112 114 139 127 111 93 130 109 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117602.9,      588015,     529193,      58822,     396409,     132784,   9.742381,  28.900000,  33.300000,  56.000000,  13.339883,   0.022000, 105.561003, 572.748530
Outstanding requests per worker:
146 172 160 167 147 134 127 150 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117651.3,      588257,     529422,      58835,     417418,     112004,  10.430548,  30.600000,  36.400000,  59.500000,  14.429552,   0.023000, 140.857995, 615.774409
Outstanding requests per worker:
145 168 146 137 167 140 170 164 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117647.9,      588240,     528944,      59296,     427837,     101107,  10.066852,  29.900000,  34.000000,  58.200000,  13.781987,   0.023000, 102.048002, 638.216675
Outstanding requests per worker:
142 149 161 137 194 184 146 146 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117389.3,      586947,     528081,      58866,     435305,      92776,  13.419432,  38.300000,  53.400000,  95.500000,  20.407403,   0.023000, 174.753994, 655.579233
Outstanding requests per worker:
407 273 307 359 210 377 351 309 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117903.3,      589517,     530566,      58951,     443740,      86826,  13.719691,  38.100000,  55.400000,  96.100000,  20.737759,   0.023000, 179.821000, 669.189322
Outstanding requests per worker:
174 150 163 174 152 220 171 150 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117679.7,      588399,     529474,      58925,     447450,      82024,  10.727473,  31.900000,  36.300000,  62.500000,  14.730762,   0.023000, 113.315001, 679.418614
Outstanding requests per worker:
150 147 146 138 178 130 139 193 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'7\r'
+ echo 'memcached pid is: 7'
memcached pid is: 7
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.4  0.0  18028  2740 pts/0    Ss+  11:31   0:00 bash docker-ent
memcache     6  0.5  0.0  96552  6340 pts/0    S+   11:31   0:00 /usr/lib/linux-
memcache     7  134  0.0 281984 131032 pts/0   Sl+  11:31   1:01 memcached -t 2 
memcache    17  0.0  0.0  34424  2916 pts/1    Rs+  11:32   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       14878782019      instructions:u                                              
         123736313      branch-misses:u           # [33m   6.06%[m of all branches        
        2043429657      branch-instructions:u                                       

      46.870636470 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 118000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 118000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 118000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,branch-misses:u,branch-instructions:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,branch-misses:u,branch-instructions:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,branch-misses:u,branch-instructions:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,branch-misses:u,branch-instructions:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 118000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 118000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 118000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 118000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 118000 cpus 8
meanInterarrival 67
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 3014723328
starting receive base loop
num_worker_connections 64
Creating worker on tid 2420995840
starting receive base loop
num_worker_connections 64
Creating worker on tid 1821714176
starting receive base loop
num_worker_connections 64
Creating worker on tid 1229059840
starting receive base loop
num_worker_connections 64
Creating worker on tid 636106496
starting receive base loop
num_worker_connections 64
Creating worker on tid 40138496
starting receive base loop
num_worker_connections 64
Creating worker on tid 3739137792
starting receive base loop
Created 512 connections total
Creating worker on tid 3143169792
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575374334.372759,       0.0,      353942,     318427,      35515,     213006,     105421,   7.735624,  29.700000,  39.300000,  67.100000,  14.901061,   0.000000, 152.671993, 484.618952
Outstanding requests per worker:
166 200 162 147 186 208 150 168 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  119225.5,      596128,     536814,      59314,     402502,     134312,  11.619022,  33.800000,  42.700000,  68.400000,  16.543873,   0.022000, 160.772994, 573.428441
Outstanding requests per worker:
254 271 294 329 334 277 299 271 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117871.3,      589357,     530607,      58750,     418352,     112255,  39.305288, 121.100000, 148.800000, 207.900000,  54.483625,   0.023000, 378.672987, 615.707320
Outstanding requests per worker:
1198 1283 1217 1281 1361 1266 1150 1282 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117841.7,      589209,     530085,      59124,     429552,     100533, 117.018659, 301.500000, 344.900000, 425.200000, 131.494766,   0.023000, 627.946973, 639.971910
Outstanding requests per worker:
2378 2279 2158 2003 2175 2166 2380 2334 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117738.9,      588695,     529907,      58788,     437150,      92757, 179.331207, 451.000000, 512.400000, 636.700000, 198.179235,   0.023000, 980.112016, 656.823101
Outstanding requests per worker:
3343 3432 3228 3152 3250 3212 3267 3350 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117765.1,      588826,     530257,      58569,     443445,      86812, 249.421100, 636.100000, 719.600000, 865.400000, 275.540735,   0.024000, 1176.430941, 668.655177
Outstanding requests per worker:
4390 4410 4367 4419 4361 4059 4140 4327 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  117281.7,      586409,     527665,      58744,     446263,      81402, 326.097328, 840.100000, 953.300000, 1127.300000, 362.831534,   0.024000, 1449.717045, 679.684950
Outstanding requests per worker:
5525 5770 5668 5568 5663 5521 5747 5649 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.4  0.0  18028  2764 pts/0    Ss+  11:32   0:00 bash docker-ent
memcache     7  0.5  0.0  96552  6440 pts/0    S+   11:32   0:00 /usr/lib/linux-
memcache     8  136  0.0 280960 134556 pts/0   Sl+  11:32   1:02 memcached -t 2 
memcache    17  0.0  0.0  34424  2912 pts/1    Rs+  11:33   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       14999410953      instructions:u                                              
         124854565      branch-misses:u           # [33m   6.06%[m of all branches        
        2059562035      branch-instructions:u                                       

      46.875408335 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 120000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 120000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 120000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,branch-misses:u,branch-instructions:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,branch-misses:u,branch-instructions:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,branch-misses:u,branch-instructions:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,branch-misses:u,branch-instructions:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 120000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 120000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 120000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 120000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 120000 cpus 8
meanInterarrival 66
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 1574344448
starting receive base loop
num_worker_connections 64
Creating worker on tid 979662592
starting receive base loop
num_worker_connections 64
Creating worker on tid 380380928
starting receive base loop
num_worker_connections 64
Creating worker on tid 4082693888
starting receive base loop
num_worker_connections 64
Creating worker on tid 3486725888
starting receive base loop
num_worker_connections 64
Creating worker on tid 2890757888
starting receive base loop
num_worker_connections 64
Creating worker on tid 2294789888
starting receive base loop
Created 512 connections total
Creating worker on tid 1703819008
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575374383.372808,       0.0,      356164,     320831,      35333,     214052,     106779,  13.042512,  46.700000,  67.700000, 108.600000,  26.605468,   0.000000, 423.065007, 482.797105
Outstanding requests per worker:
302 299 287 366 326 323 330 348 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  119696.1,      598481,     538577,      59904,     403984,     134593,  49.772829, 143.600000, 175.300000, 221.800000,  63.565812,   0.023000, 404.273003, 574.057073
Outstanding requests per worker:
1346 1397 1185 1283 1238 1195 1273 1301 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  119649.9,      598250,     538693,      59557,     424538,     114155, 116.567880, 298.200000, 341.000000, 419.300000, 130.328142,   0.023000, 663.286984, 615.835472
Outstanding requests per worker:
2386 2247 2336 2328 2144 2189 2285 2157 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  120033.9,      600170,     539589,      60581,     437166,     102423, 169.561688, 418.100000, 467.100000, 574.500000, 184.549454,   0.023000, 862.477005, 639.778652
Outstanding requests per worker:
2997 3032 2924 2940 2947 2975 3073 3118 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  124435.7,      622179,     560143,      62036,     462690,      97453, 136.641418, 442.700000, 521.400000, 665.700000, 186.090481,   0.024000, 1019.287944, 657.111902
Outstanding requests per worker:
876 959 920 1106 1006 1016 1048 985 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  119180.9,      595905,     536624,      59281,     449438,      87186, 104.939644, 279.400000, 319.100000, 397.900000, 120.661695,   0.023000, 601.081014, 670.011839
Outstanding requests per worker:
2211 2321 2115 2319 2197 2309 2384 2265 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  123977.9,      619890,     557703,      62187,     471393,      86310, 125.995162, 383.500000, 446.500000, 560.400000, 165.385399,   0.023000, 781.984985, 679.351693
Outstanding requests per worker:
604 518 554 552 531 528 500 541 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'7\r'
+ echo 'memcached pid is: 7'
memcached pid is: 7
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18028  2784 pts/0    Ss+  11:33   0:00 bash docker-ent
memcache     6  0.4  0.0  96552  6468 pts/0    S+   11:33   0:00 /usr/lib/linux-
memcache     7  136  0.0 283008 137764 pts/0   Sl+  11:33   1:02 memcached -t 2 
memcache    16  0.0  0.0  34424  2764 pts/1    Rs+  11:33   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       15400439011      instructions:u                                              
         127266281      branch-misses:u           # [33m   6.06%[m of all branches        
        2099694250      branch-instructions:u                                       

      46.974191909 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 122000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 122000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 122000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,branch-misses:u,branch-instructions:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,branch-misses:u,branch-instructions:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,branch-misses:u,branch-instructions:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,branch-misses:u,branch-instructions:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 122000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 122000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 122000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 122000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 122000 cpus 8
meanInterarrival 65
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 1021769472
starting receive base loop
num_worker_connections 64
Creating worker on tid 431765248
starting receive base loop
num_worker_connections 64
Creating worker on tid 4133779200
starting receive base loop
num_worker_connections 64
Creating worker on tid 3537811200
starting receive base loop
num_worker_connections 64
Creating worker on tid 2941843200
starting receive base loop
num_worker_connections 64
Creating worker on tid 2345875200
starting receive base loop
num_worker_connections 64
Creating worker on tid 1749907200
starting receive base loop
Created 512 connections total
Creating worker on tid 1153939200
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575374431.372856,       0.0,      360466,     324596,      35870,     216442,     108154,  15.757675,  32.700000,  45.400000, 354.300000,  71.663727,   0.000000, 1263.748050, 482.584505
Outstanding requests per worker:
288 193 274 237 269 259 299 335 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  123257.1,      616286,     554624,      61662,     417192,     137432,  17.018621,  50.200000,  77.200000, 121.100000,  26.952859,   0.023000, 214.521006, 576.682578
Outstanding requests per worker:
177 130 203 173 172 147 177 124 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121225.3,      606127,     545396,      60731,     431216,     114180,  34.656683, 128.000000, 163.100000, 217.500000,  56.167957,   0.023000, 384.431988, 617.650256
Outstanding requests per worker:
1246 1445 1309 1235 1267 1328 1397 1387 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  122929.7,      614649,     553157,      61492,     448471,     104686,  47.167215, 148.800000, 185.000000, 246.600000,  65.716851,   0.024000, 435.409993, 640.914513
Outstanding requests per worker:
1477 1514 1392 1302 1495 1448 1317 1438 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  119885.7,      599429,     539468,      59961,     445540,      93928, 150.624117, 397.400000, 460.700000, 571.000000, 173.207623,   0.023000, 831.245005, 657.526294
Outstanding requests per worker:
3268 3338 3565 3505 3545 3097 3477 3582 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  120287.3,      601437,     541397,      60040,     453399,      87998, 269.244577, 674.300000, 755.300000, 905.100000, 295.699891,   0.024000, 1257.058978, 670.217657
Outstanding requests per worker:
4923 5218 5223 5216 5395 5003 4951 5441 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  119664.7,      598324,     538298,      60026,     455561,      82737, 392.337468, 980.300000, 1084.900000, 1272.100000, 429.891740,   0.023000, 1609.230042, 679.817504
Outstanding requests per worker:
6684 7471 7482 7382 7721 7420 6951 7362 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'7\r'
+ echo 'memcached pid is: 7'
memcached pid is: 7
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18028  2884 pts/0    Ss+  11:33   0:00 bash docker-ent
memcache     6  0.4  0.0  96552  6456 pts/0    S+   11:34   0:00 /usr/lib/linux-
memcache     7  133  0.0 284032 139052 pts/0   Sl+  11:34   1:02 memcached -t 2 
memcache    16  0.0  0.0  34424  2864 pts/1    Rs+  11:34   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       15273306743      instructions:u                                              
         127904885      branch-misses:u           # [33m   6.10%[m of all branches        
        2098297288      branch-instructions:u                                       

      46.836778322 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 124000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 124000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 124000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,branch-misses:u,branch-instructions:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,branch-misses:u,branch-instructions:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,branch-misses:u,branch-instructions:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,branch-misses:u,branch-instructions:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 124000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 124000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 124000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 124000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 124000 cpus 8
meanInterarrival 64
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 4225320704
starting receive base loop
num_worker_connections 64
Creating worker on tid 3634050816
starting receive base loop
num_worker_connections 64
Creating worker on tid 3040999168
starting receive base loop
num_worker_connections 64
Creating worker on tid 2448045824
starting receive base loop
num_worker_connections 64
Creating worker on tid 1848764160
starting receive base loop
num_worker_connections 64
Creating worker on tid 1256109824
starting receive base loop
num_worker_connections 64
Creating worker on tid 660141824
starting receive base loop
Created 512 connections total
Creating worker on tid 64173824
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575374480.372905,       0.0,      360831,     324779,      36052,     216953,     107826,  20.410956,  84.200000, 112.300000, 160.300000,  40.779022,   0.000000, 554.529011, 483.998146
Outstanding requests per worker:
766 810 663 874 753 749 768 812 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  125616.7,      628084,     565792,      62292,     425238,     140554,  18.578361,  57.200000,  87.600000, 128.200000,  29.812745,   0.023000, 280.151993, 575.924914
Outstanding requests per worker:
384 358 281 475 487 367 411 410 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121905.7,      609529,     548483,      61046,     433585,     114898,  87.732032, 260.600000, 304.100000, 378.700000, 110.859669,   0.023000, 559.970021, 618.117139
Outstanding requests per worker:
2364 2346 2413 2416 2176 2230 2237 2509 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  128402.1,      642011,     577536,      64475,     468718,     108818, 115.886753, 384.300000, 446.100000, 550.600000, 160.689652,   0.023000, 798.542023, 641.821802
Outstanding requests per worker:
223 194 216 204 204 246 221 211 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  122530.7,      612654,     551358,      61296,     455887,      95471,  46.931022, 160.400000, 204.200000, 278.500000,  71.301888,   0.023000, 422.966003, 658.425109
Outstanding requests per worker:
2017 1634 1810 1680 1760 1674 1770 1755 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121529.1,      607646,     546680,      60966,     458433,      88247, 179.287199, 461.800000, 532.500000, 663.500000, 203.214429,   0.023000, 985.912979, 671.182648
Outstanding requests per worker:
3969 4044 4097 3991 3972 3590 4077 3768 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121360.1,      606801,     545794,      61007,     462566,      83228, 312.492204, 791.400000, 884.400000, 1065.200000, 346.494859,   0.024000, 1515.104055, 681.351750
Outstanding requests per worker:
5917 6402 6454 6329 6190 5805 6515 6134 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18028  2880 pts/0    Ss+  11:34   0:00 bash docker-ent
memcache     7  0.4  0.0  96552  6388 pts/0    S+   11:34   0:00 /usr/lib/linux-
memcache     8  133  0.0 285056 144940 pts/0   Sl+  11:34   1:02 memcached -t 2 
memcache    17 19.0  0.0  34424  2828 pts/1    Rs+  11:35   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       15572525616      instructions:u                                              
         129704331      branch-misses:u           # [33m   6.10%[m of all branches        
        2126830432      branch-instructions:u                                       

      46.792274749 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 126000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 126000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 126000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,branch-misses:u,branch-instructions:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,branch-misses:u,branch-instructions:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,branch-misses:u,branch-instructions:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,branch-misses:u,branch-instructions:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 126000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 126000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 126000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 126000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 126000 cpus 8
meanInterarrival 63
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 3402606336
starting receive base loop
num_worker_connections 64
Creating worker on tid 2803324672
starting receive base loop
num_worker_connections 64
Creating worker on tid 2211657472
starting receive base loop
num_worker_connections 64
Creating worker on tid 1615689472
starting receive base loop
num_worker_connections 64
Creating worker on tid 1019721472
starting receive base loop
num_worker_connections 64
Creating worker on tid 423753472
starting receive base loop
num_worker_connections 64
Creating worker on tid 4125767424
starting receive base loop
Created 512 connections total
Creating worker on tid 3529799424
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575374529.372954,       0.0,      364365,     327840,      36525,     218320,     109520,  27.578389, 113.800000, 143.700000, 204.700000,  56.542618,   0.000000, 631.429970, 482.304957
Outstanding requests per worker:
1211 1122 1164 1198 1221 1148 1146 1512 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  123023.7,      615119,     554015,      61104,     416781,     137234, 151.058260, 406.400000, 470.000000, 602.200000, 177.478031,   0.023000, 919.952989, 575.285249
Outstanding requests per worker:
3753 3736 3629 3563 3656 3583 3722 3941 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  122389.5,      611948,     550926,      61022,     435167,     115759, 300.533435, 769.600000, 868.800000, 1042.900000, 336.702506,   0.024000, 1409.816027, 617.364023
Outstanding requests per worker:
6651 6248 6413 6840 6377 6409 6570 7102 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  122347.7,      611739,     550546,      61193,     446359,     104187, 483.993458, 1195.800000, 1318.400000, 1495.500000, 528.496200,   0.023000, 1869.878054, 641.126286
Outstanding requests per worker:
9635 8704 9750 9603 9437 9200 9359 10141 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121895.5,      609478,     548528,      60950,     453179,      95349, 667.067028, 1620.400000, 1744.100000, 1940.500000, 719.738112,   0.023000, 2302.045107, 658.317369
Outstanding requests per worker:
12701 12102 13079 12870 12706 12001 12526 13326 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  120994.3,      604972,     544393,      60579,     455713,      88680, 873.926613, 2085.500000, 2220.700000, 2453.300000, 941.457601,   0.023000, 3040.775061, 669.980253
Outstanding requests per worker:
16303 15943 16624 16740 16571 15871 16218 17046 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  121444.5,      607223,     546575,      60648,     462905,      83670, 1090.011280, 2552.100000, 2709.700000, 3001.700000, 1166.045619,   0.023000, 3538.897038, 679.952735
Outstanding requests per worker:
19738 19299 20126 20304 19882 19498 19793 20410 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18028  2768 pts/0    Ss+  11:35   0:00 bash docker-ent
memcache     7  0.3  0.0  96552  6444 pts/0    S+   11:35   0:00 /usr/lib/linux-
memcache     8  133  0.0 283008 135880 pts/0   Sl+  11:35   1:02 memcached -t 2 
memcache    18 18.0  0.0  34424  2796 pts/1    Rs+  11:36   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       15383044917      instructions:u                                              
         128013640      branch-misses:u           # [33m   6.06%[m of all branches        
        2114150013      branch-instructions:u                                       

      46.936043688 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 128000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 128000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 128000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,branch-misses:u,branch-instructions:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,branch-misses:u,branch-instructions:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,branch-misses:u,branch-instructions:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,branch-misses:u,branch-instructions:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 128000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 128000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 128000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 128000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 128000 cpus 8
meanInterarrival 62
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 1689306880
starting receive base loop
num_worker_connections 64
Creating worker on tid 1094842112
starting receive base loop
num_worker_connections 64
Creating worker on tid 498874112
starting receive base loop
num_worker_connections 64
Creating worker on tid 4200888064
starting receive base loop
num_worker_connections 64
Creating worker on tid 3604920064
starting receive base loop
num_worker_connections 64
Creating worker on tid 3008952064
starting receive base loop
num_worker_connections 64
Creating worker on tid 2412984064
starting receive base loop
Created 512 connections total
Creating worker on tid 1817016064
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575374578.373003,       0.0,      372329,     335211,      37118,     224781,     110430,  31.013384, 127.000000, 161.000000, 225.200000,  61.580109,   0.000000, 652.899981, 486.378302
Outstanding requests per worker:
1471 1386 1260 1319 1468 1443 1405 1728 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  128826.9,      644135,     580337,      63798,     436814,     143523, 119.727113, 334.100000, 390.600000, 505.800000, 143.004524,   0.023000, 890.950024, 576.690452
Outstanding requests per worker:
1451 1691 1596 1559 1531 1643 1657 1435 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  127054.7,      635274,     571571,      63703,     452574,     118997, 125.197985, 335.900000, 379.600000, 461.500000, 143.834140,   0.023000, 709.985018, 619.466264
Outstanding requests per worker:
2714 2873 2591 2883 2933 2771 2957 2795 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  123766.5,      618833,     556869,      61964,     453112,     103757, 259.884123, 684.400000, 776.200000, 940.100000, 296.741875,   0.024000, 1444.126010, 644.364509
Outstanding requests per worker:
5752 6254 6002 5903 6306 6155 6497 6012 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  135969.9,      679850,     611617,      68233,     507062,     104555, 361.426881, 951.100000, 1059.500000, 1255.000000, 393.869903,   0.024000, 1644.876003, 660.286537
Outstanding requests per worker:
1741 1768 1702 1831 1829 1800 1819 1741 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  123029.5,      615148,     553500,      61648,     465554,      87946, 212.163403, 579.700000, 675.100000, 839.100000, 251.397770,   0.023000, 1126.433969, 673.830246
Outstanding requests per worker:
5495 5582 5516 5588 5653 5618 5430 5420 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  122645.9,      613230,     552303,      60927,     469201,      83102, 438.814803, 1108.900000, 1226.200000, 1462.400000, 489.627825,   0.023000, 1919.489980, 682.777962
Outstanding requests per worker:
9352 9295 9919 9739 9710 9479 9290 9485 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.5  0.0  18028  2856 pts/0    Ss+  11:36   0:00 bash docker-ent
memcache     7  0.3  0.0  96552  6516 pts/0    S+   11:36   0:00 /usr/lib/linux-
memcache     8  138  0.0 289152 149812 pts/0   Sl+  11:36   1:03 memcached -t 2 
memcache    17  0.0  0.0  34424  2884 pts/1    Rs+  11:37   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       15999490538      instructions:u                                              
         131691709      branch-misses:u           # [33m   6.06%[m of all branches        
        2173944083      branch-instructions:u                                       

      46.906486742 seconds time elapsed

+ for rps in '$RPS'
+ echo '==> Bench: 65536 keys, 512 conns, 8 threads, 130000 rps'
==> Bench: 65536 keys, 512 conns, 8 threads, 130000 rps
++ echo '512 + 128'
++ bc
+ max_conns=640
++ echo '24 + 8'
++ bc
+ client_cores_spec=24-32
+ CLIENT_CORES_SPEC=24-32
+ CLIENT_ARGS='-r 130000 -k 65536 -c 512 -f 512 -w 8'
+ SERVER_ARGS='-t 2 -m 4096 -n 550 -c 640'
+ bash server/run-perf-tests.sh
+ CLIENT_CORES_SPEC=24-32
+ mkdir -p output/
+ chmod -R 777 output/
+ docker network rm caching_network
Error response from daemon: error while removing network: network caching_network id 1617f80cc9aaa77000c68151f86e88f7de6be37fe3e65781474ce230dfc94396 has active endpoints
+ true
+ docker network create caching_network
Error response from daemon: network with name caching_network already exists
+ true
+ echo 'Starting server with perf args -e instructions:u,branch-misses:u,branch-instructions:u server args -t 2 -m 4096 -n 550 -c 640'
Starting server with perf args -e instructions:u,branch-misses:u,branch-instructions:u server args -t 2 -m 4096 -n 550 -c 640
+ docker rm -f dc-server
dc-server
+ sleep 10
++ pwd
+ docker run --cpuset-cpus=0,1 -t --name dc-server --net caching_network --cap-add SYS_ADMIN -e 'TOOL_ARGS=/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,branch-misses:u,branch-instructions:u' -p 11211:11211 -v /root/cloudsuite/benchmarks/data-caching/output:/output smspillaz/data-caching:server bash docker-entrypoint.sh memcached -t 2 -m 4096 -n 550 -c 640
/usr/lib/linux-tools/4.15.0-66-generic/perf stat -e instructions:u,branch-misses:u,branch-instructions:u memcached -t 2 -m 4096 -n 550 -c 640
+ echo 'Starting client with -r 130000 -k 65536 -c 512 -f 512 -w 8'
Starting client with -r 130000 -k 65536 -c 512 -f 512 -w 8
+ docker rm -f cloudsuite-data-caching-perf-test-client
cloudsuite-data-caching-perf-test-client
+ docker run --cpuset-cpus=24-32 -t --name cloudsuite-data-caching-perf-test-client --net caching_network smspillaz/data-caching:client -r 130000 -k 65536 -c 512 -f 512 -w 8
+ echo 'dc-server, 11211'
+ /usr/src/memcached/memcached_client/loader -a /usr/src/memcached/twitter_dataset/twitter_dataset_5x -s /usr/src/memcached/memcached_client/servers.txt -t 30 -T 5 -r 130000 -k 65536 -c 512 -f 512 -w 8
stats_time = 5
Configuration:

nProcessors on system: 48
nWorkers: 8
runtime: 30
Fixed value size: 512
Get fraction: 0.900000
Naggle's algorithm: False


host: dc-server
address: 192.168.144.2
Loading key value file...created uniform distribution 65536
rps 130000 cpus 8
meanInterarrival 61
num_worker_connections 64
num_worker_connections 64
Creating worker on tid 3425994496
starting receive base loop
num_worker_connections 64
Creating worker on tid 2831660800
starting receive base loop
num_worker_connections 64
Creating worker on tid 2235692800
starting receive base loop
num_worker_connections 64
Creating worker on tid 1642739456
starting receive base loop
num_worker_connections 64
Creating worker on tid 1046771456
starting receive base loop
num_worker_connections 64
Creating worker on tid 450803456
starting receive base loop
num_worker_connections 64
Creating worker on tid 4149802752
starting receive base loop
Created 512 connections total
Creating worker on tid 3557799680
starting receive base loop
Stats:
-------------------------
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
1575374627.373052,       0.0,      373203,     335757,      37446,     225031,     110726,  28.036586, 125.500000, 160.000000, 212.600000,  55.363884,   0.000000, 336.457014, 486.232793
Outstanding requests per worker:
1545 1345 1443 1472 1401 1656 1560 1610 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  131765.9,      658830,     593175,      65655,     446765,     146410, 175.087266, 462.000000, 529.300000, 649.000000, 194.135981,   0.024000, 1071.661949, 578.023765
Outstanding requests per worker:
1118 1206 1028 1153 1113 1101 1138 1139 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  124665.1,      623326,     560485,      62841,     443834,     116651, 183.434187, 529.200000, 611.100000, 745.800000, 225.007634,   0.024000, 1146.163940, 619.859928
Outstanding requests per worker:
5251 5388 4867 5362 5222 5219 5047 5106 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  123877.7,      619389,     557603,      61786,     453512,     104091, 423.834874, 1090.200000, 1208.400000, 1392.800000, 476.723173,   0.024000, 1699.794054, 643.877284
Outstanding requests per worker:
9509 10233 9601 9791 9840 9649 9505 9727 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  123626.9,      618135,     556162,      61973,     460455,      95707, 687.398647, 1689.800000, 1813.200000, 2047.000000, 756.072923,   0.023000, 2441.549063, 658.927073
Outstanding requests per worker:
14236 14913 14055 14808 14468 14667 14113 14233 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  148239.7,      741199,     666893,      74306,     560050,     106843, 681.549115, 1752.100000, 1926.800000, 2199.700000, 669.997791,   0.024000, 2657.757044, 672.190960
Outstanding requests per worker:
3646 3805 3924 3630 3790 3712 3906 3666 
  timeDiff,     rps,        requests,     gets,       sets,      hits,       misses,   avg_lat,      90th,      95th,        99th,       std,       min,        max,    avgGetSize
  5.000005,  123698.9,      618495,     556650,      61845,     472549,      84101, 337.651967, 900.800000, 1017.600000, 1190.500000, 388.235736,   0.023000, 1459.004998, 682.883417
Outstanding requests per worker:
8315 8427 8481 8526 8548 8164 8490 8415 
Ran for 32.000032, exiting
+ echo 'Done, sending SIGINT to memcached'
Done, sending SIGINT to memcached
++ docker exec -it dc-server pidof memcached
+ MEMCACHED_PID=$'8\r'
+ echo 'memcached pid is: 8'
memcached pid is: 8
+ docker exec -it dc-server ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
memcache     1  0.4  0.0  18028  2880 pts/0    Ss+  11:37   0:00 bash docker-ent
memcache     7  0.4  0.0  96552  6404 pts/0    S+   11:37   0:00 /usr/lib/linux-
memcache     8  138  0.0 289152 149628 pts/0   Sl+  11:37   1:03 memcached -t 2 
memcache    18  0.0  0.0  34424  2864 pts/1    Rs+  11:38   0:00 ps aux
+ docker exec -it dc-server bash -c 'kill -INT $(pidof memcached)'
Signal handled: Interrupt.

 Performance counter stats for 'memcached -t 2 -m 4096 -n 550 -c 640':

       16250805195      instructions:u                                              
         133433393      branch-misses:u           # [33m   6.06%[m of all branches        
        2201394412      branch-instructions:u                                       

      46.878876763 seconds time elapsed

